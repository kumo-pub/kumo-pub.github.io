<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.1.1 docs-doc-page docs-doc-id-pollux/develop/expression-evaluation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">表达式计算 (Expression Evaluation) | Kumo AI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kumo-pub.github.io/docs/pollux/develop/expression-evaluation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.1.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" name="docsearch:version" content="1.1.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" property="og:title" content="表达式计算 (Expression Evaluation) | Kumo AI"><meta data-rh="true" name="description" content="Pollux 具有矢量化表达式求值功能。它在 FilterProject 运算符中用于求值过滤器和项目表达式，在"><meta data-rh="true" property="og:description" content="Pollux 具有矢量化表达式求值功能。它在 FilterProject 运算符中用于求值过滤器和项目表达式，在"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://kumo-pub.github.io/docs/pollux/develop/expression-evaluation"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/pollux/develop/expression-evaluation" hreflang="en"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/pollux/develop/expression-evaluation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kumo AI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kumo AI Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Kumo AI JSON Feed">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E5CR2Q1NRE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E5CR2Q1NRE",{})</script>


<link rel="alternate" type="application/rss+xml" href="/changelog/rss.xml" title="Docusaurus changelog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/changelog/atom.xml" title="Docusaurus changelog Atom Feed">
<link rel="alternate" type="application/json" href="/changelog/feed.json" title="Docusaurus changelog JSON Feed">



<link rel="icon" href="/img/docusaurus.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/docusaurus.png">
<link rel="mask-icon" href="/img/docusaurus.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/docusaurus.png">
<meta name="msapplication-TileColor" content="#000">



<link rel="alternate" type="application/rss+xml" href="/tests/blog/rss.xml" title="Docusaurus Tests Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tests/blog/atom.xml" title="Docusaurus Tests Blog Atom Feed">
<link rel="alternate" type="application/json" href="/tests/blog/feed.json" title="Docusaurus Tests Blog JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kumo AI" href="/opensearch.xml">

<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.21fbef88.css">
<script src="/assets/js/runtime~main.cf79a945.js" defer="defer"></script>
<script src="/assets/js/main.4244a726.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme-b4f")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss-b4f")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">🎉️ <b><a target="_blank" href="https://docusaurus.io/blog/releases/1.1">Kumo v1.1</a> is out!</b> 🥳️</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"></div><b class="navbar__title text--truncate">主页</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">文档</a><a class="navbar__item navbar__link" href="/docs/category/kmsearch">API</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/changelog">发布</a><a class="navbar__item navbar__link" href="/showcase">应用案例</a><a class="navbar__item navbar__link" href="/community/support">支持与资源</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/pollux/develop/expression-evaluation">1.1.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next">nightly 🚧</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/pollux/develop/expression-evaluation">1.1.1</a></li><li><hr class="dropdown-separator"></li><li class="dropdown-archived-versions"><b>Archived versions</b></li><li><a href="https://docusaurus-archive-october-2023.netlify.app/docs/2.3.1" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.0.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://v1.docusaurus.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.x.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/pollux/develop/expression-evaluation" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://github.com/facebook/docusaurus/issues/3526" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"><b>主页</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">概述</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/基础准备">基础准备</a><button aria-label="Collapse sidebar category &#x27;基础准备&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_be">后端开发环境</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_fe">前端开发环境</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/持续集成----kmpkg">持续集成 -- kmpkg</a><button aria-label="Expand sidebar category &#x27;持续集成 -- kmpkg&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/c开发">c++开发</a><button aria-label="Expand sidebar category &#x27;c++开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/搜素基础开发">搜素基础开发</a><button aria-label="Expand sidebar category &#x27;搜素基础开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/搜索应用开发">搜索应用开发</a><button aria-label="Expand sidebar category &#x27;搜索应用开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/向量数据库教程">向量数据库教程</a><button aria-label="Expand sidebar category &#x27;向量数据库教程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/搜索统一执行引擎">搜索统一执行引擎</a><button aria-label="Collapse sidebar category &#x27;搜索统一执行引擎&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/overview">pollux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/presto-functions">Presto Functions</a><button aria-label="Expand sidebar category &#x27;Presto Functions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/开发文档">开发文档</a><button aria-label="Collapse sidebar category &#x27;开发文档&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/types">Types(数据类型)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/vectors">Vectors(向量)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/scalar-functions">如何添加标量函数？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/aggregate-functions">如何添加聚合函数？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/view-and-writer-types">视图和编写器类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/lambda-functions">如何添加 lambda 函数？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pollux/develop/expression-evaluation">表达式计算 (Expression Evaluation)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/dictionary-encoding">字典编码(Dictionary Encoding)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/arena">Arena Allocation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/hash-table">Hash table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/aggregations">聚合(Aggregations)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/connectors">Connectors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/joins">Joins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/anti-join">Anti joins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/operators">Plan Nodes and Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/task">What&#x27;s in the Task?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/simd">SIMD Usage in Pollux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/memory">Memory Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/spilling">Spilling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/serialization">Serialization</a><button aria-label="Expand sidebar category &#x27;Serialization&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/调试">调试</a><button aria-label="Expand sidebar category &#x27;调试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/测试">测试</a><button aria-label="Expand sidebar category &#x27;测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/timestamp">Timestamp and Timezone Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/window">Window functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/dynamic-loading">Dynamic Loading of Pollux Extensions</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/搜索-ui">搜索 UI</a><button aria-label="Expand sidebar category &#x27;搜索 UI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/搜索统一执行引擎"><span itemprop="name">搜索统一执行引擎</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/开发文档"><span itemprop="name">开发文档</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">表达式计算 (Expression Evaluation)</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.1.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>表达式计算 (Expression Evaluation)</h1></header>
<p>Pollux 具有矢量化表达式求值功能。它在 FilterProject 运算符中用于求值过滤器和项目表达式，在
HiveConnector 中用于求值“剩余”的过滤器表达式。它也可以单独使用。</p>
<p>查看 <strong>pollux/example/ExpressionEval.cpp</strong> 获取该 API 的示例用法。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expression-trees">表达式树<a href="#expression-trees" class="hash-link" aria-label="Direct link to 表达式树" title="Direct link to 表达式树">​</a></h2>
<p>表达式求值以表达式树作为输入。树中的每个节点都是 core::ITypedExpr   的一个子类，它指定返回类型以及零个或
多个输入表达式（树中的子节点）。每个表达式可以是以下之一：</p>
<ul>
<li>FieldAccessTypedExpr</li>
<li>ConstantTypedExpr</li>
<li>CallTypedExpr</li>
<li>CastTypedExpr</li>
<li>LambdaTypedExpr</li>
</ul>
<p><strong>FieldAccessTypedExpr</strong> 表示输入 RowVector 的一列。该列由名称标识。这始终是树中的叶节点。</p>
<p><strong>ConstantTypedExpr</strong> 表示一个常量值（或字面量）。它始终是树中的叶节点。</p>
<p><strong>CallTypedExpr</strong> 表示一次函数调用。函数通过名称标识。输入表达式指定函数参数的数量和类型，从
而可以明确地识别特定的函数实现。该函数可以是简单函数，也可以是向量化函数。</p>
<p><strong>CallTypedExpr</strong> 也可以通过指定预定义名称之一来表示特殊形式。这些名称不能用于简单函数或向量函数。</p>
<p>与(and)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        AND 表达式。接受两个或多个布尔类型的输入表达式。如果所有输入都为真，则返回 true；如果至少一个输入为假，则返回 false；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        否则，返回 null。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        如果某个输入在某一行生成错误，而另一个输入返回 false，则该错误会被抑制。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>或者(or)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        或表达式。接受两个或多个布尔类型的输入表达式。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        如果至少一个输入为真，则返回 true；如果所有输入均为假，则返回 false；否则返回 null。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        如果某个输入对某一行生成错误，而另一个输入返回 true，则该错误会被抑制。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>if</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        IF 表达式。接受 2 或 3 个输入表达式：布尔条件；then 子句；可选的 else 子句。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        如果未指定 else 子句，则表达式对不满足条件的行返回 null。如果指定了 else 子句，则其返回类型必须与 then 子句的返回类型相同。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>switch</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        SWITCH 表达式是 IF 表达式的泛化。它接受</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        一个或多个 (条件，then 子句) 对和一个可选的 else 子句。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        如果未指定 else 子句，则表达式将对未满足任何条件的行返回 null。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        所有 then 子句和 else 子句的返回类型必须相同。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>cast</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        CAST 表达式。接受单个输入表达式。结果类型决定了转换的目标类型。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>try</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        TRY 表达式。接受单个输入表达式。通过为相应行返回 null 来处理输入表达式生成的错误。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>coalesce</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        COALESCE 表达式。接受多个相同类型的输入表达式。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        返回参数列表中的第一个非空值。与 IF 或 SWITCH 表达式类似，仅在必要时才对参数进行求值。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在评估 AND 和 OR 表达式时，引擎会自适应地重新排序并联项，首先评估成本最低、最具决定性的并联项。例如，AND 表达式会选
择评估成本最低、最常返回 FALSE 的并联项，而 OR 表达式则会选择评估成本最低、最常返回 TRUE 的并联项。</p>
<p>AND 和 OR 表达式中的错误抑制逻辑旨在提供一致的结果，无论并联项的顺序如何。</p>
<p><strong>CastTypedExpr</strong> - 与上面的 CAST 表达式相同。</p>
<p><strong>LambdaTypedExpr</strong> 表示由输入类型（lambda 的签名）和表达式（lambda 的主体）指定的 lambda 表达式。这始终是树中的叶节点。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expression-evaluation">Expression Evaluation<a href="#expression-evaluation" class="hash-link" aria-label="Direct link to Expression Evaluation" title="Direct link to Expression Evaluation">​</a></h2>
<p>表达式求值分为两个步骤：编译和求值。
编译步骤以 core::ITypedExpr 树的形式接收一个表达式列表，并以 exec::Expr 树的形式生
成一个可执行表达式列表。求值步骤以 RowVector 的形式接收输入数据，对编译后的表达式求值并返回结果。
求值步骤可以根据需要重复执行多次，直至处理完所有数据。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="compilation">Compilation<a href="#compilation" class="hash-link" aria-label="Direct link to Compilation" title="Direct link to Compilation">​</a></h3>
<p>要编译表达式，需要创建一个 exec::ExprSet 实例。ExprSet 的构造函数接受一个表达式列表（指向表达式树
根节点的 core::ITypedExpr ）和一个上下文（core::ExecCtx）。构造函数处理这些表达式并创建 exec::Expr 类实例树。</p>
<p>ExprSet 接受多个表达式，并识别所有表达式中的公共子表达式，以便它们只需计算一次。FilterProject 运算符受益于此功能，因为它为所有过滤
器和项目表达式创建单个 ExprSet。编译步骤还会展平相邻的 AND、OR 和连接行表达式，并执行常量折叠。</p>
<p>表达式树中的每个节点都会转换为 exec::Expr 类的相应实例。</p>
<table><thead><tr><th>core::ITypedExpr node</th><th>exec::Expr instance</th></tr></thead><tbody><tr><td>FieldAccessTypedExpr</td><td>FieldReference</td></tr><tr><td>ConstantTypedExpr</td><td>ConstantExpr</td></tr><tr><td>CallTypedExpr</td><td>* CastExpr if function name is &quot;cast&quot;;<br>* ConjunctExpr if function name is &quot;and&quot; or &quot;or&quot;;<br>* SwitchExpr if function name is &quot;if&quot; or &quot;switch&quot;;<br>* CoalesceExpr if function name is &quot;coalesce&quot;;<br>* TryExpr if function name is &quot;try&quot;;<br>* Expr if function name is none of the above</td></tr><tr><td>CastTypedExpr</td><td>CastExpr</td></tr><tr><td>LambdaTypedExpr</td><td>LambdaExpr</td></tr></tbody></table>
<p>处理 CallTypedExpr 节点以确定函数名称是否引用特殊形式的表达式或函数（矢量化或简单）。查找按以下顺序执行，并在第一次匹配时停止：</p>
<ul>
<li>检查名称是否与某种特殊形式匹配。</li>
<li>检查名称和签名（即输入类型）是否与某种矢量化函数匹配。</li>
<li>检查名称和签名（即输入类型）是否与某种简单函数匹配。</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="common-subexpression-detection">Common SubExpression Detection<a href="#common-subexpression-detection" class="hash-link" aria-label="Direct link to Common SubExpression Detection" title="Direct link to Common SubExpression Detection">​</a></h4>
<p>下图展示了 <strong>strpos(upper
(a), &#x27;FOO&#x27;) &gt; 0 OR strpos(upper(a), &#x27;BAR&#x27;) &gt; 0</strong> 表达式的表达式树。其中，<strong>upper
(a)</strong> 是一个公共子表达式。它由 Expr 类的一个实例表示，该实例在树中出现了两次。</p>
<!-- -->
<img width="600" align="center" src="[object Object]">
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="flatten-ands-and-ors">Flatten ANDs and ORs<a href="#flatten-ands-and-ors" class="hash-link" aria-label="Direct link to Flatten ANDs and ORs" title="Direct link to Flatten ANDs and ORs">​</a></h4>
<p>相邻的“与”节点合并为一个。同样，相邻的“或”节点也合并为一个。这最大限度地提高了“与”和“或”表达式执行过程中自适应连接重排序的效果。</p>
<!-- -->
<img width="600" align="center" src="[object Object]">
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="flatten-concat-like-functions">Flatten concat-like functions<a href="#flatten-concat-like-functions" class="hash-link" aria-label="Direct link to Flatten concat-like functions" title="Direct link to Flatten concat-like functions">​</a></h4>
<p>行为类似于结合运算符的函数可以声明支持扁平化。在这种情况下，同一函数的相邻节点将被合并为一个。</p>
<p>Presto 函数 concat(varchar,..) 就是一个很好的例子。执行 concat(a, b, c,
d) 比执行 concat(a, concat(b, concat(c, d))) 更高效。
一次连接 4 列可以计算最终结果所需的内存总量，将其分配到一个块中，然后将各个值复制到正确的偏移量。与一次连接两列相比，这节省了内存分配并减少了数据复制。</p>
<p>Presto 函数 concat 声明支持扁平化，允许表达式编译器将 concat(a, concat(b, concat(c, d))) 表达式转换为 concat(a, b, c, d)。</p>
<p>其他可以利用此优化的函数包括 <code>concat(array,..)</code> 和 <code>map_concat(map,..)</code>。但是，目前仅支持所有输入类型相同的签名。例如，<code>concat(array&lt;T&gt;, concat(array&lt;T&gt;, array&lt;T&gt;))</code>
将被展平，但 <code>concat(T, concat(array&lt;T&gt;, array&lt;T&gt;))</code> 则不会。</p>
<p>声明支持展平的函数必须具有包含相同类型的可变参数的签名，并且返回类型必须与输入类型相同。</p>
<p>f(x,..) -&gt; x</p>
<p>展平会将像 f(x1, f(x2, f(x3, x4))) 这样的子表达式转换为
f(x1, x2, x3, x4)。</p>
<p>展平发生在常量折叠之前，因此，f(a, f(constant-x, Constant-y))
变为 f(a, Constant-x, Constant-y)，而不是 f(a, Constant-z)，其中
constant-z = f(constant-x, Constant-y)。</p>
<p>展平还会影响公共子表达式的检测。如果不展平，在像 g(f(a, f(b, c)), f(d, f(b, c))) 这样的表达式中，编译器会
将 f(b, c) 识别为公共子表达式。如果展平，该表达式
将被重写为 g(f(a, b, c), f(d, b, c))，并且不会识别出任何公共子表达式。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="constant-folding">Constant Folding<a href="#constant-folding" class="hash-link" aria-label="Direct link to Constant Folding" title="Direct link to Constant Folding">​</a></h4>
<p>一旦我们拥有可执行表达式树 (exec::Expr)，ExprSet 就会识别
不依赖于任何列的确定性子表达式，对其进行求值，并将其替换为单个常量表达式。这种优化称为常量折叠。</p>
<p>例如，在表达式 <strong>upper(a) &gt; upper(&#x27;Foo&#x27;)</strong> 中，子表达式 <strong>upper
(&#x27;Foo&#x27;)</strong> 是确定性的，不依赖于任何列。它将在编译时进行求值，并替换为单个 ConstantExpr 节点 <strong>FOO</strong>。</p>
<!-- -->
<img width="600" align="center" src="[object Object]">
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="expression-metadata">Expression Metadata<a href="#expression-metadata" class="hash-link" aria-label="Direct link to Expression Metadata" title="Direct link to Expression Metadata">​</a></h4>
<p>可执行表达式包含一组在求值过程中使用的元数据。
这些元数据由 Expr::computeMetadata() 虚方法计算，并存储在 exec::Expr 类的成员变量中。</p>
<ul>
<li><em>distinctFields_</em> - 不同输入列的列表。</li>
<li><em>multiplyReferencedFields_</em> - <code>distinctFields_</code> 的子集，可用作多个子表达式的输入。</li>
<li><em>sameAsParentDistinctFields_</em> - 如果 <code>distinctFields_</code> 与父级 <code>distinctFields_</code>（父级引用将此表达式作为输入的表达式）之一匹配，则为 True。</li>
<li><em>propagatesNulls_</em> - 布尔值，指示任何输入列中的 null 值是否会导致此表达式始终为该行返回 null。</li>
<li><em>deterministic_</em> - 布尔值，指示此表达式及其所有子表达式是否具有确定性。</li>
<li><em>hasConditionals_</em> - 布尔值，指示此表达式或其任何子表达式是否为 IF、SWITCH、AND 或 OR 表达式。</li>
<li><em>isMultiplyReferenced_</em> - 布尔值，指示这是否为公共子表达式，例如，在 ExprSet 管理的表达式集合中出现多次的子表达式。</li>
</ul>
<p>以下是表达式 <strong><code>strpos(upper(a), ‘FOO’) &gt; 0 OR strpos(upper(b), BAR) &gt; 0</code></strong> 的 <em>distinctFields_</em> 示例。每个表达式的不同字段显示在表达式节点右侧的括号中。OR 节点有两个字段：a 和 b。每个大于等于 n 的节点都有一个字段：a 或
b。对 strpos 和 upper 函数进行求值的节点具有一个空的不同字段列表，因为它们依赖于与其父节点完全相同的列。
不同字段元数据会触发输入数据编码的剥离，并允许对唯一值的子集运行整个子表达式。</p>
<!-- -->
<img width="600" align="center" src="[object Object]">
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="evaluation">Evaluation<a href="#evaluation" class="hash-link" aria-label="Direct link to Evaluation" title="Direct link to Evaluation">​</a></h4>
<p>ExprSet 的一个实例代表一个或多个可执行表达式。
ExprSet::eval() 方法可以重复调用，以对多个批次数据执行所有或部分表达式的求值。</p>
<p>FilterProject 运算符使用单个 ExprSet 实例来处理所有过滤和投影表达式。对于每一批输入数据，该运算符首先对所有输入行执行过滤表达式，然
后对通过过滤的行子集执行所有投影表达式。如果没有行通过过滤，则跳过投影表达式的求值。</p>
<p>ExprSet::eval() 的输入是 EvalCtx，它包含一个表示输入数据的 RowVector 和一个用于标识要对其执行表达式的行子集的 SelectivityVector。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="common-subexpressions-cses">Common SubExpressions (CSEs)<a href="#common-subexpressions-cses" class="hash-link" aria-label="Direct link to Common SubExpressions (CSEs)" title="Direct link to Common SubExpressions (CSEs)">​</a></h4>
<p>ExprSet::eval() 会针对各个表达式调用 Expr::eval()。Expr::eval
() 首先检查表达式是否为确定性公共子表达式
(<em>isMultiplyReferenced_</em> == true)，如果是，则检查该表达式是否已被求值。如果是，则返回先前计算的结果并结束求值。</p>
<p>先前求值中使用的行集可能小于
当前的行集。在这种情况下，求值将继续计算缺失行的表达式。将结果与先前计算的值相结合，得出最终结果。</p>
<p>各个表达式会递归地对输入  表达式调用 Expr::eval()。
这使得公共子表达式优化可以应用于树的任何层级，而不仅仅是根层级。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="computing-on-distinct-values-only">Computing on Distinct Values Only<a href="#computing-on-distinct-values-only" class="hash-link" aria-label="Direct link to Computing on Distinct Values Only" title="Direct link to Computing on Distinct Values Only">​</a></h4>
<p>当输入采用字典编码时，确定性表达式仅基于不同的值进行计算。具体方法是：检查输入列（<em>distinctFields_</em>）以识别共享的字典包装，
剥离这些包装以提取一组内部向量，其中包含一组与原始行对应的索引，然后对这些内部向量求表达式的值，最后使用原始包装将结果包装到字典向量中。</p>
<p>解释此机制的一种方法是考虑一个**upper
(color)<strong>表达式，该表达式对“color”列进行字典编码，使用一个包含3个值的字典：0 - 红色，1 - 绿色，2 - 蓝色。假设该字典向量有1000个条目。这些条目用一个包
含1000个值（范围在[0, 2]之间）的索引缓冲区和一个大小为3的内部平面向量表示：[red, green,
blue]。在计算</strong>upper(color)**表达式时，Expr::peelEncodings
() 方法用于剥离字典并生成一组新的输入：
大小为3的内部平面向量和一组指向该向量的索引：[0, 1, 2]。然后，将“upper”函数应用于3个值 - [red, green, blue] - 以生成另一个大小为3的平面向量
：[RED, GREEN, BLUE]。最后，使用原始索引将结果包装到字典向量中，生成一个表示 1000 个大写颜色值的字典向量。</p>
<p>编码剥离发生在表达式树中依赖于给定列集的最高节点。这是通过将 peelEncodings 方法应用于 <em>distinctFields_</em> 来实现的，只有当列集与父表达式不同
时，才会填充这些字段。例如，在表达式 f(g(color)) 中，字典编码在表达式树的最顶端被剥离，整个表达式仅基于 3 个不同的值进行求值。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="memoizing-the-dictionaries">Memoizing the Dictionaries<a href="#memoizing-the-dictionaries" class="hash-link" aria-label="Direct link to Memoizing the Dictionaries" title="Direct link to Memoizing the Dictionaries">​</a></h4>
<p>当输入向量来自 TableScan 时，我们可以有多个批次的输入字典向量引用同一个基向量。“颜色”列可能有数百万行引用相同的基值集：红色、绿色、蓝色。
在这种情况下，每个批次的输入都有一个字典向量，该向量具有相同的基向量和不同的索引缓冲区。Expr::eval() 会记住在底层基向量上执行表达式
的结果，并在后续批次中重复使用这些结果。对于每个新批次，它只是使用输入向量的索引缓冲区包装原始结果。此逻辑在 Expr::evalWithMemo() 方法
中实现，并且仅适用于确定性表达式。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="handling-nulls">Handling Nulls<a href="#handling-nulls" class="hash-link" aria-label="Direct link to Handling Nulls" title="Direct link to Handling Nulls">​</a></h4>
<p>当表达式传播空值时（<em>propagatingNulls_</em> 元数据已在前面描述），该表达式仅对没有输入为空的行进行求值，并且结果会更新，为输入为空的
行设置空值。这时，DictionaryVector 允许添加空值就派上用场了（例如，DictionaryVector 有一个与基向量的空值缓冲区分开的空值缓冲
区）。因此，无论表达式求值的结果是平面编码还是字典编码，都可以高效地添加空值。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="evaluation-algorithm">Evaluation Algorithm<a href="#evaluation-algorithm" class="hash-link" aria-label="Direct link to Evaluation Algorithm" title="Direct link to Evaluation Algorithm">​</a></h4>
<p>表达式求值从根节点开始，按深度优先的顺序遍历表达式树。对每个 节点执行一系列操作。</p>
<!-- -->
<img width="600" align="center" src="[object Object]">
<p>#. <strong>Expr::eval</strong> - 节点求值的入口点。检查表达式是否为已求值的共享子表达式。如果是，则检查是否已对所有必要的行求
值。如果是，则生成结果并提前终止求值。否则，将待求值的行设置为缺少结果的行子集，然后继续执行后续步骤。
#. <strong>Expr::evalEncodings</strong> - 如果表达式是确定性的，且依赖的列少于其父代，则尝试剥离输入列的共享编码。如果剥离成功，则将输入列替换
为相应的内部向量，将待求值的行集更新为内部向量中的相应行，并存储剥离的包装以供后续使用。
#. <strong>Expr::evalWithNulls</strong> - 如果表达式传播空值，则检查输入列并确定至少有一个输入为空的行。将这些行从待求值的行集中移除。
#. <strong>Expr::evalAll</strong> - 表达式可以是特殊形式或函数调用。如果是特殊形式，则通过调用 Expr::evalSpecialForm() 来求值。如果是
函数调用，则通过在子节点上调用 Expr::eval() 递归求值所有输入表达式并生成输入向量。如果函数具有默认的空值行为，则识别所有输入向量为
空的行，并将其从待求值的行集合中移除。如果函数是确定性的且输入向量不是平坦的，则尝试剥离编码。如果剥离成功，则用相应的内部向量替换输入向
量，将待求值的行集合更新为内部向量中的相应行，并存储剥离后的包装以供后续使用。通过调用 VectorFunction::apply() 来求值函数。通过使用剥离后
的编码对结果进行包装，并对因输入为空而被移除的行设置空值来调整结果。注意：此步骤中对空值的处理和编码剥离似乎与 Expr::evalEncodings 和
Expr::evalWithNulls 中的类似步骤重复。区别在于，Expr::evalEncodings 和 Expr::evalWithNulls 处理的是整个表达式树提供的输入数据，
而此步骤处理的是通过计算输入表达式计算出的输入向量。
#. <strong>Finalize</strong> - 将因输入为空而从求值中移除的行设置为空值。如果任何编码被剥离，则使用它来包装结果。如果表达式是共享子表达式，并且先前求
值的部分结果存在，则将其合并到最终结果中，然后保存结果以备将来使用。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="flat-no-nulls-fast-path">Flat No-Nulls Fast Path<a href="#flat-no-nulls-fast-path" class="hash-link" aria-label="Direct link to Flat No-Nulls Fast Path" title="Direct link to Flat No-Nulls Fast Path">​</a></h4>
<p>在对短向量（&lt; 1000 行）执行简单表达式时，处理空值和编码的开销显而易见。为了优化这些用例，
表达式求值采用平坦无空值的快速路径
(Expr::evalFlatNoNulls)。当输入为平坦向量或无空值的常量时，此路径自动应用，并且所有子表达式都保证在给定平坦或常量无空值的输入的情况下生成平坦或常量无空值的结果。</p>
<p>受益于此优化的工作负载示例之一是许多机器学习预处理工作负载中常见的非空浮点数基本算术运算。</p>
<p>所有简单函数都保证对于平坦或常数无空值的输入返回平坦或常数无空值的结果。</p>
<p>具有此属性的向量函数必须通过重写 supportFlatNoNullsFastPath 方法来指示这一点。</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Returns true if (1) supports evaluation on all constant inputs of size &gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 1; (2) returns flat or constant result when inputs are all flat, all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// constant or a mix of flat and constant; (3) guarantees that if all inputs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// are not null, the result is also not null.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">supportsFlatNoNullsFastPath</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>特殊形式在某些情况下支持平坦无空快速路径，但并非所有情况都支持。</p>
<ul>
<li>如果所有子表达式都支持平坦无空快速路径，则 AND / OR 语句支持平坦无空快速路径。</li>
<li>如果指定了 else 子句，且所有子表达式都支持平坦无空快速路径，则 IF 和 SWITCH 语句支持平坦无空快速路径。</li>
<li>如果所有子表达式都支持平坦无空快速路径，则 COALESCE 语句支持平坦无空快速路径。</li>
<li>CAST 语句不支持平坦无空快速路径。</li>
<li>TRY 语句不支持平坦无空快速路径。</li>
</ul>
<p>某些子表达式可能采用快速路径，而其他子表达式则采用常规路径。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="error-handling-in-and-or-try">Error Handling in AND, OR, TRY<a href="#error-handling-in-and-or-try" class="hash-link" aria-label="Direct link to Error Handling in AND, OR, TRY" title="Direct link to Error Handling in AND, OR, TRY">​</a></h4>
<p>在评估 AND 表达式时，如果某个输入在某一行生成错误，而另一个输入在该行上返回 false，则该错误会被抑制。</p>
<p>在评估 OR 表达式时，如果某个输入在某一行生成错误，而另一个输入在该行上返回 true，则该错误会被抑制。</p>
<p>AND 和 OR 表达式中的错误抑制逻辑旨在提供一致的结果，无论连接操作的顺序如何。</p>
<p>TRY 表达式通过将相应行的结果设置为 null 来处理异常。AND、OR 和 TRY 表达式中的错误处理依赖于所有
表达式和向量函数是否正确支持 EvalCtx::throwOnError
标志。当设置为 false 时，如果某行的数据无效，表达式和向量函数不应抛出异常，而是通过调用 EvalCtx::setError(row, exception) 来记录错误。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="adaptive-conjunct-reordering-in-and-and-or">Adaptive Conjunct Reordering in AND and OR<a href="#adaptive-conjunct-reordering-in-and-and-or" class="hash-link" aria-label="Direct link to Adaptive Conjunct Reordering in AND and OR" title="Direct link to Adaptive Conjunct Reordering in AND and OR">​</a></h4>
<p>AND 和 OR 表达式使用与 Selective ORC Reader 相同的机制来跟踪
各个连接符的性能，并自适应地重新排序它们，以便
首先评估最快丢弃最多行的连接符。</p>
<p>AND 表达式首先评估最便宜、最常返回 FALSE 的连接符，而 OR 表达式首先评估最便宜、最常返回 TRUE 的连接符。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="evaluation-of-if-switch">Evaluation of IF, SWITCH<a href="#evaluation-of-if-switch" class="hash-link" aria-label="Direct link to Evaluation of IF, SWITCH" title="Direct link to Evaluation of IF, SWITCH">​</a></h4>
<p>SWITCH 表达式的执行步骤如下：</p>
<ul>
<li>对所有行执行第一个条件。</li>
<li>对第一个条件为真的行子集执行第一个“then”子句，并生成部分填充的结果向量。</li>
<li>对第一个条件不真的行执行第二个条件。</li>
<li>对第二个条件为真的行子集执行第二个“then”子句。在执行“then”子句时，将部分填充的结果向量传递给
Expr::eval，并期望表达式使用指定行的计算值更新结果向量，同时保留已计算的结果。</li>
<li>继  续处理所有 (条件, then 子句) 对。如果行数不足，则提前终止。</li>
<li>最后，对剩余行执行 else 子句。如果未指定 else 子句，则将剩余行设置为空值。</li>
</ul>
<p>SWITCH 表达式将 EvalCtx::isFinalSelection 标志设置为 false。表达式
应该使用此标志来决定是否必须保留或覆盖部分填充的结果向量。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-05-25T03:28:26.000Z" itemprop="dateModified">May 25, 2025</time></b> by <b>Jeff lothar</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/pollux/develop/lambda-functions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">如何添加 lambda 函数？</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/pollux/develop/dictionary-encoding"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">字典编码(Dictionary Encoding)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#expression-trees" class="table-of-contents__link toc-highlight">表达式树</a></li><li><a href="#expression-evaluation" class="table-of-contents__link toc-highlight">Expression Evaluation</a><ul><li><a href="#compilation" class="table-of-contents__link toc-highlight">Compilation</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">阅读</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">文档</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation">安装</a></li></ul></div><div class="col footer__col"><div class="footer__title">支持与资源</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/feature-requests">Feature Requests</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/community/support">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">更新</a></li><li class="footer__item"><a href="https://gitee.com/kumo-pub" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kumo-ai.tech" target="_blank" rel="noopener noreferrer" class="footer__link-item">网站<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">版权 © 2025 北京科米智创科技有限公司</div></div></div></footer></div>
</body>
</html>