<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.1.1 docs-doc-page docs-doc-id-pollux/develop/scalar-functions" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">å¦‚ä½•æ·»åŠ æ ‡é‡å‡½æ•°ï¼Ÿ | Kumo AI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kumo-pub.github.io/docs/pollux/develop/scalar-functions"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.1.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" name="docsearch:version" content="1.1.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" property="og:title" content="å¦‚ä½•æ·»åŠ æ ‡é‡å‡½æ•°ï¼Ÿ | Kumo AI"><meta data-rh="true" name="description" content="ç®€å•çš„åŠŸèƒ½"><meta data-rh="true" property="og:description" content="ç®€å•çš„åŠŸèƒ½"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://kumo-pub.github.io/docs/pollux/develop/scalar-functions"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/pollux/develop/scalar-functions" hreflang="en"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/pollux/develop/scalar-functions" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kumo AI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kumo AI Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Kumo AI JSON Feed">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E5CR2Q1NRE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E5CR2Q1NRE",{})</script>


<link rel="alternate" type="application/rss+xml" href="/changelog/rss.xml" title="Docusaurus changelog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/changelog/atom.xml" title="Docusaurus changelog Atom Feed">
<link rel="alternate" type="application/json" href="/changelog/feed.json" title="Docusaurus changelog JSON Feed">



<link rel="icon" href="/img/docusaurus.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/docusaurus.png">
<link rel="mask-icon" href="/img/docusaurus.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/docusaurus.png">
<meta name="msapplication-TileColor" content="#000">



<link rel="alternate" type="application/rss+xml" href="/tests/blog/rss.xml" title="Docusaurus Tests Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tests/blog/atom.xml" title="Docusaurus Tests Blog Atom Feed">
<link rel="alternate" type="application/json" href="/tests/blog/feed.json" title="Docusaurus Tests Blog JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kumo AI" href="/opensearch.xml">

<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.21fbef88.css">
<script src="/assets/js/runtime~main.cf79a945.js" defer="defer"></script>
<script src="/assets/js/main.4244a726.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme-b4f")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss-b4f")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">ğŸ‰ï¸ <b><a target="_blank" href="https://docusaurus.io/blog/releases/1.1">Kumo v1.1</a> is out!</b> ğŸ¥³ï¸</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"></div><b class="navbar__title text--truncate">ä¸»é¡µ</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/docs/category/kmsearch">API</a><a class="navbar__item navbar__link" href="/blog">åšå®¢</a><a class="navbar__item navbar__link" href="/changelog">å‘å¸ƒ</a><a class="navbar__item navbar__link" href="/showcase">åº”ç”¨æ¡ˆä¾‹</a><a class="navbar__item navbar__link" href="/community/support">æ”¯æŒä¸èµ„æº</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/pollux/develop/scalar-functions">1.1.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next">nightly ğŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/pollux/develop/scalar-functions">1.1.1</a></li><li><hr class="dropdown-separator"></li><li class="dropdown-archived-versions"><b>Archived versions</b></li><li><a href="https://docusaurus-archive-october-2023.netlify.app/docs/2.3.1" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.0.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://v1.docusaurus.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.x.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/pollux/develop/scalar-functions" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://github.com/facebook/docusaurus/issues/3526" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"><b>ä¸»é¡µ</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/åŸºç¡€å‡†å¤‡">åŸºç¡€å‡†å¤‡</a><button aria-label="Collapse sidebar category &#x27;åŸºç¡€å‡†å¤‡&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_be">åç«¯å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_fe">å‰ç«¯å¼€å‘ç¯å¢ƒ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æŒç»­é›†æˆ----kmpkg">æŒç»­é›†æˆ -- kmpkg</a><button aria-label="Expand sidebar category &#x27;æŒç»­é›†æˆ -- kmpkg&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/cå¼€å‘">c++å¼€å‘</a><button aria-label="Expand sidebar category &#x27;c++å¼€å‘&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æœç´ åŸºç¡€å¼€å‘">æœç´ åŸºç¡€å¼€å‘</a><button aria-label="Expand sidebar category &#x27;æœç´ åŸºç¡€å¼€å‘&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æœç´¢åº”ç”¨å¼€å‘">æœç´¢åº”ç”¨å¼€å‘</a><button aria-label="Expand sidebar category &#x27;æœç´¢åº”ç”¨å¼€å‘&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/å‘é‡æ•°æ®åº“æ•™ç¨‹">å‘é‡æ•°æ®åº“æ•™ç¨‹</a><button aria-label="Expand sidebar category &#x27;å‘é‡æ•°æ®åº“æ•™ç¨‹&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/æœç´¢ç»Ÿä¸€æ‰§è¡Œå¼•æ“">æœç´¢ç»Ÿä¸€æ‰§è¡Œå¼•æ“</a><button aria-label="Collapse sidebar category &#x27;æœç´¢ç»Ÿä¸€æ‰§è¡Œå¼•æ“&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/overview">pollux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/presto-functions">Presto Functions</a><button aria-label="Expand sidebar category &#x27;Presto Functions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/å¼€å‘æ–‡æ¡£">å¼€å‘æ–‡æ¡£</a><button aria-label="Collapse sidebar category &#x27;å¼€å‘æ–‡æ¡£&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/types">Types(æ•°æ®ç±»å‹)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/vectors">Vectors(å‘é‡)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pollux/develop/scalar-functions">å¦‚ä½•æ·»åŠ æ ‡é‡å‡½æ•°ï¼Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/aggregate-functions">å¦‚ä½•æ·»åŠ èšåˆå‡½æ•°ï¼Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/view-and-writer-types">è§†å›¾å’Œç¼–å†™å™¨ç±»å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/lambda-functions">å¦‚ä½•æ·»åŠ  lambda å‡½æ•°ï¼Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/expression-evaluation">è¡¨è¾¾å¼è®¡ç®— (Expression Evaluation)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/dictionary-encoding">å­—å…¸ç¼–ç (Dictionary Encoding)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/arena">Arena Allocation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/hash-table">Hash table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/aggregations">èšåˆ(Aggregations)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/connectors">Connectors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/joins">Joins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/anti-join">Anti joins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/operators">Plan Nodes and Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/task">What&#x27;s in the Task?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/simd">SIMD Usage in Pollux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/memory">Memory Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/spilling">Spilling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/serialization">Serialization</a><button aria-label="Expand sidebar category &#x27;Serialization&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/è°ƒè¯•">è°ƒè¯•</a><button aria-label="Expand sidebar category &#x27;è°ƒè¯•&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/æµ‹è¯•">æµ‹è¯•</a><button aria-label="Expand sidebar category &#x27;æµ‹è¯•&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/timestamp">Timestamp and Timezone Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/window">Window functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pollux/develop/dynamic-loading">Dynamic Loading of Pollux Extensions</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æœç´¢-ui">æœç´¢ UI</a><button aria-label="Expand sidebar category &#x27;æœç´¢ UI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/æœç´¢ç»Ÿä¸€æ‰§è¡Œå¼•æ“"><span itemprop="name">æœç´¢ç»Ÿä¸€æ‰§è¡Œå¼•æ“</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/å¼€å‘æ–‡æ¡£"><span itemprop="name">å¼€å‘æ–‡æ¡£</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">å¦‚ä½•æ·»åŠ æ ‡é‡å‡½æ•°ï¼Ÿ</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.1.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>å¦‚ä½•æ·»åŠ æ ‡é‡å‡½æ•°ï¼Ÿ</h1></header>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="simple-functions">ç®€å•çš„åŠŸèƒ½<a href="#simple-functions" class="hash-link" aria-label="Direct link to ç®€å•çš„åŠŸèƒ½" title="Direct link to ç®€å•çš„åŠŸèƒ½">â€‹</a></h2>
<p>æœ¬æ–‡æ¡£ä»‹ç»äº† Pollux ä¸­ç®€å•å‡½æ•° API çš„ä¸»è¦æ¦‚å¿µã€åŠŸèƒ½å’Œç¤ºä¾‹ã€‚å¦‚éœ€æ›´å¤šå®é™… API ä½¿ç”¨ç¤ºä¾‹ï¼Œè¯·æŸ¥çœ‹ <strong>pollux/example/simple_functions.cpp</strong>ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„æ ‡é‡å‡½æ•°ï¼Œä¾‹å¦‚ï¼š<code>æ•°å­¦å‡½æ•°&lt;/functions/presto/math&gt;</code>ï¼Œå¯ä»¥é€šè¿‡å°† C++ å‡½æ•°åŒ…è£…åˆ°æ¨¡æ¿ç±»ä¸­æ¥æ·»åŠ ã€‚ä¾‹å¦‚ï¼Œceil å‡½æ•°å¯ä»¥å®ç°å¦‚ä¸‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CeilFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TExec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> T</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ceil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‰€æœ‰ç®€å•å‡½æ•°ç±»éƒ½éœ€è¦æ¨¡æ¿åŒ–ï¼Œå¹¶æä¾›ä¸€ä¸ªâ€œcallâ€æ–¹æ³•ï¼ˆæˆ–ä¸‹æ–‡æè¿°çš„å˜ä½“ä¹‹ä¸€ï¼‰ã€‚é¡¶çº§æ¨¡æ¿å‚æ•°æä¾›äº†ç±»å‹ç³»ç»Ÿé€‚é…å™¨ï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨éåŸå§‹
ç±»å‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°ç»„ã€æ˜ å°„å’Œç»“æ„ä½“ï¼ˆè¯·å‚é˜…ä¸‹æ–‡çš„ç¤ºä¾‹ï¼‰ã€‚è™½ç„¶é¡¶çº§æ¨¡æ¿å‚æ•°ä¸ç”¨äºæ“ä½œåŸå§‹ç±»å‹çš„å‡½æ•°ï¼ˆä¾‹å¦‚ä¸Šä¾‹ä¸­çš„å‡½æ•°ï¼‰ï¼Œä½†ä»éœ€è¦æŒ‡å®šå®ƒã€‚</p>
<p>è°ƒç”¨æ–¹æ³•æœ¬èº«ä¹Ÿå¯ä»¥æ¨¡æ¿åŒ–æˆ–é‡è½½ï¼Œä»¥ä¾¿é’ˆå¯¹ä¸åŒçš„è¾“å…¥ç±»å‹ï¼ˆä¾‹å¦‚ float å’Œ doubleï¼‰è°ƒç”¨è¯¥å‡½æ•°ã€‚è¯·æ³¨æ„ï¼Œ
æ¨¡æ¿å®ä¾‹åŒ–åªä¼šåœ¨å‡½æ•°æ³¨å†ŒæœŸé—´è¿›è¡Œï¼Œå…·ä½“æ“ä½œè¯·å‚è§ä¸‹æ–‡çš„<code>æ³¨å†Œ</code>éƒ¨åˆ†ã€‚</p>
<p>è¯·å‹¿ä½¿ç”¨æ—§ç‰ˆ POLLUX_UDF_BEGIN å’Œ POLLUX_UDF_END å®ã€‚</p>
<p><code>call</code>å‡½æ•°ï¼ˆæˆ–å…¶å˜ä½“ï¼‰å¯èƒ½è¿”å› (a) void å€¼ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸è¿œä¸ä¼šè¿”å›ç©ºå€¼ï¼›æˆ–è€… (b) boolean å€¼ï¼Œè¡¨ç¤ºè®¡ç®—ç»“æœæ˜¯å¦ä¸ºç©ºã€‚è¿”å›
çš„å¸ƒå°”å€¼çš„å«ä¹‰æ˜¯â€œç»“æœå·²è®¾ç½®â€ï¼Œå³ true è¡¨ç¤ºå·²å¡«å……éç©ºç»“æœï¼Œfalse è¡¨ç¤ºæ— ï¼ˆç©ºï¼‰ç»“æœã€‚å¦‚æœ<code>ceil(0)</code>è¿”å›ç©ºå€¼ï¼Œåˆ™è¯¥å‡½æ•°å¯ä»¥é‡å†™å¦‚ä¸‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">NullableCeilFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TExec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> T</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ceil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> a </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Return NULL if input is zero.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å‚æ•°åˆ—è¡¨å¿…é¡»ä»¥è¾“å‡ºå‚æ•°â€œresultâ€å¼€å¤´ï¼Œåè·Ÿå‡½æ•°å‚æ•°ã€‚â€œresultâ€å‚æ•°å¿…é¡»æ˜¯å¼•ç”¨ã€‚å‡½æ•°å‚æ•°å¿…é¡»æ˜¯ const å¼•ç”¨ã€‚å‡½æ•°å‚æ•°å’Œç»“æœå‚æ•°çš„ C++
ç±»å‹å¿…é¡»ä¸ :doc:<code>Pollux ç±»å‹&lt;/develop/types&gt;</code> åŒ¹é…ã€‚</p>
<table><thead><tr><th>Pollux Type</th><th>C++ Argument Type</th><th>C++ Result Type</th></tr></thead><tbody><tr><td>BOOLEAN</td><td><code>arg_type&lt;bool&gt;</code></td><td><code>out_type&lt;bool&gt;</code></td></tr><tr><td>TINYINT</td><td><code>arg_type&lt;int8_t&gt;</code></td><td><code>out_type&lt;int8_t&gt;</code></td></tr><tr><td>SMALLINT</td><td><code>arg_type&lt;int16_t&gt;</code></td><td><code>out_type&lt;int16_t&gt;</code></td></tr><tr><td>INTEGER</td><td><code>arg_type&lt;int32_t&gt;</code></td><td><code>out_type&lt;int32_t&gt;</code></td></tr><tr><td>BIGINT</td><td><code>arg_type&lt;int64_t&gt;</code></td><td><code>out_type&lt;int64_t&gt;</code></td></tr><tr><td>REAL</td><td><code>arg_type&lt;float&gt;</code></td><td><code>out_type&lt;float&gt;</code></td></tr><tr><td>DOUBLE</td><td><code>arg_type&lt;double&gt;</code></td><td><code>out_type&lt;double&gt;</code></td></tr><tr><td>TIMESTAMP</td><td><code>arg_type&lt;Timestamp&gt;</code></td><td><code>out_type&lt;Timestamp&gt;</code></td></tr><tr><td>DATE</td><td><code>arg_type&lt;Date&gt;</code></td><td><code>out_type&lt;Date&gt;</code></td></tr><tr><td>VARCHAR</td><td><code>arg_type&lt;Varchar&gt;</code></td><td><code>out_type&lt;Varchar&gt;</code></td></tr><tr><td>VARBINARY</td><td><code>arg_type&lt;Varbinary&gt;</code></td><td><code>out_type&lt;Varbinary&gt;</code></td></tr><tr><td>ARRAY</td><td><code>arg_type&lt;Array&lt;E&gt;&gt;</code></td><td><code>out_type&lt;Array&lt;E&gt;&gt;</code></td></tr><tr><td>MAP</td><td><code>arg_type&lt;Map&lt;K,V&gt;&gt;</code></td><td><code>out_type&lt;Map&lt;K,V&gt;&gt;</code></td></tr><tr><td>ROW</td><td><code>arg_type&lt;Row&lt;T1,T2,...&gt;&gt;</code></td><td><code>out_type&lt;Row&lt;T1,T2,...&gt;&gt;</code></td></tr></tbody></table>
<p>arg_type å’Œ out_type æ¨¡æ¿ç”±ç»“æ„ä½“å®šä¹‰ä¸­çš„
<code>POLLUX_DEFINE_FUNCTION_TYPES(TExec)</code> å®å®šä¹‰ã€‚å¯¹äºåŸå§‹ç±»å‹ï¼Œ<code>arg_type&lt;T&gt;</code> ä¸ <code>out_type&lt;T&gt;</code> å’Œ <code>T</code> ç›¸åŒã€‚
è¿™é€‚ç”¨äºå¸ƒå°”å€¼ã€æ•´æ•°ã€æµ®ç‚¹ç±»å‹å’Œæ—¶é—´æˆ³ã€‚
å¯¹äº DATEï¼Œ<code>arg_type&lt;Date&gt;</code> ä¸ <code>out_type&lt;Date&gt;</code> ç›¸åŒï¼Œå®šä¹‰ä¸º int32_tã€‚</p>
<p>ä¸€ä¸ªæ¥å—æ•´æ•°å’ŒåŒç²¾åº¦æ•°å¹¶è¿”å›åŒç²¾åº¦æ•°çš„å‡½æ•°çš„ç­¾åå¦‚ä¸‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ç›¸å½“äº</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int32_t</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¯¹äºå­—ç¬¦ä¸²ï¼Œ<code>arg_type&lt;Varchar&gt;</code> å®šä¹‰ä¸º <code>StringView</code>ï¼Œè€Œ <code>out_type&lt;Varchar&gt;</code> å®šä¹‰ä¸º <code>StringWriter</code>ã€‚</p>
<p>Varcharã€Arrayã€Map å’Œ Row ç±»å‹çš„ arg_type å’Œ out_type æä¾›ç±»ä¼¼äº <code>std::string</code>ã€<code>std::vector</code>ã€<code>melon::F14FastMap</code>
å’Œ <code>std::tuple</code> çš„æ¥å£ã€‚åº•å±‚å®ç°ç»è¿‡ä¼˜åŒ–ï¼Œæ— éœ€é¢å¤–å¤åˆ¶å³å¯ä»åˆ—å¼è¡¨ç¤ºä¸­è¯»å–å’Œå†™å…¥æ•°æ®ã€‚æ›´å¤šå…³äºå­—ç¬¦ä¸²å’Œå¤æ‚ç±»å‹çš„ arg_type
å’Œ out_type çš„è§£é‡Šå’Œ APIï¼Œè¯·å‚é˜… <code>view-and-writer-types</code>ã€‚</p>
<p>æ³¨æ„ï¼šç›®å‰ä¸è¦è¿‡å¤šå…³æ³¨å¤æ‚ç±»å‹æ˜ å°„ã€‚
ä¸ºäº†å®Œæ•´æ€§èµ·è§ï¼Œè¿™é‡ŒåªåŒ…å«å®ƒä»¬ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="null-behavior">ç©ºè¡Œä¸º<a href="#null-behavior" class="hash-link" aria-label="Direct link to ç©ºè¡Œä¸º" title="Direct link to ç©ºè¡Œä¸º">â€‹</a></h2>
<p>å¤§å¤šæ•°å‡½æ•°éƒ½æœ‰é»˜è®¤çš„ç©ºå€¼è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œä»»ä½•å‚æ•°ä¸­çš„ç©ºå€¼éƒ½ä¼šäº§ç”Ÿç©ºå€¼ç»“æœã€‚è¡¨è¾¾å¼æ±‚å€¼å¼•æ“ä¼šè‡ªåŠ¨ä¸ºæ­¤ç±»è¾“å…¥ç”Ÿæˆç©ºå€¼ï¼Œä»è€Œé¿å…è°ƒç”¨
å®é™…å‡½æ•°ã€‚å¦‚æœç»™å®šå‡½æ•°å¯¹ç©ºå€¼è¾“å…¥æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œåˆ™å¿…é¡»å®šä¹‰ä¸€ä¸ª<code>callNullable</code>å‡½æ•°ï¼Œè€Œä¸æ˜¯<code>call</code>å‡½æ•°ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ª ceil å‡½æ•°çš„
äººå·¥ç¤ºä¾‹ï¼Œè¯¥å‡½æ•°å¯¹ç©ºå€¼è¾“å…¥è¿”å› 0ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CeilFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">callNullable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> T</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Return 0 if input is null.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ceil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼ŒcallNullable å‡½æ•°æ¥å—çš„å‚æ•°æ˜¯åŸå§‹æŒ‡é’ˆè€Œéå¼•ç”¨ï¼Œä»¥ä¾¿å¯ä»¥æŒ‡å®šç©ºå€¼ã€‚<code>callNullable()</code> ä¹Ÿå¯ä»¥è¿”å› <code>void</code>ï¼Œä»¥æŒ‡ç¤ºè¯¥å‡½æ•°ä¸äº§ç”Ÿç©ºå€¼ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="null-free-fast-path">æ— ç©ºå¿«é€Ÿè·¯å¾„<a href="#null-free-fast-path" class="hash-link" aria-label="Direct link to æ— ç©ºå¿«é€Ÿè·¯å¾„" title="Direct link to æ— ç©ºå¿«é€Ÿè·¯å¾„">â€‹</a></h2>
<p><code>callNullFree</code>å‡½æ•°å¯ä»¥ä»£æ›¿<code>call</code>å’Œ/æˆ–<code>callNullable</code>å‡½æ•°å®ç°ï¼Œæˆ–ä¸å…¶åŒæ—¶å®ç°ã€‚å¦‚æœä»…å®ç°<code>callNullFree</code>å‡½æ•°ï¼Œåˆ™å¦‚æœä»»ä½•è¾“å…¥
å‚æ•°ä¸ºç©ºï¼ˆç±»ä¼¼é»˜è®¤çš„ç©ºå€¼è¡Œä¸ºï¼‰ï¼Œæˆ–è€…ä»»ä½•è¾“å…¥å‚æ•°ä¸ºå¤æ‚ç±»å‹ä¸”å…¶å€¼ä¸­åŒ…å«ç©ºå€¼ï¼ˆä¾‹å¦‚ï¼ŒåŒ…å«ç©ºå€¼å…ƒç´ çš„æ•°ç»„ï¼‰ï¼Œåˆ™å°†è·³è¿‡å¯¹è¯¥å‡½æ•°çš„æ±‚å€¼ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆç©ºå€¼ã€‚
å¦‚æœ<code>callNullFree</code>ä¸<code>call</code>å’Œ/æˆ–<code>callNullable</code>å‡½æ•°åŒæ—¶å®ç°ï¼Œåˆ™å°†å¯¹æ‰¹å¤„ç†åº”ç”¨ <code>O(N * D)</code> æ£€æŸ¥ï¼Œä»¥æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•è¾“å…¥å‚æ•°å¯èƒ½ä¸ºç©ºæˆ–åŒ…å«ç©º
å€¼ï¼Œå…¶ä¸­ N æ˜¯è¾“å…¥å‚æ•°çš„æ•°é‡ï¼ŒD æ˜¯å¤æ‚ç±»å‹åµŒå¥—çš„æ·±åº¦ã€‚åªæœ‰å½“èƒ½å¤Ÿæ˜ç¡®ç¡®å®šä¸å­˜åœ¨ç©ºå€¼æ—¶ï¼Œæ‰ä¼šè°ƒç”¨<code>callNullFree</code>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ
<code>callNullFree</code> å¯ä»¥å……å½“å¿«é€Ÿè·¯å¾„ï¼Œé¿å…ä»»ä½•æ¯è¡Œçš„ç©ºå€¼æ£€æŸ¥ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ array_min å‡½æ•°çš„ç¤ºä¾‹ï¼Œè¯¥å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„æœ€å°å€¼ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ArrayMinFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TExec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TInput</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">callNullFree</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TInput</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> null_free_arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Array</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TInput</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      out </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> INT32_MAX</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> i </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#D73A49">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          out </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œåœ¨<code>callNullFree</code>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®<code>array</code>å…ƒç´ è€Œæ— éœ€æ£€æŸ¥å…¶æ˜¯å¦ä¸ºç©ºã€‚å¦è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å°†è¾“å…¥ç±»å‹åŒ…è£…åœ¨
<code>null_free_arg_type&lt;...&gt;</code> æ¨¡æ¿ä¸­ï¼Œè€Œä¸æ˜¯ <code>arg_type&lt;...&gt;</code> æ¨¡æ¿ä¸­ã€‚è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºåœ¨<code>callNullFree</code>å‡½æ•°ä¸­ï¼Œ
å¤æ‚ç±»å‹çš„è¾“å…¥ç±»å‹ä¸è®¿é—®æ—¶ä¸åŒ…è£…åœ¨ç±»ä¼¼ <code>std::optional</code> çš„æ¥å£ä¸­çš„å¤æ‚ç±»å‹ä¸åŒã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="determinism">å†³å®šè®º<a href="#determinism" class="hash-link" aria-label="Direct link to å†³å®šè®º" title="Direct link to å†³å®šè®º">â€‹</a></h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç®€å•å‡½æ•°è¢«å‡å®šä¸ºç¡®å®šæ€§çš„ï¼Œä¾‹å¦‚ï¼Œç»™å®šç›¸åŒçš„è¾“å…¥ï¼Œå®ƒä»¬æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„ç»“æœã€‚å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œ
è¯¥å‡½æ•°å¿…é¡»å®šä¹‰ä¸€ä¸ª <code>static constexpr bool is_deterministic</code> æˆå‘˜ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">static</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> is_deterministic </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤ç±»å‡½æ•°çš„ä¸€ä¸ªä¾‹å­æ˜¯ <code>rand()</code>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">RandFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">static</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> is_deterministic </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> melon</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Random</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">randDouble01</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="all-ascii-fast-path">å…¨ ASCII å¿«é€Ÿè·¯å¾„<a href="#all-ascii-fast-path" class="hash-link" aria-label="Direct link to å…¨ ASCII å¿«é€Ÿè·¯å¾„" title="Direct link to å…¨ ASCII å¿«é€Ÿè·¯å¾„">â€‹</a></h2>
<p>å¤„ç†å­—ç¬¦ä¸²è¾“å…¥çš„å‡½æ•°å¿…é¡»èƒ½å¤Ÿæ­£ç¡®å¤„ç† UTF-8 è¾“å…¥ã€‚
ä½†æ˜¯ï¼Œå¦‚æœå·²çŸ¥è¾“å…¥ä»…åŒ…å« ASCII å­—ç¬¦ï¼Œè¿™äº›å‡½æ•°é€šå¸¸å¯ä»¥æ›´é«˜æ•ˆåœ°å®ç°ã€‚æ­¤ç±»å‡½æ•°å¯ä»¥æä¾›<code>call</code>æ–¹æ³•æ¥å¤„ç† UTF-8 å­—ç¬¦ä¸²ï¼Œ
ä»¥åŠ<code>callAscii</code>æ–¹æ³•æ¥å¤„ç†çº¯ ASCII å­—ç¬¦ä¸²ã€‚å¼•æ“å°†æ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²ï¼Œå¦‚æœè¾“å…¥å…¨éƒ¨ä¸º ASCIIï¼Œåˆ™è°ƒç”¨<code>callAscii</code>æ–¹æ³•ï¼›å¦‚æœè¾“å…¥å¯èƒ½åŒ…å«å¤šå­—èŠ‚å­—ç¬¦ï¼Œåˆ™è°ƒç”¨<code>call</code>ã€‚</p>
<p>æ­¤å¤–ï¼Œå¤§å¤šæ•°æ¥å—å­—ç¬¦ä¸²è¾“å…¥å¹¶ç”Ÿæˆå­—ç¬¦ä¸²è¾“å‡ºçš„å‡½æ•°éƒ½å…·æœ‰æ‰€è°“çš„é»˜è®¤ ASCII è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œå…¨ ASCII è¾“å…¥ä¿è¯å…¨ ASCII è¾“å‡ºã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œå‡½æ•°å¯ä»¥é€šè¿‡å®š
  ä¹‰ is_default_ascii_behavior æˆå‘˜å˜é‡å¹¶å°†å…¶åˆå§‹åŒ–ä¸º true æ¥æŒ‡ç¤ºã€‚å¼•æ“ä¼šè‡ªåŠ¨å°†ç»“æœå­—ç¬¦ä¸²æ ‡è®°ä¸ºå…¨ ASCIIã€‚å½“è¿™äº›å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ä¼ é€’ç»™
å…¶ä»–å‡½æ•°æ—¶ï¼Œå¼•æ“æ— éœ€æ‰«æè¿™äº›å­—ç¬¦ä¸²æ¥ç¡®å®šå®ƒä»¬æ˜¯å¦ä¸º ASCIIã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¿®å‰ªå‡½æ•°çš„ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TrimFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TExec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// ASCII input always produces ASCII result.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">static</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> is_default_ascii_behavior </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Properly handles multi-byte characters.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        out_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stringImpl</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">trimUnicodeWhiteSpace</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">leftTrim</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> rightTrim</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Assumes input is all ASCII.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">callAscii</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        out_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stringImpl</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">trimAsciiWhiteSpace</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">leftTrim</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> rightTrim</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="zero-copy-string-result">é›¶æ‹·è´å­—ç¬¦ä¸²ç»“æœ<a href="#zero-copy-string-result" class="hash-link" aria-label="Direct link to é›¶æ‹·è´å­—ç¬¦ä¸²ç»“æœ" title="Direct link to é›¶æ‹·è´å­—ç¬¦ä¸²ç»“æœ">â€‹</a></h2>
<p><code>substr</code> å’Œ :func:<code>trim</code> ç­‰å‡½æ•°å¯ä»¥é€šè¿‡å¼•ç”¨è¾“å…¥å­—ç¬¦ä¸²æ¥ç”Ÿæˆé›¶æ‹·è´ç»“æœã€‚ä¸ºæ­¤ï¼Œå®ƒä»¬å¿…é¡»å®šä¹‰ä¸€ä¸ª reuse_strings_from_arg æˆå‘˜å˜é‡ï¼Œ
å¹¶å°†å…¶åˆå§‹åŒ–ä¸ºåœ¨ç»“æœä¸­é‡å¤ä½¿ç”¨å…¶å­—ç¬¦ä¸²çš„å‚æ•°çš„ç´¢å¼•ã€‚è¿™å°†å…è®¸å¼•æ“å°†å¯¹è¾“å…¥å­—ç¬¦ä¸²ç¼“å†²åŒºçš„å¼•ç”¨æ·»åŠ åˆ°ç»“æœå‘é‡ï¼Œå¹¶ç¡®ä¿è¿™äº›ç¼“å†²åŒºä¸ä¼šè¿‡æ—©æ¶ˆå¤±ã€‚è¾“å‡ºç±»
å‹å¯ä»¥æ˜¯æ ‡é‡å­—ç¬¦ä¸²ï¼ˆvarchar å’Œ varbinariesï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å­—ç¬¦ä¸²çš„å¤æ‚ç±»å‹ï¼Œä¾‹å¦‚æ•°ç»„ã€æ˜ å°„å’Œè¡Œã€‚</p>
<p>out_type æ¨¡æ¿çš„ setNoCopy æ–¹æ³•å¯ç”¨äºå°†ç»“æœè®¾ç½®ä¸ºè¾“å…¥å‚æ•°ä¸­çš„å­—ç¬¦ä¸²ï¼Œè€Œæ— éœ€è¿›è¡Œå¤åˆ¶ã€‚setEmpty æ–¹æ³•å¯ç”¨äºå°†ç»“æœè®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Results refer to strings in the first argument.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">static</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int32_t</span><span class="token plain"> reuse_strings_from_arg </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä»¥ä¸‹æ˜¯é›¶æ‹·è´å‡½æ•°çš„ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TrimFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TExec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Results refer to strings in the first argument.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">static</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int32_t</span><span class="token plain"> reuse_strings_from_arg </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        out_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">setEmpty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">setNoCopy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stringImpl</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">trimUnicodeWhiteSpace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-to-session-properties-and-constant-inputs">è®¿é—®ä¼šè¯å±æ€§å’Œå¸¸é‡è¾“å…¥<a href="#access-to-session-properties-and-constant-inputs" class="hash-link" aria-label="Direct link to è®¿é—®ä¼šè¯å±æ€§å’Œå¸¸é‡è¾“å…¥" title="Direct link to è®¿é—®ä¼šè¯å±æ€§å’Œå¸¸é‡è¾“å…¥">â€‹</a></h2>
<p>æŸäº›å‡½æ•°éœ€è¦è®¿é—®ä¼šè¯å±æ€§ï¼Œä¾‹å¦‚ä¼šè¯çš„æ—¶åŒºã€‚
ä¾‹å¦‚ Presto çš„ :func:<code>day</code>ã€:func:<code>hour</code> å’Œ :func:<code>minute</code> å‡½æ•°ã€‚å…¶ä»–å‡½æ•°å¯ä»¥é€šè¿‡é¢„å¤„ç†æŸäº›å¸¸é‡è¾“å…¥æ¥è·ç›Šï¼Œä¾‹å¦‚ç¼–è¯‘æ­£åˆ™è¡¨è¾¾
å¼æ¨¡å¼æˆ–è§£ææ—¥æœŸå’Œæ—¶é—´å•ä½ã€‚ä¸ºäº†è®¿é—®ä¼šè¯å±æ€§å’Œå¸¸é‡è¾“å…¥ï¼Œå‡½æ•°å¿…é¡»å®šä¹‰ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæŒ‡å‘ QueryConfig çš„å¸¸é‡å¼•ç”¨ä»¥åŠæ¯ä¸ªè¾“å…¥
å‚æ•°çš„å¸¸é‡æŒ‡é’ˆåˆ—è¡¨ã€‚å¸¸é‡è¾“å…¥å°†æŒ‡å®šå…¶å€¼ã€‚éå¸¸é‡è¾“å…¥å°†ä½œä¸º nullptr ä¼ é€’ã€‚åˆå§‹åŒ–æ–¹æ³•çš„ç­¾åç±»ä¼¼äº callNullable æ–¹æ³•ï¼Œä½†ç¬¬ä¸€ä¸ªå‚æ•°ä¸º
<code>const core::QueryConfig&amp;</code>ã€‚å¼•æ“ä¼šåœ¨æ¯æ¬¡æŸ¥è¯¢å’Œæ‰§è¡Œçº¿ç¨‹ä¸­è°ƒç”¨ä¸€æ¬¡åˆå§‹åŒ–æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå°æ—¶å‡½æ•°çš„ç¤ºä¾‹ï¼Œå®ƒä»ä¼šè¯å±æ€§ä¸­æå–æ—¶åŒºï¼Œå¹¶åœ¨å¤„ç†è¾“å…¥æ—¶ä½¿ç”¨å®ƒã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">HourFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TExec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> tz</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TimeZone</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> timeZone_ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">initialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TypePtr</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> inputTypes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> core</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">QueryConfig</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Timestamp</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*timestamp*/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      timeZone_ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">getTimeZoneFromConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">int64_t</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Timestamp</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">int64_t</span><span class="token plain"> seconds </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">getSeconds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timeZone_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">tm dateTime</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">gmtime_r</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> time_t</span><span class="token operator" style="color:#D73A49">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">seconds</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">dateTime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> dateTime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tm_hour</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯´æ˜<code>date_trunc</code> å‡½æ•°åœ¨åˆå§‹åŒ–æœŸé—´è§£æå¸¸é‡å•ä½å‚æ•°ï¼Œå¹¶åœ¨å¤„ç†å•ä¸ªè¡Œæ—¶é‡ç”¨è§£æåçš„å€¼ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TExec</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">DateTruncFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TExec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> tz</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TimeZone</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> timeZone_ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">DateTimeUnit</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> unit_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">initialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TypePtr</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> inputTypes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> core</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">QueryConfig</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> unitString</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Timestamp</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*timestamp*/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      timeZone_ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">getTimeZoneFromConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unitString </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        unit_ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">fromDateTimeUnitString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">unitString</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        out_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Timestamp</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> unitString</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Timestamp</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> unit </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          unit_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">has_value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> unit_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">fromDateTimeUnitString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unitString</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">use unit </span><span class="token keyword" style="color:#CF222E">enum</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœ <code>initialize</code> æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸å°†è¢«æ•è·å¹¶æŠ¥å‘Šä¸ºæ¯ä¸€è¡Œæ´»åŠ¨è¡Œçš„è¾“å‡ºã€‚å¦‚æœæ²¡æœ‰æ´»åŠ¨è¡Œï¼Œåˆ™ä¸ä¼šå¼•å‘å¼‚å¸¸ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="registration">å‡½æ•°æ³¨å†Œ<a href="#registration" class="hash-link" aria-label="Direct link to å‡½æ•°æ³¨å†Œ" title="Direct link to å‡½æ•°æ³¨å†Œ">â€‹</a></h2>
<p>ä½¿ç”¨<code>register_function</code>æ¨¡æ¿æ¥æ³¨å†Œç®€å•å‡½æ•°ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">class</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TReturn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> TArgs</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">register_function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> aliases </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Type</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> returnType </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç¬¬ä¸€ä¸ªæ¨¡æ¿å‚æ•°æ˜¯ç±»åï¼Œä¸‹ä¸€ä¸ªæ¨¡æ¿å‚æ•°æ˜¯è¿”å›ç±»å‹ï¼Œå…¶ä½™æ¨¡æ¿å‚æ•°æ˜¯å‚æ•°ç±»å‹ã€‚åˆ«å
å‚æ•°å…è®¸å¼€å‘è€…ä¸ºåŒä¸€ä¸ªå‡½æ•°æŒ‡å®šå¤šä¸ªåç§°ï¼Œ
ä½†æ¯ä¸ªå‡½æ•°æ³¨å†Œè‡³å°‘éœ€è¦æä¾›ä¸€ä¸ªåç§°ã€‚ä¸Šé¢å®šä¹‰çš„â€œceilâ€å‡½æ•°å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡½æ•°è°ƒç”¨è¿›è¡Œæ³¨å†Œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token generic-function function" style="color:#8250DF">register_function</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">CeilFunction</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;ceil&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;ceiling&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬æ³¨å†Œäº†ä¸€ä¸ª CeilFunction å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°å¹¶è¿”å›ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœæˆ‘ä»¬æƒ³å…è®¸ ceil å‡½æ•°åœ¨æµ®ç‚¹æ•°è¾“å…¥ä¸Šè°ƒç”¨ï¼Œ
æˆ‘ä»¬éœ€è¦å†æ¬¡è°ƒç”¨ register_function å‡½æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token generic-function function" style="color:#8250DF">register_function</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">CeilFunction</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">float</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">float</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;ceil&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;ceiling&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªæƒ³è¦æ”¯æŒçš„ç­¾åè°ƒç”¨ register_functionã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªä» Pollux ç±»å‹åˆ° C++ ç±»å‹çš„æ˜ å°„ï¼Œåº”è¯¥åœ¨æ³¨å†ŒæœŸé—´ç”¨äºå‚æ•°å’Œè¿”å›ç±»å‹ã€‚</p>
<table><thead><tr><th>Pollux Type</th><th>C++ Type</th></tr></thead><tbody><tr><td>BOOLEAN</td><td><code>bool</code></td></tr><tr><td>TINYINT</td><td><code>int8_t</code></td></tr><tr><td>SMALLINT</td><td><code>int16_t</code></td></tr><tr><td>INTEGER</td><td><code>int32_t</code></td></tr><tr><td>BIGINT</td><td><code>int64_t</code></td></tr><tr><td>REAL</td><td><code>float</code></td></tr><tr><td>DOUBLE</td><td><code>double</code></td></tr><tr><td>TIMESTAMP</td><td><code>Timestamp</code></td></tr><tr><td>DATE</td><td><code>Date</code></td></tr><tr><td>VARCHAR</td><td><code>Varchar</code></td></tr><tr><td>VARBINARY</td><td><code>Varbinary</code></td></tr><tr><td>ARRAY</td><td><code>Array&lt;E&gt;</code></td></tr><tr><td>MAP</td><td><code>Map&lt;K,V&gt;</code></td></tr><tr><td>ROW</td><td><code>Row&lt;T1,T2,...&gt;</code></td></tr></tbody></table>
<p>ä¾‹å¦‚ï¼Œä¸ºå­—ç¬¦ä¸²è¾“å…¥æ³¨å†Œ array_min å‡½æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token generic-function function" style="color:#8250DF">register_function</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">ArrayMinFunction</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> Varchar</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> Array</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Varchar</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;array_min&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¦ä¸ºä»»ä½•ç±»å‹çš„æ•°ç»„æ³¨å†Œ array_min å‡½æ•°ï¼Œè¯·ä½¿ç”¨ <code>Generic&lt;T1&gt;</code> ä½œä¸ºå…ƒç´ ç±»å‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    register_function</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ArrayMinFunction</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Generic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T1</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Array</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Generic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T1</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;array_min&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç”±äº array_min éœ€è¦å¯¹å…ƒç´ è¿›è¡Œæ’åºä»¥æ‰¾åˆ°æœ€å°å€¼ï¼Œå› æ­¤å…ƒç´ ç±»å‹éœ€è¦æ˜¯å¯æ’åºçš„ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ <code>Orderable&lt;T1&gt;</code> å°†æ•°ç»„å…ƒç´ é™åˆ¶ä¸ºå¯æ’åºçš„ç±»å‹ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    register_function</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ArrayMinFunction</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Orderable</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T1</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Array</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Orderable</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T1</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;array_min&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½ å¯ä»¥åœ¨å‡½æ•°ç­¾åä¸­ä½¿ç”¨å¤šä¸ªæ³›å‹ç±»å‹ã€‚ä¾‹å¦‚ï¼Œè¦æ³¨å†Œ map_top_n å‡½æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    register_function</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MapTopNFunction</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Generic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T1</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Orderable</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T2</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// result map type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Generic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T1</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Orderable</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">T2</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// input map type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">int64_t</span><span class="token plain">                             </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// type of N argument</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;map_top_n&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ³›å‹ç±»å‹å¿…é¡»ä½¿ç”¨ T1ã€T2ã€T3â€¦â€¦ å‘½åã€‚</p>
<p>æœ€åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>Constant&lt;T&gt;</code> æŒ‡å®šå‚æ•°å¿…é¡»æ˜¯å¸¸é‡ã€‚
ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨å¸¸é‡ç§å­å‚æ•°æŒ‡å®šéšæœºç­¾åï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token generic-function function" style="color:#8250DF">register_function</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">RandFunction</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> Constant</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int32_t</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;rand&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="variadic-arguments">å¯å˜å‚æ•°<a href="#variadic-arguments" class="hash-link" aria-label="Direct link to å¯å˜å‚æ•°" title="Direct link to å¯å˜å‚æ•°">â€‹</a></h2>
<p>ç®€å•å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°å¯ä»¥æ ‡è®°ä¸º<code>å¯å˜å‚æ•°</code>ã€‚è¿™æ„å‘³ç€ï¼Œ
è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œå¯ä»¥åœ¨è°ƒç”¨ç»“æŸæ—¶åŒ…å« 0 åˆ° N ä¸ªè¯¥ç±»å‹çš„å‚æ•°ã€‚è™½ç„¶â€œå¯å˜å‚æ•°â€åœ¨ Pollux ä¸­å¹¶éçœŸæ­£çš„ç±»å‹ï¼Œä½†å®ƒå¯ä»¥è¢«è§†ä¸ºä¸€ç§è¯­æ³•ç±»å‹ï¼Œå…¶è¡Œä¸ºä¸æ•°ç»„æœ‰äº›ç±»ä¼¼ã€‚</p>
<table><thead><tr><th>C++ Argument Type</th><th>C++ Actual Argument Type</th></tr></thead><tbody><tr><td><code>arg_type&lt;Variadic&lt;E&gt;&gt;</code></td><td><code>NullableVariadicView&lt;E&gt;</code></td></tr><tr><td><code>null_free_arg_type&lt;Variadic&lt;E&gt;&gt;</code></td><td><code>NullFreeVariadicView&lt;E&gt;</code></td></tr></tbody></table>
<p>ä¸ <code>NullableArrayView</code> å’Œ <code>NullFreeArrayView</code> ç±»ä¼¼ï¼Œ<code>VariadicViews</code> çš„æ¥å£ç±»ä¼¼äº
<em><code>const std::vector&lt;std::optional&lt;V&gt;&gt;</code></em>ã€‚</p>
<p><code>NullableVariadicView å’Œ </code>NullFreeVariadicView` æ”¯æŒä»¥ä¸‹å‡½æ•°ï¼š</p>
<ul>
<li>
<p><code>size_t size()</code>ï¼šè¿”å›å‡½æ•°è°ƒç”¨ä¸­ä½œä¸º<code>Variadic</code>ç±»å‹ä¼ é€’çš„å‚æ•°æ•°é‡ã€‚</p>
</li>
<li>
<p>operand[](size_t index)ï¼šè®¿é—®ç´¢å¼•å¤„çš„å‚æ•°å€¼ã€‚å®ƒè¿”å› <code>null_free_arg_type&lt;E&gt;</code> æˆ– <code>OptionalAccessor&lt;E&gt;</code>ã€‚</p>
</li>
<li>
<p><code>VariadicView&lt;T&gt;::Iterator begin()</code>ï¼šæŒ‡å‘ç¬¬ä¸€ä¸ªå‚æ•°çš„è¿­ä»£å™¨ã€‚</p>
</li>
<li>
<p><code>VariadicView&lt;T&gt;::Iterator end()</code>ï¼šæŒ‡ç¤ºè¿­ä»£ç»“æŸçš„è¿­ä»£å™¨ã€‚</p>
</li>
<li>
<p><code>bool mayHaveNulls()</code>ï¼šæ£€æŸ¥å‚æ•°æ˜¯å¦ä¸ºç©ºï¼ˆæ³¨æ„ï¼Œè¿™éœ€è¦çš„æ—¶é—´ä¸å‚æ•°æ•°é‡æˆæ­£æ¯”ï¼‰ã€‚å¦‚æœè¿”å› <code>false</code>ï¼Œåˆ™è‚¯å®šä¸å­˜åœ¨ç©ºå€¼ï¼›å¦‚æœè¿”å› <code>true</code>ï¼Œåˆ™ä¸ä¿è¯å­˜åœ¨ç©ºå€¼ã€‚</p>
</li>
<li>
<p><code>VariadicView&lt;T&gt;::SkipNullsContainer SkipNulls()</code>ï¼šè¿”å›ä¸€ä¸ªå¯è¿­ä»£å®¹å™¨ï¼Œè¯¥å®¹å™¨å¯ç›´æ¥è®¿é—®æ¯ä¸ªå…·æœ‰éç©ºå€¼çš„å‚æ•°ã€‚</p>
</li>
</ul>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†ä¸€ä¸ªè¿æ¥å¯å˜æ•°é‡å­—ç¬¦ä¸²çš„å‡½æ•°ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">VariadicArgsReaderFunction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token function" style="color:#8250DF">POLLUX_DEFINE_FUNCTION_TYPES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       MELON_ALWAYS_INLINE </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           out_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> arg_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Variadic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Varchar</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> input </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">has_value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             output </span><span class="token operator" style="color:#D73A49">+=</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="vector-functions">å‘é‡å‡½æ•°<a href="#vector-functions" class="hash-link" aria-label="Direct link to å‘é‡å‡½æ•°" title="Direct link to å‘é‡å‡½æ•°">â€‹</a></h2>
<p>ç®€å•å‡½æ•°å¤„ç†å•è¡Œå¹¶ç”Ÿæˆå•ä¸ªå€¼ã€‚
å‘é‡å‡½æ•°å¤„ç†ä¸€æ‰¹æˆ–å¤šè¡Œæ•°æ®å¹¶ç”Ÿæˆä¸€ä¸ªå‘é‡ç»“æœã€‚
åœ¨å®ç°å‡½æ•°æ—¶ï¼Œé™¤éå‘é‡å‡½æ•°çš„å®ç°èƒ½å¤Ÿæ˜¾è‘—æå‡æ€§èƒ½ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡åŸºå‡†æµ‹è¯•è¯æ˜ï¼Œå¦åˆ™ä¼˜å…ˆä½¿ç”¨ç®€å•å‡½æ•°ã€‚
å‘é‡å‡½æ•°çš„ä¸€äº›å®šä¹‰ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li>å°†å‘é‡ä½œä¸ºè¾“å…¥å¹¶ç”Ÿæˆå‘é‡ç»“æœï¼›</li>
<li>å¯ä»¥è®¿é—®å‘é‡ç¼–ç å’Œå…ƒæ•°æ®ï¼›</li>
<li>å¯ä»¥é’ˆå¯¹é€šç”¨è¾“å…¥ç±»å‹è¿›è¡Œå®šä¹‰ï¼Œä¾‹å¦‚é€šç”¨æ•°ç»„ã€æ˜ å°„å’Œç»“æ„ä½“ï¼›</li>
<li>å…è®¸å®ç° <code>lambda å‡½æ•° &lt;lambda-functions&gt;</code>ï¼›</li>
</ul>
<p>å‘é‡å‡½æ•°æ¥å£å…è®¸è¿›è¡Œè®¸å¤šç®€å•å‡½æ•°æ— æ³•è¿›è¡Œçš„ä¼˜åŒ–ã€‚è¿™äº›ä¼˜åŒ–é€šå¸¸åˆ©ç”¨ä¸åŒçš„å‘é‡ç¼–ç å’Œå‘é‡çš„åˆ—å¼è¡¨ç¤ºã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š</p>
<ul>
<li><code>map_keys</code> å‡½æ•°åˆ©ç”¨ ArrayVector çš„è¡¨ç¤ºå½¢å¼ï¼Œç›´æ¥è¿”å›å†…éƒ¨çš„<code>keys</code>å‘é‡ï¼Œä¸è¿›è¡Œä»»ä½•è®¡ç®—ã€‚åŒæ ·ï¼Œ<code>map_values</code> å‡½æ•°ç›´æ¥è¿”å›å†…éƒ¨çš„<code>values</code>å‘é‡ã€‚</li>
<li><code>map_entries</code> å‡½æ•°è·å–è¾“å…¥å‘é‡çš„å„ä¸ªéƒ¨åˆ†ï¼ŒåŒ…æ‹¬<code>nulls</code>ã€<code>sizes</code>å’Œ<code>offsets</code>ç¼“å†²åŒºä»¥åŠ<code>keys</code>å’Œ<code>values</code>å‘é‡ï¼Œå¹¶å°†å®ƒä»¬é‡æ–°æ‰“ åŒ…ä¸º RowVector çš„å½¢å¼ã€‚</li>
<li><code>cardinality</code> å‡½æ•°åˆ©ç”¨ ArrayVector å’Œ MapVector çš„è¡¨ç¤ºå½¢å¼ï¼Œç›´æ¥è¿”å›è¾“å…¥å‘é‡çš„â€œsizesâ€ç¼“å†²åŒºã€‚</li>
<li><code>is_null</code> å‡½æ•°å¤åˆ¶è¾“å…¥å‘é‡çš„<code>nulls</code>ç¼“å†²åŒºï¼Œæ‰¹é‡ç¿»è½¬ä½å¹¶è¿”å›ç»“æœã€‚</li>
<li><code>element_at</code> å‡½æ•°å’Œæ•°ç»„åŠæ˜ å°„çš„ä¸‹æ ‡è¿ç®—ç¬¦ä½¿ç”¨å­—å…¸ç¼–ç æ¥è¡¨ç¤ºè¾“å…¥<code>å…ƒç´ </code>æˆ–<code>å€¼</code>å‘é‡çš„å­é›†ï¼Œè€Œæ— éœ€å¤åˆ¶ã€‚</li>
</ul>
<p>è¦å®šä¹‰å‘é‡å‡½æ•°ï¼Œè¯·åˆ›å»º <code>exec::VectorFunction</code> çš„å­ç±»å¹¶
å®ç°<code>apply</code>æ–¹æ³•ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> SelectivityVector</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">VectorPtr</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              Expr</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> caller</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              EvalCtx</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              VectorPtr</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="input-rows">è¾“å…¥è¡Œ<a href="#input-rows" class="hash-link" aria-label="Direct link to è¾“å…¥è¡Œ" title="Direct link to è¾“å…¥è¡Œ">â€‹</a></h3>
<p><code>rows</code>å‚æ•°æŒ‡å®šä¼ å…¥æ‰¹æ¬¡ä¸­è¦å¤„ç†çš„è¡Œé›†ã€‚æ­¤é›†åˆå¯èƒ½ä¸åŒ…å«æ‰€æœ‰è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘é‡å‡½æ•°è¢«å‡å®šå…·æœ‰é»˜è®¤çš„ç©º
å€¼è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œä»»ä½•è¾“å…¥ä¸­çš„ç©ºå€¼éƒ½ä¼šäº§ç”Ÿç©ºå€¼ç»“æœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¡¨è¾¾å¼æ±‚å€¼å¼•æ“å°†ä»<code>apply</code>è°ƒç”¨ä¸­æŒ‡å®šçš„<code>è¡Œ</code>
ä¸­æ’é™¤åŒ…å«ç©ºå€¼çš„è¡Œã€‚å¦‚æœå‡½æ•°å¯¹ç©ºå€¼è¾“å…¥æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œåˆ™å¿…é¡»åœ¨æ³¨å†ŒæœŸé—´æŒ‡å®šã€‚
æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…:<code>vector function registry&lt;Registration&gt;</code>ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œâ€œrowsâ€å‚æ•°å°†åŒ…å«åŒ…å«ç©ºå€¼è¾“å…¥çš„è¡Œï¼Œå¹¶ä¸”å‡½æ•°éœ€è¦å¤„ç†è¿™äº›è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°å¯ä»¥å‡å®šå¹¶éæ‰€æœ‰â€œè¡Œâ€çš„æ‰€æœ‰è¾“å…¥éƒ½ä¸ºç©ºã€‚</p>
<p>å½“å°†å‡½æ•°ä½œä¸ºæ¡ä»¶è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ±‚å€¼æ—¶ï¼Œä¾‹å¦‚ ANDã€ORã€IFã€SWITCHï¼Œåˆ™â€œè¡Œâ€é›†è¡¨ç¤ºéœ€è¦æ±‚å€¼çš„è¡Œçš„å­é›†ã€‚è¯·è€ƒè™‘ä¸€äº›ç¤ºä¾‹ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token plain"> AND b </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œï¼Œ<code>a &gt; 5</code> åœ¨æ‰€æœ‰ <code>a</code> éç©ºçš„è¡Œä¸Šè¿›è¡Œæ±‚å€¼ï¼Œè€Œ <code>b &gt; 7</code> åˆ™åœ¨ <code>b</code> éç©ºä¸” <code>a &gt; 5</code> ä¸ºçœŸçš„è¡Œä¸Šè¿›è¡Œæ±‚å€¼ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">IF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">condition</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œï¼Œ<code>a + 5</code> åœ¨ a éç©ºä¸”æ¡ä»¶ä¸ºçœŸçš„è¡Œä¸Šæ±‚å€¼ï¼Œ
è€Œ <code>b - 3</code> åœ¨ b éç©ºä¸”æ¡ä»¶ä¸çœŸçš„è¡Œä¸Šæ±‚å€¼ã€‚</p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œâ€œè¡Œâ€ä¹‹å¤–çš„å€¼å¯èƒ½æœªå®šä¹‰ã€æœªåˆå§‹åŒ–æˆ–åŒ…å«åƒåœ¾æ•°æ®ã€‚å¦‚æœå…ˆå‰çš„è¿‡æ»¤æ“ä½œç”Ÿæˆçš„å­—å…¸ç¼–ç 
å‘é‡çš„ç´¢å¼•æŒ‡å‘é€šè¿‡è¿‡æ»¤çš„è¡Œå­é›†ï¼Œå°±ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚åœ¨æ±‚å€¼ <code>f(g(a))</code>ï¼ˆå…¶ä¸­ <code>a = Dict(a0)</code>ï¼‰æ—¶ï¼Œ
å‡½æ•°<code>g</code>ä¼šåœ¨<code>a0</code>ä¸­çš„è¡Œå­é›†ä¸Šæ±‚å€¼ï¼Œå¹¶å¯èƒ½ç”Ÿæˆä»…å¡«å……è¯¥è¡Œå­é›†çš„ç»“æœã€‚ç„¶åï¼Œå‡½æ•°<code>f</code>ä¼šåœ¨<code>g</code>çš„ç»“æœä¸­å¯¹ç›¸åŒçš„è¡Œå­é›†æ±‚å€¼ã€‚<code>f</code>çš„è¾“å…¥å°†åŒ…å«<code>è¡Œ</code>ä¹‹å¤–æœªå®šä¹‰ã€æœªåˆå§‹åŒ–æˆ–åŒ…å«åƒåœ¾æ•°æ®çš„å€¼ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>SelectivityVector::applyToSelected</code> æ–¹æ³•å¯ç”¨äºå¾ªç¯éå†æŒ‡å®šçš„è¡Œï¼Œå…¶æ–¹å¼ä¸æ ‡å‡† <code>for</code> å¾ªç¯éå¸¸ç›¸ä¼¼ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// row is the 0-based row number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// .... process the row</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="input-vectors">è¾“å…¥å‘é‡<a href="#input-vectors" class="hash-link" aria-label="Direct link to è¾“å…¥å‘é‡" title="Direct link to è¾“å…¥å‘é‡">â€‹</a></h3>
<p><code>args</code> å‚æ•°æ˜¯ä¸€ä¸ª Pollux å‘é‡çš„ <code>std::vector</code>ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°å‚æ•°çš„å€¼ã€‚è¿™äº›å‘é‡ä¸ä¸€å®šæ˜¯å¹³é¢å‘é‡ï¼Œå¯ä»¥æ˜¯å­—å…¸æˆ–å¸¸é‡ç¼–
ç ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªç¡®å®šæ€§å‡½æ•°æ¥å—å•ä¸ªå‚æ•°ï¼Œå¹¶ä¸”é»˜è®¤ä¸ºç©ºï¼Œåˆ™ä¿è¯å…¶å”¯ä¸€è¾“å…¥æ˜¯å¹³é¢å‘é‡æˆ–å¸¸é‡å‘é‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°è¢«å‡å®šä¸ºç¡®å®š
æ€§çš„ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™å¿…é¡»åœ¨æ³¨å†ŒæœŸé—´æŒ‡å®šéç¡®å®šæ€§è¡Œä¸ºã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <code>vector function registry&lt;Registration&gt;</code>ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>decoded-vector</code> å¯ç”¨äºè·å–ä»»ä½•å‘é‡çš„å¹³é¢å‘é‡å¼æ¥å£ã€‚è¾…åŠ©ç±» <code>exec::DecodedArgs</code> å¯ç”¨äºè§£ç å¤šä¸ªå‚æ•°ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">DecodedArgs </span><span class="token function" style="color:#8250DF">decodedArgs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> firstArg </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> decodedArgs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">at</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> secondArg </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> decodedArgs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">at</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="result-vector">ç»“æœå‘é‡<a href="#result-vector" class="hash-link" aria-label="Direct link to ç»“æœå‘é‡" title="Direct link to ç»“æœå‘é‡">â€‹</a></h3>
<p><code>result</code> å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘ VectorPtr çš„åŸå§‹æŒ‡é’ˆï¼Œè€Œ VectorPtr æ˜¯ä¸€ä¸ªæŒ‡å‘ BaseVector çš„
<code>std::shared_ptr</code>ã€‚å®ƒå¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯ä»¥æŒ‡å‘ä¸€ä¸ªå¯é‡ç”¨çš„ä¸´æ—¶å‘é‡ï¼Œæˆ–è€…ä¸€ä¸ªå¿…é¡»ä¿ç•™å†…å®¹çš„éƒ¨åˆ†å¡«å……å‘é‡ã€‚</p>
<p>åœ¨æ‰§è¡Œ IF è¯­å¥çš„<code>else</code>åˆ†æ”¯æ—¶ï¼Œä¼šæŒ‡å®šä¸€ä¸ªéƒ¨åˆ†å¡«å……çš„å‘é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>then</code>åˆ†æ”¯çš„ç»“æœå¿…é¡»ä¿ç•™ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ¨¡å¼ä¹‹ä¸€è½»æ¾å®ç°ã€‚</p>
<p>å°†æ‰€æœ‰è¡Œæˆ–æŒ‡å®šè¡Œçš„ç»“æœè®¡ç®—åˆ°ä¸€ä¸ªæ–°çš„å‘é‡ä¸­ï¼Œ
ç„¶åä½¿ç”¨ <code>EvalCtx::moveOrCopyResult</code> æ–¹æ³•å°†å‘é‡ <code>std::move</code> åˆ°<code>result</code>ä¸­ï¼Œæˆ–å°†å•ä¸ªè¡Œå¤åˆ¶åˆ°éƒ¨åˆ†å¡«å……çš„<code>result</code>ä¸­ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ moveOrCopyResult å®ç° map_keys å‡½æ•°çš„ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> SelectivityVector</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">VectorPtr</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expr</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/* caller */</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">EvalCtx</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VectorPtr</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> mapVector </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">as</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">MapVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> mapKeys </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> mapVector</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">mapKeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> localResult </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">ArrayVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">pool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#8250DF">ARRAY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mapKeys</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">type</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mapVector</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">nulls</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mapVector</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">offsets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mapVector</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">sizes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mapKeys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mapVector</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">getNullCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">moveOrCopyResult</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">localResult</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½¿ç”¨ <code>BaseVector::ensureWritable</code> æ–¹æ³• å°†<code>result</code>åˆå§‹åŒ–ä¸ºä¸€ä¸ªæ‰å¹³çš„ã€å”¯ä¸€å¼•ç”¨çš„å‘é‡ï¼ŒåŒæ—¶ä¿ç•™<code>rows</code>ä¸­æœªæŒ‡å®šçš„è¡Œçš„å€¼ã€‚ç„¶åï¼Œè®¡ç®—å¹¶å¡«å……<code>result</code>ä¸­çš„<code>rows</code>ã€‚
å¦‚æœ<code>result</code>ä¸ºç©ºï¼Œ<code>BaseVector::ensureWritable</code> ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‘é‡ã€‚å¦‚æœ
result ä¸ä¸ºç©ºï¼Œä½†éæ‰å¹³æˆ–éå•å¼•ç”¨ï¼Œ<code>BaseVector::ensureWritable</code> ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‘é‡ï¼Œå¹¶å°†<code>result</code>ä¸­é<code>rows</code>çš„å€¼
å¤åˆ¶åˆ°æ–°åˆ›å»ºçš„å‘é‡ä¸­ã€‚å¦‚æœ<code>result</code>ä¸ä¸ºç©ºä¸”ä¸ºæ‰å¹³ï¼Œ<code>BaseVector::ensureWritable</code> ä¼šæ£€æŸ¥å†…éƒ¨ç¼“å†²åŒºï¼Œå¦‚æœå®ƒä»¬ä¸æ˜¯å•å¼•ç”¨ï¼Œåˆ™å¤åˆ¶è¿™äº›ç¼“
å†²åŒºã€‚<code>BaseVector::ensureWritable</code> è¿˜ä¼šå¯¹å†…éƒ¨å‘é‡ï¼ˆæ•°ç»„çš„å…ƒç´ å‘é‡ã€æ˜ å°„çš„é”®å’Œå€¼ã€ç»“æ„ä½“çš„å­—æ®µï¼‰é€’å½’è°ƒç”¨è‡ªèº«ï¼Œä»¥ç¡®ä¿å‘é‡å§‹ç»ˆå¤„äº<code>å¯å†™</code>çŠ¶æ€ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ <code>BaseVector::ensureWritable</code> å®ç°åœ°å›¾åŸºæ•°å‡½æ•°çš„ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> SelectivityVector</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">VectorPtr</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expr</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/* caller */</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">EvalCtx</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VectorPtr</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token class-name" style="color:#116329">BaseVector</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ensureWritable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">BIGINT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">pool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      BufferPtr resultValues </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           result</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">as</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">FlatVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int64_t</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">mutableValues</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> rawResult </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> resultValues</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">asMutable</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int64_t</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> mapVector </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">as</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">MapVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> rawSizes </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> mapVector</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">rawSizes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vector_size_t row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rawResult</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> rawSizes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="simple-implementation">ç®€å•å®ç°<a href="#simple-implementation" class="hash-link" aria-label="Direct link to ç®€å•å®ç°" title="Direct link to ç®€å•å®ç°">â€‹</a></h2>
<p>å‘é‡å‡½æ•°æ¥å£éå¸¸çµæ´»ï¼Œå…è®¸è¿›è¡Œè®¸å¤šæœ‰è¶£çš„ä¼˜åŒ–ã€‚ä½†å®ƒä¹Ÿå¯èƒ½è®©äººæ„Ÿè§‰éå¸¸å¤æ‚ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨
<code>DecodedVector</code> å’Œ <code>BaseVector::ensureWritable</code> å°†<code>power(a, b)</code>å‡½æ•°å®ç°ä¸ºå‘é‡å‡½æ•°ï¼Œå…¶
å¤æ‚ç¨‹åº¦ä¸ä¼šæ¯”ç®€å•å‡½æ•°å¤æ‚å¤ªå¤šã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæœ€å¥½å°†<code>power</code>å‡½æ•°å®ç°ä¸ºç®€å•å‡½æ•°ã€‚æˆ‘åœ¨è¿™é‡Œä½¿ç”¨å®ƒä»…ç”¨äºè¯´æ˜ç›®çš„ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Initialize flat results vector.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name" style="color:#116329">BaseVector</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ensureWritable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DOUBLE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">pool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> rawResults </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> result</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">as</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">FlatVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int64_t</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">mutableRawValues</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Decode the arguments.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DecodedArgs </span><span class="token function" style="color:#8250DF">decodedArgs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> base </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> decodedArgs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">at</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> exp </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> decodedArgs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">at</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Loop over rows and calculate the results.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rawResults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">pow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">valueAt</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">valueAt</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨å¯èƒ½éœ€è¦é’ˆå¯¹åº•æ•°å’ŒæŒ‡æ•°å‡ä¸ºå¹³å¦çš„æƒ…å†µè¿›è¡Œä¼˜åŒ–ï¼Œå¹¶æ¶ˆé™¤è°ƒç”¨ <code>DecodedVector::valueAt</code> æ¨¡æ¿çš„å¼€é”€ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">isIdentityMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">isIdentityMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> baseValues </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">data</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> expValues </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">data</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rawResults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">pow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">baseValues</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expValues</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rawResults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">pow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">valueAt</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">valueAt</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨å¯èƒ½å†³å®šé’ˆå¯¹å¹³åº•å’Œå¸¸æ•°æŒ‡æ•°çš„æƒ…å†µè¿›è¡Œè¿›ä¸€æ­¥ä¼˜åŒ–ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">isIdentityMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">isIdentityMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> baseValues </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">data</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> expValues </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">data</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rawResults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">pow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">baseValues</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expValues</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">else</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">isIdentityMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">isConstantMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> baseValues </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">data</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> expValue </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">valueAt</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rawResults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">pow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">baseValues</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expValue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rawResults</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">pow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">valueAt</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exp</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token generic-function function" style="color:#8250DF">valueAt</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¸Œæœ›æ‚¨ç°åœ¨å·²ç»æ˜ç™½ï¼Œå®ç°è¿‡ç¨‹ä¸­çš„é¢å¤–å¤æ‚æ€§ä»…ä»…æ¥è‡ªäºå¼•å…¥ä¼˜åŒ–è·¯å¾„ã€‚å¼€å‘äººå‘˜éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µæ¥åˆ¤æ–­
è¿™ç§å¤æ‚æ€§æ˜¯å¦åˆç†ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="try-expression-support">TRY è¡¨è¾¾å¼æ”¯æŒ<a href="#try-expression-support" class="hash-link" aria-label="Direct link to TRY è¡¨è¾¾å¼æ”¯æŒ" title="Direct link to TRY è¡¨è¾¾å¼æ”¯æŒ">â€‹</a></h2>
<p>å†…ç½®çš„ TRY è¡¨è¾¾å¼ä¼šè¯„ä¼°è¾“å…¥è¡¨è¾¾å¼ï¼Œå¹¶é€šè¿‡è¿”å› NULL æ¥å¤„ç†æŸäº›ç±»å‹çš„é”™è¯¯ã€‚å®ƒç”¨äºä»¥ä¸‹æƒ…å†µï¼šå½“é‡åˆ°æŸåæˆ–æ— æ•ˆæ•°æ®æ—¶ï¼ŒæŸ¥è¯¢æœ€å¥½è¿”å› NULL æˆ–é»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯å¤±è´¥ã€‚è¦æŒ‡å®šé»˜è®¤å€¼ï¼Œå¯ä»¥å°† TRY è¡¨è¾¾å¼ä¸ COALESCE å‡½æ•°ç»“åˆä½¿ç”¨ã€‚</p>
<p>TRY è¡¨è¾¾å¼çš„å®ç°ä¾èµ–äº <code>VectorFunction</code> çš„å®ç°ï¼Œä»¥è°ƒç”¨ <code>EvalCtx::setError(row, exception)</code> è€Œä¸æ˜¯ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">setError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vector_size_t index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">exception_ptr</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> exceptionPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸€ç§å…¸å‹çš„æ¨¡å¼æ˜¯å¾ªç¯éå†è¡Œï¼Œåº”ç”¨ä¸€ä¸ªåŒ…è£¹åœ¨ <code>try-catch</code> ä¸­çš„å‡½æ•°ï¼Œå¹¶ä» catch å—ä¸­è°ƒç”¨ <code>context-&gt;setError(row, std::current_exception())</code>; ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelected</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// ... calculate and store the result for the row</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">exception</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">setError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">current_exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æœ‰ä¸€ä¸ªä¾¿æ·æ–¹æ³• <code>EvalCtx::applyToSelectedNoThrow</code> å¯ä»¥ç”¨æ¥ä»£æ›¿ä¸Šé¢æ˜¾å¼çš„ <code>try-catch</code> å—ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">applyToSelectedNoThrow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// ... calculate and store the result for the row</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç®€å•å‡½æ•°é»˜è®¤å…¼å®¹ TRY è¡¨è¾¾å¼ã€‚æ¡†æ¶å°†<code>call</code>å’Œ<code>callNullable</code>æ–¹æ³•å°è£…åœ¨ <code>try-catch</code> ä¸­ï¼Œå¹¶ä½¿ç”¨ <code>context.setError</code> æŠ¥å‘Šé”™è¯¯ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="egistration">æ³¨å†Œ<a href="#egistration" class="hash-link" aria-label="Direct link to æ³¨å†Œ" title="Direct link to æ³¨å†Œ">â€‹</a></h2>
<p>ä½¿ç”¨ <code>exec::registerVectorFunction</code> æ³¨å†Œæ— çŠ¶æ€å‘é‡å‡½æ•°ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">registerVectorFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">FunctionSignaturePtr</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> signatures</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">VectorFunction</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VectorFunctionMetadata metadata </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> overwrite </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>exec::registerVectorFunction</code> æ¥å—ä¸€ä¸ªåç§°ã€ä¸€ä¸ªå—æ”¯æŒçš„ç­¾ååˆ—è¡¨ï¼Œä»¥åŠæŒ‡å‘è¯¥å‡½æ•°å®
ä¾‹çš„ unique_ptrã€‚å®ƒæ¥å—ä¸€ä¸ªå¯é€‰çš„â€œå…ƒæ•°æ®â€å‚æ•°ï¼Œç”¨äºæŒ‡å®šå‡½æ•°æ˜¯å¦å…·æœ‰ç¡®å®šæ€§ã€æ˜¯å¦å…·æœ‰é»˜è®¤çš„ç©ºè¡Œä¸ºä»¥
åŠå…¶ä»–å±æ€§ã€‚è¾…åŠ©ç±» VectorFunctionMetadataBuilder å…è®¸è½»æ¾æ„å»ºâ€œå…ƒæ•°æ®â€ã€‚ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">VectorFunctionMetadataBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">defaultNullBehavior</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¯é€‰çš„<code>overwrite</code>æ ‡å¿—æŒ‡å®šå¦‚æœæŒ‡å®šåç§°çš„å‡½æ•°å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–è¯¥å‡½æ•°ã€‚</p>
<p>ä½¿ç”¨ <code>exec::registerStatefulVectorFunction</code> æ³¨å†Œä¸€ä¸ªæœ‰çŠ¶æ€å‘é‡å‡½æ•°ã€‚</p>
<p>æ³¨æ„ï¼šåœ¨è§£ææœŸé—´ï¼Œå‘é‡å‡½æ•°å°†ä¼˜å…ˆäºç®€å•å‡½æ•°ã€‚
è¿™æ˜¯ å› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¼–å†™ä¼˜åŒ–çš„å‘é‡å‡½æ•°æ˜¯åˆç†çš„ï¼Œå› æ­¤å‘é‡å‡½æ•°çš„ä¼˜å…ˆçº§é«˜äºç­‰æ•ˆçš„ç®€å•å‡½æ•°ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">registerStatefulVectorFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">FunctionSignaturePtr</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> signatures</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VectorFunctionFactory factory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        VectorFunctionMetadata metadata </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> overwrite </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>exec::registerStatefulVectorFunction</code> æ¥å—ä¸€ä¸ªåç§°ã€ä¸€ä¸ªå—æ”¯æŒçš„ç­¾ååˆ—è¡¨ä»¥åŠä¸€ä¸ªå¯ç”¨äºåˆ›å»ºå‘é‡å‡½æ•°å®ä¾‹çš„å·¥
å‚å‡½æ•°ã€‚è¡¨è¾¾å¼æ±‚å€¼å¼•æ“ä½¿ç”¨å·¥å‚å‡½æ•°ä¸ºæ¯ä¸ªæ‰§è¡Œçº¿ç¨‹åˆ›å»ºä¸€ä¸ªæ–°çš„å‘é‡å‡½æ•°å®ä¾‹ã€‚åœ¨å•çº¿ç¨‹æ‰§è¡Œä¸­ï¼Œè¯¥å‡½æ•°çš„å•ä¸ªå®ä¾‹ç”¨äºå¤„ç†
æ‰€æœ‰æ‰¹æ¬¡æ•°æ®ã€‚åœ¨å¤šçº¿ç¨‹æ‰§è¡Œä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å‡½æ•°å®ä¾‹ã€‚å·¥å‚å‡½æ•°çš„è°ƒç”¨å‚æ•°åŒ…æ‹¬å‡½æ•°åç§°ã€ç±»å‹ä»¥åŠå¯é€‰çš„å¸¸
é‡å€¼ã€‚ä¾‹å¦‚ï¼Œæ­£åˆ™è¡¨è¾¾å¼å‡½æ•°é€šå¸¸ä½¿ç”¨å¸¸é‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œè°ƒç”¨ã€‚æœ‰çŠ¶æ€å‘é‡å‡½æ•°å¯ä»¥ç¼–è¯‘ä¸€æ¬¡æ­£åˆ™è¡¨è¾¾å¼ï¼ˆæ¯ä¸ªæ‰§è¡Œçº¿ç¨‹ï¼‰ï¼Œå¹¶
å°†ç¼–è¯‘åçš„è¡¨è¾¾å¼é‡ç”¨äºå¤šä¸ªæ‰¹æ¬¡æ•°æ®ã€‚åŒæ ·ï¼Œä¸å¸¸é‡ IN åˆ—è¡¨ä¸€èµ·ä½¿ç”¨çš„ IN è¡¨è¾¾å¼å¯ä»¥åˆ›å»ºä¸€æ¬¡å€¼çš„å“ˆå¸Œé›†ï¼Œå¹¶å°†å…¶é‡ç”¨äºæ‰€æœ‰æ‰¹æ¬¡æ•°æ®ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Represents arguments for stateful vector functions. Stores element type, and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// the constant value (if supplied).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">VectorFunctionArg</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> TypePtr type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> VectorPtr constantValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> VectorFunctionFactory </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">function</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">shared_ptr</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">VectorFunction</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">VectorFunctionArg</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> inputArgs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="function-signature">å‡½æ•°ç­¾å<a href="#function-signature" class="hash-link" aria-label="Direct link to å‡½æ•°ç­¾å" title="Direct link to å‡½æ•°ç­¾å">â€‹</a></h2>
<p>å»ºè®®ä½¿ç”¨ FunctionSignatureBuilder æ¥åˆ›å»º FunctionSignature å®ä¾‹ã€‚FunctionSignatureBuilder å’Œ FunctionSignature
æ”¯æŒç±»ä¼¼ Java çš„æ³›å‹ã€å¯å˜æ•°é‡çš„å‚æ•°å’Œ lambda è¡¨è¾¾å¼ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ã€‚</p>
<p>length å‡½æ•°æ¥å—ä¸€ä¸ª varchar ç±»å‹çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª bigint ç±»å‹çš„å€¼ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// varchar -&gt; bigint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FunctionSignatureBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">returnType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;bigint&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;varchar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>substr å‡½æ•°æ¥å—ä¸€ä¸ª varchar ç±»å‹å’Œä¸¤ä¸ªæ•´æ•°ä½œä¸ºèµ·å§‹å€¼å’Œé•¿åº¦ã€‚è¦æŒ‡å®šå¤šä¸ªå‚æ•°çš„ç±»å‹ï¼Œè¯·æŒ‰é¡ºåºä¸ºæ¯ä¸ªå‚æ•°è°ƒç”¨ argumentType() æ–¹æ³•ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// varchar, integer, integer -&gt; bigint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FunctionSignatureBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">returnType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;varchar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;varchar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;integer&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;integer&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>concat å‡½æ•°æ¥å—ä»»æ„æ•°é‡çš„ varchar è¾“å…¥å¹¶è¿”å›ä¸€ä¸ª varchar å€¼ã€‚FunctionSignatureBuilder å…è®¸é€šè¿‡è°ƒç”¨<code>variableArity(&quot;varchar&quot;)</code>
æ–¹æ³•æŒ‡å®šæœ€åä¸€ä¸ªå¢å¼ºé¡¹å¯èƒ½å‡ºç°é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// varchar... -&gt; varchar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FunctionSignatureBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">returnType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;varchar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">variableArity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;varchar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>map_keys å‡½æ•°æ¥å—ä»»ä½•æ˜ å°„å¹¶è¿”å›æ˜ å°„é”®çš„æ•°ç»„ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// map(K,V) -&gt; array(K)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FunctionSignatureBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">knownTypeVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;K&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">typeVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;V&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">returnType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;array(K)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;map(K,V)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>transform å‡½æ•°æ¥å—ä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼Œå°† lambda è¡¨è¾¾å¼åº”ç”¨äºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»“æœæ•°ç»„ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// array(T), function(T, U) -&gt; array(U)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FunctionSignatureBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">typeVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;T&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">typeVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;U&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">returnType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;array(U)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;array(T)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;function(T, U)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¤„ç† DECIMAL ç±»å‹çš„å‡½æ•°ç­¾åè¿˜å¯ä»¥æ¥å—å˜é‡å’Œçº¦æŸæ¥è¡¨ç¤ºç²¾åº¦å’Œå°æ•°ä½æ•°ã€‚
è¿™äº›çº¦æŸä½¿ç”¨åŸºäº Flex å’Œ Bison å·¥å…·æ„å»ºçš„ç±»å‹è®¡ç®—å™¨è¿›è¡Œè¯„ä¼°ã€‚åè¿›åˆ¶ç®—æœ¯åŠ æ³•å‡½æ•°çš„ç­¾åå¦‚ä¸‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// decimal, decimal -&gt; decimal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exec</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FunctionSignatureBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">returnType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;DECIMAL(r_precision, r_scale)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;DECIMAL(a_precision, a_scale)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">argumentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;DECIMAL(b_precision, b_scale)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">variableConstraint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#C6105F">&quot;r_precision&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#C6105F">&quot;min(38, max(a_precision - a_scale, b_precision - b_scale) + max(a_scale, b_scale) + 1)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">variableConstraint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;r_scale&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;max(a_scale, b_scale)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>FunctionSignatureBuilder ä¸­ä½¿ç”¨çš„ç±»å‹åç§°å¯ä»¥æ˜¯å°å†™çš„æ ‡å‡†ç±»å‹ã€ç‰¹æ®Šç±»å‹<code>any</code>ï¼Œæˆ–è€…é€šè¿‡è°ƒç”¨ typeVariable() æ–¹æ³•å®šä¹‰çš„ç±»
å‹ã€‚<code>any</code>ç±»å‹å¯ç”¨äºæŒ‡  å®šä¸€ä¸ªç±»ä¼¼ printf çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ï¼Œä¸”å‚æ•°ç±»å‹å¯èƒ½ä¸åŒ¹é…ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="testing">æµ‹è¯•<a href="#testing" class="hash-link" aria-label="Direct link to æµ‹è¯•" title="Direct link to æµ‹è¯•">â€‹</a></h2>
<p>æ·»åŠ ä¸€ä¸ªä½¿ç”¨ <code>tests/functions/prestosql/utils/FunctionBaseTest.h</code> æ–‡ä»¶ä¸­çš„ FunctionBaseTest ä½œä¸ºåŸºç±»çš„æµ‹è¯•ã€‚
å°†æµ‹è¯•å’Œ .cpp æ–‡ä»¶å‘½åä¸º <code>&lt;function-name&gt;Test</code>ï¼Œä¾‹å¦‚ï¼Œ<code>CardinalityTest.cpp</code> ä¸­çš„ <code>CardinalityTest</code> æˆ– <code>IsNullTest.cpp</code> ä¸­çš„ <code>IsNullTest</code>ã€‚</p>
<p>FunctionBaseTest æœ‰è®¸å¤šç”¨äºç”Ÿæˆæµ‹è¯•å‘é‡çš„è¾…åŠ©æ–¹æ³•ã€‚å®ƒè¿˜æä¾›äº†ä¸€ä¸ª <code>evaluate()</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥å— SQL è¡¨è¾¾å¼å’Œè¾“å…¥æ•°æ®ï¼Œ
è®¡ç®—è¡¨è¾¾å¼çš„å€¼å¹¶è¿”å›ç»“æœå‘é‡ã€‚SQL è¡¨è¾¾å¼ä½¿ç”¨ DuckDB è¿›è¡Œè§£æï¼Œç±»å‹è§£æé€»è¾‘åˆ©ç”¨æ³¨å†ŒæœŸé—´æŒ‡å®šçš„å‡½æ•°ç­¾åã€‚<code>assertEqualVectors()</code>
æ–¹æ³•æ¥å—ä¸¤ä¸ªå‘é‡ï¼ˆé¢„æœŸå‘é‡å’Œå®é™…å‘é‡ï¼‰ï¼Œå¹¶æ–­è¨€å®ƒä»¬è¡¨ç¤ºç›¸åŒçš„å€¼ã€‚è¿™ä¸¤ä¸ªå‘é‡çš„ç¼–ç å¯èƒ½ä¸åŒã€‚</p>
<p>ä»¥ä¸‹æ˜¯å‘é‡å‡½æ•°â€œcontainsâ€çš„æµ‹è¯•ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">TEST_F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ArrayContainsTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> integerWithNulls</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> arrayVector </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">makeNullableArrayVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int64_t</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> testContains </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int64_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> search</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> expected</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">evaluate</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">SimpleVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">bool</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&quot;contains(c0, c1)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#8250DF">makeRowVector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                arrayVector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#8250DF">makeConstant</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">search</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arrayVector</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#8250DF">assertEqualVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">makeNullableFlatVector</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">bool</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expected</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">testContains</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">testContains</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">testContains</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">testContains</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">testContains</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç®€å•å‡½æ•°çš„æµ‹è¯•å¯ä»¥å—ç›Šäºä½¿ç”¨<code>evaluateOnce()</code>æ¨¡æ¿ï¼Œè¯¥æ¨¡æ¿æ¥å—SQLè¡¨è¾¾å¼å’Œæ ‡é‡å€¼ä½œä¸ºè¾“å…¥ï¼Œ
å¯¹é•¿åº¦ä¸º1çš„å‘é‡æ±‚å€¼ï¼Œå¹¶è¿”å›æ ‡é‡ç»“æœã€‚ä»¥ä¸‹æ˜¯ç®€å•å‡½æ•°â€œsqrtâ€çš„æµ‹è¯•ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">TEST_F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ArithmeticTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sqrt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> kDoubleMax </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">numeric_limits</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> kNan </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">numeric_limits</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">quiet_NaN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> sqrt </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">evaluateOnce</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">double</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;sqrt(c0)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsNan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_FLOAT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1.34078e+154</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kDoubleMax</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">value_or</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">nullopt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kNan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsNan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="function-names">å‡½æ•°å‘½å<a href="#function-names" class="hash-link" aria-label="Direct link to å‡½æ•°å‘½å" title="Direct link to å‡½æ•°å‘½å">â€‹</a></h2>
<p>ç®€å•å‡½æ•°å’Œå‘é‡å‡½æ•°çš„åç§°å‡ä¸åŒºåˆ†å¤§å°å†™ã€‚å‡½æ•°åç§°åœ¨æ³¨å†Œæ—¶ä»¥åŠæ ¹æ®ç»™å®šè¡¨è¾¾å¼è§£ææ—¶ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºå°å†™ã€‚</p>
<p>ä»¥ä¸‹åç§°ä¸ºç‰¹æ®Šå½¢å¼ä¿ç•™ï¼Œä¸èƒ½ç”¨ä½œå‡½æ•°åï¼š</p>
<ul>
<li>and</li>
<li>or</li>
<li>cast</li>
<li>if</li>
<li>switch</li>
<li>coalesce</li>
<li>try</li>
<li>row_constructor</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="function-resolution-order">å‡½æ•°è§£æé¡ºåº<a href="#function-resolution-order" class="hash-link" aria-label="Direct link to å‡½æ•°è§£æé¡ºåº" title="Direct link to å‡½æ•°è§£æé¡ºåº">â€‹</a></h2>
<p>åœ¨å‡½æ•°è§£æè¿‡ç¨‹ä¸­ï¼Œå‘é‡å‡½æ•°ä¼˜å…ˆäºç®€å•å‡½æ•°ã€‚å¦‚æœå‡½æ•° <code>foo</code> æœ‰å¤šä¸ªå®ç°ï¼Œåˆ™å‡½æ•°è§£æçš„é¡ºåºå¦‚ä¸‹ï¼š</p>
<ol>
<li>Vector Function</li>
<li>Simple Function which are generic free and variadic free</li>
<li>Simple Function has variadic but generic free</li>
<li>Simple Function has generic but no variadic of generic</li>
<li>Simple function has variadic of generic</li>
</ol>
<p>åœ¨å‡½æ•°è§£æè¿‡ç¨‹ä¸­ï¼Œä¼šé€‰å–æ’åæœ€ä½çš„å¯ç”¨å‡½æ•°ã€‚å¦‚æœæœ‰å¤šä¸ªå‡½æ•°çš„æ’åç›¸åŒï¼Œæˆ‘ä»¬ä¼šè®¡ç®—ç­¾åä¸­å…·ä½“ç±»å‹çš„æ•°é‡ï¼Œ
å¹¶è¿”å›å…·ä½“ç±»å‹æ•°é‡æœ€é«˜çš„ç­¾åã€‚ï¼ˆå…·ä½“ç±»å‹æ˜¯æŒ‡é™¤å¯å˜å‚æ•°æˆ–æ³›å‹ä¹‹å¤–çš„ä»»ä½•ç±»å‹ï¼‰ã€‚</p>
<p>ä¾‹å¦‚ï¼šè€ƒè™‘ä»¥ä¸‹ä¸¤ä¸ªç±»å‹å‡ä¸º 4 çš„ç­¾åã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Any</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> Variadic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// concrete types = 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Any</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Any</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">               </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// concrete types = 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“ä¸¤ä¸ªå‡½æ•°å¯¹äºç»™å®šè¾“å…¥éƒ½æœ‰æ•ˆæ—¶ï¼Œå°†é€‰æ‹©ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œå› ä¸ºå®ƒå…·æœ‰æ›´å¤šå…·ä½“ç±»å‹ã€‚å½“å…·ä½“ç±»å‹æ•°é‡ç›¸åŒæ—¶ï¼Œè°ƒç”¨ä¼šäº§ç”Ÿæ­§ä¹‰ï¼Œå¹¶ä¸”è°ƒç”¨å“ªä¸ªå‡½æ•°æ˜¯ä¸ç¡®å®šçš„ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="benchmarking">æ€§èƒ½å‹æµ‹<a href="#benchmarking" class="hash-link" aria-label="Direct link to æ€§èƒ½å‹æµ‹" title="Direct link to æ€§èƒ½å‹æµ‹">â€‹</a></h2>
<p>ä½¿ç”¨ <code>melon::Benchmark</code> æ¡†æ¶å’Œ <code>functionBenchmarkBase</code>ï¼ˆä½äº <code>pollux/functions/lib/benchmarks/function_benchmark_base.h</code>ï¼‰ä½œä¸ºåŸºç±»æ·»åŠ åŸºå‡†æµ‹è¯•ã€‚
åŸºå‡†æµ‹è¯•æ˜¯æ£€æŸ¥ä¼˜åŒ–æ˜¯å¦æœ‰æ•ˆã€è¯„ä¼°å…¶å¸¦æ¥çš„å¥½å¤„ä»¥åŠå†³å®šæ˜¯å¦å€¼å¾—å¢åŠ é¢å¤–å¤æ‚æ€§çš„ç»ä½³æ–¹æ³•ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="documenting">æ–‡æ¡£<a href="#documenting" class="hash-link" aria-label="Direct link to æ–‡æ¡£" title="Direct link to æ–‡æ¡£">â€‹</a></h2>
<p>å¦‚æœæŸä¸ªå‡½æ•°å®ç°äº† Presto è¯­ä¹‰ï¼Œè¯·é€šè¿‡åœ¨ <code>pollux/docs/functions</code> ç›®å½•ä¸‹çš„ <code>*.mdx</code> æ–‡ä»¶ä¸­æ·»åŠ æ¡ç›®æ¥è®°å½•è¯¥å‡½æ•°ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½è®°å½•
äº†ä¸€ç»„ç›¸å…³çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œ<code>math.mdx</code> åŒ…å«æ‰€æœ‰æ•°å­¦å‡½æ•°ï¼Œè€Œ <code>array.mdx</code> æ–‡ä»¶åŒ…å«æ‰€æœ‰æ•°ç»„å‡½æ•°ã€‚åœ¨æ–‡ä»¶ä¸­ï¼Œå‡½æ•°æŒ‰å­—æ¯é¡ºåºæ’åˆ—ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-05-25T03:28:26.000Z" itemprop="dateModified">May 25, 2025</time></b> by <b>Jeff lothar</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/pollux/develop/vectors"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Vectors(å‘é‡)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/pollux/develop/aggregate-functions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">å¦‚ä½•æ·»åŠ èšåˆå‡½æ•°ï¼Ÿ</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#simple-functions" class="table-of-contents__link toc-highlight">ç®€å•çš„åŠŸèƒ½</a></li><li><a href="#null-behavior" class="table-of-contents__link toc-highlight">ç©ºè¡Œä¸º</a></li><li><a href="#null-free-fast-path" class="table-of-contents__link toc-highlight">æ— ç©ºå¿«é€Ÿè·¯å¾„</a></li><li><a href="#determinism" class="table-of-contents__link toc-highlight">å†³å®šè®º</a></li><li><a href="#all-ascii-fast-path" class="table-of-contents__link toc-highlight">å…¨ ASCII å¿«é€Ÿè·¯å¾„</a></li><li><a href="#zero-copy-string-result" class="table-of-contents__link toc-highlight">é›¶æ‹·è´å­—ç¬¦ä¸²ç»“æœ</a></li><li><a href="#access-to-session-properties-and-constant-inputs" class="table-of-contents__link toc-highlight">è®¿é—®ä¼šè¯å±æ€§å’Œå¸¸é‡è¾“å…¥</a></li><li><a href="#registration" class="table-of-contents__link toc-highlight">å‡½æ•°æ³¨å†Œ</a></li><li><a href="#variadic-arguments" class="table-of-contents__link toc-highlight">å¯å˜å‚æ•°</a></li><li><a href="#vector-functions" class="table-of-contents__link toc-highlight">å‘é‡å‡½æ•°</a><ul><li><a href="#input-rows" class="table-of-contents__link toc-highlight">è¾“å…¥è¡Œ</a></li><li><a href="#input-vectors" class="table-of-contents__link toc-highlight">è¾“å…¥å‘é‡</a></li><li><a href="#result-vector" class="table-of-contents__link toc-highlight">ç»“æœå‘é‡</a></li></ul></li><li><a href="#simple-implementation" class="table-of-contents__link toc-highlight">ç®€å•å®ç°</a></li><li><a href="#try-expression-support" class="table-of-contents__link toc-highlight">TRY è¡¨è¾¾å¼æ”¯æŒ</a></li><li><a href="#egistration" class="table-of-contents__link toc-highlight">æ³¨å†Œ</a></li><li><a href="#function-signature" class="table-of-contents__link toc-highlight">å‡½æ•°ç­¾å</a></li><li><a href="#testing" class="table-of-contents__link toc-highlight">æµ‹è¯•</a></li><li><a href="#function-names" class="table-of-contents__link toc-highlight">å‡½æ•°å‘½å</a></li><li><a href="#function-resolution-order" class="table-of-contents__link toc-highlight">å‡½æ•°è§£æé¡ºåº</a></li><li><a href="#benchmarking" class="table-of-contents__link toc-highlight">æ€§èƒ½å‹æµ‹</a></li><li><a href="#documenting" class="table-of-contents__link toc-highlight">æ–‡æ¡£</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">é˜…è¯»</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">æ–‡æ¡£</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation">å®‰è£…</a></li></ul></div><div class="col footer__col"><div class="footer__title">æ”¯æŒä¸èµ„æº</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/feature-requests">Feature Requests</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/community/support">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">åšå®¢</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">æ›´æ–°</a></li><li class="footer__item"><a href="https://gitee.com/kumo-pub" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kumo-ai.tech" target="_blank" rel="noopener noreferrer" class="footer__link-item">ç½‘ç«™<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">ç‰ˆæƒ Â© 2025 åŒ—äº¬ç§‘ç±³æ™ºåˆ›ç§‘æŠ€æœ‰é™å…¬å¸</div></div></div></footer></div>
</body>
</html>