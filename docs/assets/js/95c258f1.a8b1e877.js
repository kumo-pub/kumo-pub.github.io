(self.webpackChunkkumo_website=self.webpackChunkkumo_website||[]).push([[25870],{90949:(e,r,n)=>{e.exports={src:{srcSet:n.p+"assets/ideal-img/trace-arch.d55a147.640.png 640w,"+n.p+"assets/ideal-img/trace-arch.1dfc155.1030.png 1030w",images:[{path:n.p+"assets/ideal-img/trace-arch.d55a147.640.png",width:640,height:500},{path:n.p+"assets/ideal-img/trace-arch.1dfc155.1030.png",width:1030,height:805}],src:n.p+"assets/ideal-img/trace-arch.d55a147.640.png",toString:function(){return n.p+"assets/ideal-img/trace-arch.d55a147.640.png"},placeholder:void 0,width:640,height:500},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAICAYAAADA+m62AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzUlEQVR4nC2OyU7EQBBD8///xhEhOHAYRsySSnd63/NQeri5XJafFwBrLa1VnM9s2jNGp5QyfaU0rTWWAyj+TgwbNwk87hveRnpvXL5++Xz7xmnPEmMkp4jzgafyiPZoE+i1EX3C20DJ9RW01k2MMftE5pq4rj/EEhnH+EcfB2MMeu+IrDjrMMHwcX1n95paKjlnljPt3KsxpYRsgnV2Ps9ba40xhkVEMHZHlFBKRj0NctPkkvHBkXKac2bjKaaZEmrdUQ89tXOWmOLc+AdzejRBU2ujOwAAAABJRU5ErkJggg=="}},73929:(e,r,n)=>{"use strict";n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>l,toc:()=>p});var a=n(74848),s=n(28453),t=n(90949),i=n.n(t);const c={},d="Tracing",l={id:"pollux/develop/debugging/tracing",title:"Tracing",description:"Background",source:"@site/versioned_docs/version-1.1.1/pollux/develop/debugging/tracing.mdx",sourceDirName:"pollux/develop/debugging",slug:"/pollux/develop/debugging/tracing",permalink:"/docs/pollux/develop/debugging/tracing",draft:!1,unlisted:!1,tags:[],version:"1.1.1",lastUpdatedBy:"Jeff lothar",lastUpdatedAt:1748143706e3,frontMatter:{},sidebar:"docs",previous:{title:"printPlanWithStats",permalink:"/docs/pollux/develop/debugging/print-plan-with-stats"},next:{title:"VectorSaver: Encoding-Preserving Serialization",permalink:"/docs/pollux/develop/debugging/vector-saver"}},o={},p=[{value:"Background",id:"background",level:2},{value:"How Tracing Tool Works",id:"how-tracing-tool-works",level:2},{value:"Tracing Framework",id:"tracing-framework",level:2},{value:"Trace Writers",id:"trace-writers",level:3},{value:"Storage Location",id:"storage-location",level:3},{value:"Memory Management",id:"memory-management",level:3},{value:"Query Trace Readers",id:"query-trace-readers",level:3},{value:"Trace Scan",id:"trace-scan",level:3},{value:"Query Trace Replayer",id:"query-trace-replayer",level:3},{value:"Query Trace Tool Usage",id:"query-trace-tool-usage",level:2}];function h(e){const r={a:"a",annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",math:"math",mi:"mi",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"tracing",children:"Tracing"})}),"\n",(0,a.jsx)(r.h2,{id:"background",children:"Background"}),"\n",(0,a.jsx)(r.p,{children:"\u67e5\u8be2\u8ddf\u8e2a\u5de5\u5177\u6709\u52a9\u4e8e\u5206\u6790\u548c\u8c03\u8bd5\u67e5\u8be2\u6027\u80fd\u548c\u6b63\u786e\u6027\u95ee\u9898\u3002\u5b83\u5141\u8bb8\u5728\u9694\u79bb\u73af\u5883\uff08\u4f8b\u5982\u672c\u5730\u673a\u5668\uff09\u4e2d\u91cd\u653e\u90e8\u5206\u67e5\u8be2\u8ba1\u5212\u548c\u6570\u636e\u96c6\uff0c\u4ece\n\u800c\u907f\u514d\u751f\u4ea7\u73af\u5883\u4e2d\u5916\u90e8\u566a\u58f0\uff08\u4f8b\u5982\u5b58\u50a8\u3001\u7f51\u7edc\u7b49\uff09\u7684\u5e72\u6270\u3002\u8fd9\u5bf9\u4e8e\u67e5\u8be2\u6027\u80fd\u5206\u6790\u548c\u95ee\u9898\u8c03\u8bd5\u6765\u8bf4\u66f4\u52a0\u9ad8\u6548\uff0c\u56e0\u4e3a\u5b83\u65e0\u9700\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u91cd\u653e\u6574\u4e2a\u67e5\u8be2\u3002"}),"\n",(0,a.jsx)(r.h2,{id:"how-tracing-tool-works",children:"How Tracing Tool Works"}),"\n",(0,a.jsx)(r.p,{children:"\u8ffd\u8e2a\u8fc7\u7a0b\u5305\u542b\u4e24\u4e2a\u4e0d\u540c\u7684\u9636\u6bb5\uff1a\u8ffd\u8e2a\u9636\u6bb5\u548c\u91cd\u653e\u9636\u6bb5\u3002\u8ffd\u8e2a\u9636\u6bb5\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u6267\u884c\uff0c\u800c\u91cd\u653e\u9636\u6bb5\u5728\u672c\u5730\u5f00\u53d1\u73af\u5883\u4e2d\u8fdb\u884c\u3002"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\u8ffd\u8e2a\u9636\u6bb5"})}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsx)(r.li,{children:"\u5728\u67e5\u8be2\u4efb\u52a1\u542f\u52a8\u671f\u95f4\uff0c\u8bb0\u5f55\u8ffd\u8e2a\u91cd\u653e\u6240\u9700\u7684\u5143\u6570\u636e\uff0c\u5305\u62ec\u67e5\u8be2\u8ba1\u5212\u7247\u6bb5\u3001\u67e5\u8be2\u914d\u7f6e\u548c\u8fde\u63a5\u5668\u5c5e\u6027\u3002"}),"\n",(0,a.jsx)(r.li,{children:"\u5728\u6574\u4e2a\u67e5\u8be2\u5904\u7406\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u88ab\u8ffd\u8e2a\u7684\u7b97\u5b50\u90fd\u4f1a\u8bb0\u5f55\u8f93\u5165\u5411\u91cf\u6216\u5206\u7247\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u6307\u5b9a\u7684\u5b58\u50a8\u4f4d\u7f6e\u3002"}),"\n",(0,a.jsxs)(r.li,{children:["\u5143\u6570\u636e\u548c\u5206\u7247\u4ee5 JSON \u683c\u5f0f\u5e8f\u5217\u5316\uff0c\u7b97\u5b50\u6570\u636e\u8f93\u5165\u4f7f\u7528 ",(0,a.jsx)(r.a,{href:"https://prestodb.io/docs/current/develop/serialized-page.html",children:"Presto \u5e8f\u5217\u5316\u5668 "})," \u8fdb\u884c\u5e8f\u5217\u5316\u3002"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\u91cd\u653e\u9636\u6bb5"})}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsx)(r.li,{children:"\u8bfb\u53d6\u5e76\u53cd\u5e8f\u5217\u5316\u5df2\u8bb0\u5f55\u7684\u67e5\u8be2\u8ba1\u5212\uff0c\u63d0\u53d6\u8ddf\u8e2a\u7684\u8ba1\u5212\u8282\u70b9\uff0c\u5e76\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u6e90\u8282\u70b9\u548c\u63a5\u6536\u5668\u8282\u70b9\u7ec4\u88c5\u8ba1\u5212\u7247\u6bb5\u3002"}),"\n",(0,a.jsx)(r.li,{children:"\u6e90\u8282\u70b9\u4ece\u5b58\u50a8\u4e2d\u5e8f\u5217\u5316\u7684\u64cd\u4f5c\u7b26\u8f93\u5165\u8bfb\u53d6\u8f93\u5165\uff0c\u63a5\u6536\u5668\u64cd\u4f5c\u7b26\u6253\u5370\u6216\u8bb0\u5f55\u6267\u884c\u72b6\u6001\u3002"}),"\n",(0,a.jsx)(r.li,{children:"\u4f7f\u7528\u6b65\u9aa4 1 \u4e2d\u7ec4\u88c5\u597d\u7684\u8ba1\u5212\u7247\u6bb5\u6784\u5efa\u4efb\u52a1\u3002\u5e94\u7528\u5df2\u8bb0\u5f55\u7684\u67e5\u8be2\u914d\u7f6e\u548c\u8fde\u63a5\u5668\u5c5e\u6027\uff0c\u4f7f\u7528\u4e0e\u751f\u4ea7\u73af\u5883\u4e2d\u76f8\u540c\u7684\u8f93\u5165\u548c\u914d\u7f6e\u8bbe\u7f6e\u91cd\u653e\u8be5\u4efb\u52a1\u3002"}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"\u6ce8\u610f"}),"\uff1aPresto \u5e8f\u5217\u5316\u53ef\u80fd\u4f1a\u4e22\u5931\u8f93\u5165\u5411\u91cf\u7f16\u7801\uff0c\u4f8b\u5982\u60f0\u6027\u5411\u91cf\u548c\u5d4c\u5957\u5b57\u5178\u7f16\u7801\uff0c\u8fd9\u4f1a\u5f71\u54cd\u64cd\u4f5c\u7b26\u7684\u6267\u884c\u3002\u56e0\u6b64\uff0c\u5b83\u53ef\u80fd\u5e76\u4e0d\u603b\u662f\u4e0e\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u76f8\u540c\u3002"]}),"\n","\n",(0,a.jsx)("img",{width:"600",align:"center",src:i()}),"\n",(0,a.jsx)(r.h2,{id:"tracing-framework",children:"Tracing Framework"}),"\n",(0,a.jsx)(r.p,{children:"\u8ffd\u8e2a\u6846\u67b6\u7531\u4e09\u4e2a\u7ec4\u4ef6\u7ec4\u6210\uff1a"}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"\u67e5\u8be2\u8ffd\u8e2a\u5199\u5165\u5668"}),"\uff1a\u8bb0\u5f55\u5143\u6570\u636e\u3001\u8f93\u5165\u6570\u636e\u548c\u626b\u63cf\u5206\u7247\u3002"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"\u67e5\u8be2\u8ffd\u8e2a\u8bfb\u53d6\u5668"}),"\uff1a\u52a0\u8f7d\u5143\u6570\u636e\u3001\u8bfb\u53d6\u8f93\u5165\u6570\u636e\u548c\u626b\u63cf\u5206\u7247\u3002"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"\u67e5\u8be2\u8ffd\u8e2a\u91cd\u653e\u5668"}),"\uff1a\u663e\u793a\u67e5\u8be2\u6458\u8981\u6216\u91cd\u653e\u76ee\u6807\u7b97\u5b50\u7684\u6267\u884c\u60c5\u51b5\u3002"]}),"\n"]}),"\n",(0,a.jsx)(r.h3,{id:"trace-writers",children:"Trace Writers"}),"\n",(0,a.jsxs)(r.p,{children:["\u6709\u4e09\u79cd\u7c7b\u578b\u7684\u5199\u5165\u5668\uff1a",(0,a.jsx)(r.code,{children:"TaskTraceMetadataWriter"}),"\u3001",(0,a.jsx)(r.code,{children:"OperatorTraceInputWriter"})," \u548c ",(0,a.jsx)(r.code,{children:"OperatorTraceSplitWriter"}),"\u3002\u5b83\u4eec\u7528\u4e8e\u5728\u751f\u4ea7\u73af\u5883\u6216\u5f71\u5b50\u73af\u5883\u4e2d\u8bb0\u5f55\u771f\u5b9e\u7684\u6267\u884c\u6570\u636e\u3002"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"TaskTraceMetadataWriter"})}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.code,{children:"TaskTraceMetadataWriter"})," \u4f1a\u5728\u4efb\u52a1\u521b\u5efa\u671f\u95f4\u8bb0\u5f55\u67e5\u8be2\u5143\u6570\u636e\uff0c\u5e76\u5c06\u5176\u5e8f\u5217\u5316\uff0c\n\u7136\u540e\u4ee5 JSON \u683c\u5f0f\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\u3002\u5143\u6570\u636e\u6709\u4e24\u79cd\u7c7b\u578b\uff1a"]}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"\u67e5\u8be2\u914d\u7f6e\u548c\u8fde\u63a5\u5668\u5c5e\u6027"}),"\uff1a\u8fd9\u4e9b\u5143\u6570\u636e\u7531\u7528\u6237\u6839\u636e\u67e5\u8be2\u6307\u5b9a\uff0c\u53ef\u4ee5\u5e8f\u5217\u5316\u4e3a JSON \u6620\u5c04\u5bf9\u8c61\uff08\u952e\u503c\u5bf9\uff09\u3002"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.strong,{children:"\u4efb\u52a1\u8ba1\u5212\u7247\u6bb5"}),"\uff08\u53c8\u540d\u8ba1\u5212\u8282\u70b9\u6811\uff09\uff1a\u53ef\u4ee5\u5e8f\u5217\u5316\u4e3a JSON \u5bf9\u8c61\uff0c\u6b64\u529f\u80fd\u5df2\u5728 Pollux \u4e2d\u652f\u6301\u3002"]}),"\n"]}),"\n",(0,a.jsx)(r.p,{children:"\u5143\u6570\u636e\u5728\u5143\u6570\u636e\u6587\u4ef6\u4e2d\u4fdd\u5b58\u4e3a\u5355\u4e2a JSON \u5bf9\u8c61\u5b57\u7b26\u4e32\u3002\u5b83\u770b\u8d77\u6765\u7c7b\u4f3c\u4e8e\u4ee5\u4e0b\u7b80\u5316\u7684\u3001\u6253\u5370\u7cbe\u7f8e\u7684 JSON \u5b57\u7b26\u4e32\uff08\u4e3a\u7b80\u6d01\u8d77\u89c1\uff0c\u5220\u9664\u4e86\u4e00\u4e9b\u5185\u5bb9\uff09\uff1a"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-json",children:'\n    {\n      "planNode":{\n        "nullAware": false,\n        "outputType":{...},\n        "leftKeys":[...],\n        "rightKeys":[...],\n        "joinType":"INNER",\n        "sources":[\n          {\n            "outputType":{...},\n            "tableHandle":{...},\n            "assignments":[...],\n            "id":"0",\n            "name":"TableScanNode"\n          },\n          {\n            "outputType":{...},\n            "tableHandle":{...},\n            "assignments":[...],\n            "id":"1",\n            "name":"TableScanNode"\n          }\n        ],\n        "id":"2",\n        "name":"HashJoinNode"\n      },\n      "connectorProperties":{...},\n      "queryConfig":{"query_trace_node_ids":"2", ...}\n    }\n'})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"OperatorTraceInputWriter"})}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.code,{children:"OperatorTraceInputWriter"})," \u8bb0\u5f55\u6765\u81ea\u76ee\u6807\u7b97\u5b50\u7684\u8f93\u5165\u5411\u91cf\uff0c\u5b83\u4f7f\u7528 Presto \u5e8f\u5217\u5316\u5668\u5bf9\u6bcf\u4e2a\u5411\u91cf\u6279\u6b21\u8fdb\u884c\u5e8f\u5217\u5316\u5e76\u7acb\u5373\u5237\u65b0\uff0c\u4ee5\u786e\u4fdd\u5373\u4f7f\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u5d29\u6e83\u4e5f\u80fd\u91cd\u653e\u3002"]}),"\n",(0,a.jsxs)(r.p,{children:["\u5b83\u5728\u76ee\u6807\u7b97\u5b50\u521d\u59cb\u5316\u671f\u95f4\u521b\u5efa\uff0c\u5e76\u5728\u6267\u884c\u671f\u95f4\u5c06\u6570\u636e\u5199\u5165 ",(0,a.jsx)(r.code,{children:"Operator::addInput"})," \u65b9\u6cd5\u4e2d\u3002\u5b83\u5728\u76ee\u6807\u7b97\u5b50\u5173\u95ed\u65f6\u5b8c\u6210\u3002\u4f46\u662f\uff0c\u5982\u679c\u8bb0\u5f55\u7684\u6570\u636e\u5927\u5c0f\u8d85\u8fc7\u7528\u6237\u6307\u5b9a\u7684\u9650\u5236\uff0c\u5b83\u53ef\u80fd\u4f1a\u63d0\u524d\u5b8c\u6210\u3002"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"OperatorTraceSplitWriter"})}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.code,{children:"OperatorTraceSplitWriter"})," \u6355\u83b7\u6765\u81ea\u76ee\u6807 ",(0,a.jsx)(r.code,{children:"TableScan"})," \u7b97\u5b50\u7684\u8f93\u5165\u5206\u7247\u3002\u5b83\u4f1a\u5e8f\u5217\u5316\u6bcf\u4e2a\u5206\u7247\u5e76\u7acb\u5373\u5237\u65b0\uff0c\u4ee5\u786e\u4fdd\u5373\u4f7f\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u5d29\u6e83\u4e5f\u80fd\u91cd\u653e\u3002"]}),"\n",(0,a.jsx)(r.p,{children:"\u6bcf\u4e2a\u5206\u7247\u7684\u5e8f\u5217\u5316\u65b9\u5f0f\u5982\u4e0b\uff1a"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cpp",children:"\n  | length : uint32_t | split : JSON string | crc32 : uint32_t |\n"})}),"\n",(0,a.jsx)(r.h3,{id:"storage-location",children:"Storage Location"}),"\n",(0,a.jsx)(r.p,{children:"\u5efa\u8bae\u5c06\u8ffd\u8e2a\u6570\u636e\u5b58\u50a8\u5728\u8fdc\u7a0b\u5b58\u50a8\u7cfb\u7edf\u4e2d\uff0c\u4ee5\u786e\u4fdd\u5373\u4f7f\u8ba1\u7b97\u96c6\u7fa4\u91cd\u65b0\u914d\u7f6e\u6216\u9047\u5230\u95ee\u9898\uff0c\u6570\u636e\u4e5f\u80fd\u4fdd\u5b58\u5e76\u53ef\u8bbf\u95ee\u3002\u8fd9\u4e5f\u6709\u52a9\u4e8e\u9632\u6b62\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u56e0\u672c\u5730\u78c1\u76d8\u8017\u5c3d\u800c\u53d1\u751f\u6545\u969c\u3002"}),"\n",(0,a.jsx)(r.p,{children:"\u7528\u6237\u5e94\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u6839\u76ee\u5f55\u3002\u7136\u540e\uff0c\u5199\u5165\u5668\u5c06\u5728\u6b64\u6839\u76ee\u5f55\u4e2d\u521b\u5efa\u5b50\u76ee\u5f55\u6765\u7ec4\u7ec7\u8ffd\u8e2a\u6570\u636e\u3002\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u76ee\u5f55\u7ed3\u6784\u5c06\u4f7f\u6570\u636e\u4e95\u7136\u6709\u5e8f\uff0c\u5e76\u6613\u4e8e\u91cd\u653e\u548c\u5206\u6790\u3002"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\u5143\u6570\u636e\u4f4d\u7f6e"})}),"\n",(0,a.jsxs)(r.p,{children:["\u201cTaskTraceMetadataWriter\u201d\u5728\u4efb\u52a1\u521b\u5efa\u671f\u95f4\u8bbe\u7f6e\uff0c\u56e0\u6b64\u5b83\u4f1a\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a\u201c",(0,a.jsxs)(r.span,{className:"katex",children:[(0,a.jsx)(r.span,{className:"katex-mathml",children:(0,a.jsx)(r.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(r.semantics,{children:[(0,a.jsxs)(r.mrow,{children:[(0,a.jsx)(r.mi,{children:"r"}),(0,a.jsx)(r.mi,{children:"o"}),(0,a.jsx)(r.mi,{children:"o"}),(0,a.jsx)(r.mi,{children:"t"}),(0,a.jsx)(r.mi,{children:"D"}),(0,a.jsx)(r.mi,{children:"i"}),(0,a.jsx)(r.mi,{children:"r"}),(0,a.jsx)(r.mi,{mathvariant:"normal",children:"/"})]}),(0,a.jsx)(r.annotation,{encoding:"application/x-tex",children:"rootDir/"})]})})}),(0,a.jsx)(r.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(r.span,{className:"base",children:[(0,a.jsx)(r.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(r.span,{className:"mord mathnormal",children:"roo"}),(0,a.jsx)(r.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(r.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,a.jsx)(r.span,{className:"mord mathnormal",children:"i"}),(0,a.jsx)(r.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,a.jsx)(r.span,{className:"mord",children:"/"})]})})]}),"queryId/$taskId\u201d\u7684\u8ffd\u8e2a\u76ee\u5f55\u3002"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"\u8f93\u5165\u6570\u636e\u548c\u62c6\u5206\u4f4d\u7f6e"})}),"\n",(0,a.jsx)(r.p,{children:"\u8be5\u4efb\u52a1\u4f1a\u751f\u6210\u9a71\u52a8\u7a0b\u5e8f\u548c\u8fd0\u7b97\u7b26\uff0c\u6bcf\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u548c\u8fd0\u7b97\u7b26\u90fd\u7531\u4e00\u7ec4 ID \u6807\u8bc6\u3002\u6bcf\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u90fd\u4f1a\u5206\u914d\u4e00\u4e2a\u7ba1\u9053 ID \u548c\u4e00\u4e2a\u9a71\u52a8\u7a0b\u5e8f ID\u3002\u7ba1\u9053 ID \u662f\u4ece\u96f6\u5f00\u59cb\u7684\u8fde\u7eed\u6570\u5b57\uff0c\n\u9a71\u52a8\u7a0b\u5e8f ID \u4e5f\u662f\u4ece\u96f6\u5f00\u59cb\u7684\u8fde\u7eed\u6570\u5b57\uff0c\u4f46\u4f5c\u7528\u57df\u9650\u5b9a\u4e8e\u7279\u5b9a\u7ba1\u9053\uff0c\n\u4ee5\u786e\u4fdd\u8be5\u7ba1\u9053\u5185\u7684\u552f\u4e00\u6027\u3002\u6b64\u5916\uff0c\u9a71\u52a8\u7a0b\u5e8f\u4e2d\u7684\u6bcf\u4e2a\u8fd0\u7b97\u7b26\u90fd\u4f1a\u5206\u914d\u4e00\u4e2a\u4ece\u96f6\u5f00\u59cb\u7684\u8fde\u7eed\u8fd0\u7b97\u7b26 ID\uff0c\u5e76\u4e14\u5728\u9a71\u52a8\u7a0b\u5e8f\u5185\u662f\u552f\u4e00\u7684\u3002"}),"\n",(0,a.jsx)(r.p,{children:"\u8282\u70b9 ID \u4f1a\u5408\u5e76\u540c\u4e00\u8ddf\u8e2a\u8ba1\u5212\u8282\u70b9\u7684\u8ddf\u8e2a\u6570\u636e\u3002\u7ba1\u9053 ID \u4f1a\u9694\u79bb\u4ece\u540c\u4e00\u8ba1\u5212\u8282\u70b9\u521b\u5efa\u7684\u4e0d\u540c\u8fd0\u7b97\u7b26\uff08\u4f8b\u5982\uff0cHashProbe \u548c HashBuild \u4e0e HashJoinNode\uff09\u4e4b\u95f4\u7684\n\u8ddf\u8e2a\u6570\u636e\u3002\u9a71\u52a8\u7a0b\u5e8f ID \u4f1a\u9694\u79bb\u540c\u4e00\u7ba1\u9053\u4e2d\u6765\u81ea\u4e0d\u540c\u9a71\u52a8\u7a0b\u5e8f\u7684\u5bf9\u7b49\u8fd0\u7b97\u7b26\u7684\u8ddf\u8e2a\u6570\u636e\u3002"}),"\n",(0,a.jsxs)(r.p,{children:["\u76f8\u5e94\u5730\uff0c\u4e3a\u4e86\u786e\u4fdd\u8ffd\u8e2a\u6570\u636e\u7684\u6709\u5e8f\u4e14\u9694\u79bb\u7684\u5b58\u50a8\uff0c\u5728\u7b97\u5b50\u521d\u59cb\u5316\u65f6\u4f1a\u8bbe\u7f6e ",(0,a.jsx)(r.code,{children:"OperatorTraceInputWriter"})," \u548c ",(0,a.jsx)(r.code,{children:"OpeartorTraceSplitWriter"}),"\uff0c\u5e76\n\u5728 ",(0,a.jsx)(r.code,{children:"$rootDir/$queryId/$taskId/$nodeId/$pipelineId/$driverId"})," \u4e2d\u521b\u5efa\u6570\u636e\u6216\u62c6\u5206\u8ffd\u8e2a\u76ee\u5f55\u3002"]}),"\n",(0,a.jsxs)(r.p,{children:["\u4ee5\u4e0b\u662f\u4e00\u4e2a\u5178\u578b\u7684 ",(0,a.jsx)(r.code,{children:"HashJoinNode"})," \u8ffd\u8e2a\u5143\u6570\u636e\u548c\u6570\u636e\u5b58\u50a8\u76ee\u5f55\u7ed3\u6784\uff1a"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-shell",children:"\n  trace ---------------------------------------------------\x3e rootDir\n  \u2514\u2500\u2500 query-1 -------------------------------------------\x3e query ID\n      \u2514\u2500\u2500 task-1 ----------------------------------------\x3e task ID\n          \u251c\u2500\u2500 2 -----------------------------------------\x3e node ID\n          \u2502   \u251c\u2500\u2500 0 -------------------------\x3e pipeline ID (probe)\n          \u2502   \u2502   \u251c\u2500\u2500 0  -------------------------\x3e driver ID (0)\n          \u2502   \u2502   \u2502   \u251c\u2500\u2500 op_input_trace.data\n          \u2502   \u2502   \u2502   \u2514\u2500\u2500 op_trace_summary.json\n          \u2502   \u2502   \u2514\u2500\u2500 1  -------------------------\x3e driver ID (1)\n          \u2502   \u2502       \u251c\u2500\u2500 op_input_trace.data\n          \u2502   \u2502       \u2514\u2500\u2500 op_trace_summary.json\n          \u2502   \u2514\u2500\u2500 1  -------------------------\x3e pipeline ID (build)\n          \u2502       \u251c\u2500\u2500 0 ---------------------------\x3e driver ID (0)\n          \u2502       \u2502   \u251c\u2500\u2500 op_input_trace.data\n          \u2502       \u2502   \u2514\u2500\u2500 op_trace_summary.json\n          \u2502       \u2514\u2500\u2500 1  -------------------------\x3e driver ID (1)\n          \u2502           \u251c\u2500\u2500 op_input_trace.data\n          \u2502           \u2514\u2500\u2500 op_trace_summary.json\n          \u2514\u2500\u2500 task_trace_meta.json  ----------------\x3e query metadata\n"})}),"\n",(0,a.jsx)(r.h3,{id:"memory-management",children:"Memory Management"}),"\n",(0,a.jsxs)(r.p,{children:["\u6dfb\u52a0\u4e00\u4e2a\u540d\u4e3a tracePool \u7684\u65b0\u53f6\u7cfb\u7edf\u6c60\uff0c\u7528\u4e8e\u8ddf\u8e2a\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff0c\u5e76\u5c06\u5176\u66b4\u9732\u51fa\u6765\uff0c\u7c7b\u4f3c ",(0,a.jsx)(r.code,{children:"memory::MemoryManager::getInstance()->tracePool()"}),"\u3002"]}),"\n",(0,a.jsx)(r.h3,{id:"query-trace-readers",children:"Query Trace Readers"}),"\n",(0,a.jsxs)(r.p,{children:["\u4e09\u79cd\u7c7b\u578b\u7684\u8bfb\u53d6\u5668\u4e0e\u67e5\u8be2\u8ddf\u8e2a\u5199\u5165\u5668\u76f8\u5bf9\u5e94\uff1a",(0,a.jsx)(r.code,{children:"TaskTraceMetadataReader"}),"\u3001",(0,a.jsx)(r.code,{children:"OperatorTraceInputReader"})," \u548c\n",(0,a.jsx)(r.code,{children:"OperatorTraceSplitReader"}),"\u3002\u91cd\u653e\u5668\u901a\u5e38\u5728\u672c\u5730\u73af\u5883\u4e2d\u4f7f\u7528\u5b83\u4eec\uff0c\u8fd9\u5c06\u5728\u67e5\u8be2\u8ddf\u8e2a\u91cd\u653e\u5668\u90e8\u5206\u4e2d\u8be6\u7ec6\u63cf\u8ff0\u3002"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"TaskTraceMetadataReader"})}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.code,{children:"TaskTraceMetadataReader"})," \u53ef\u4ee5\u52a0\u8f7d\u67e5\u8be2\u5143\u6570\u636e JSON \u6587\u4ef6\uff0c\u5e76\u63d0\u53d6\u67e5\u8be2\u914d\u7f6e\u3001\u8fde\u63a5\u5668\u5c5e\u6027\u548c\u8ba1\u5212\u7247\u6bb5\u3002\u91cd\u653e\u5668\u4f7f\u7528\u8fd9\u4e9b\u4fe1\u606f\u6784\u5efa\u91cd\u653e\u4efb\u52a1\u3002"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"OperatorTraceInputReader"})}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.code,{children:"OperatorTraceInputReader"})," \u8bfb\u53d6\u5e76\u53cd\u5e8f\u5217\u5316\u8ddf\u8e2a\u6570\u636e\u6587\u4ef6\u4e2d\u7684\u8f93\u5165\u5411\u91cf\u3002\n\u5b83\u7531 ",(0,a.jsx)(r.code,{children:"QueryTraceScan"})," \u7b97\u5b50\u521b\u5efa\u548c\u4f7f\u7528\uff0c\u8be5\u7b97\u5b50\u5c06\u5728",(0,a.jsx)(r.strong,{children:"\u67e5\u8be2\u8ddf\u8e2a\u626b\u63cf"}),"\u90e8\u5206\u4e2d\u8be6\u7ec6\u4ecb\u7ecd\u3002"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"OperatorTraceSplitReader"})}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.code,{children:"OperatorTraceSplitReader"})," \u8bfb\u53d6\u5e76\u53cd\u5e8f\u5217\u5316\u8ddf\u8e2a\u62c6\u5206\u4fe1\u606f\u6587\u4ef6\u4e2d\u7684\u8f93\u5165\u62c6\u5206\uff0c\n\u5e76\u4e3a\u67e5\u8be2\u91cd\u653e\u751f\u6210\u4e00\u4e2a ",(0,a.jsx)(r.code,{children:"exec::Split"})," \u5217\u8868\u3002"]}),"\n",(0,a.jsx)(r.h3,{id:"trace-scan",children:"Trace Scan"}),"\n",(0,a.jsxs)(r.p,{children:["\u5982",(0,a.jsx)(r.strong,{children:"\u8ffd\u8e2a\u7684\u5de5\u4f5c\u539f\u7406"}),"\u90e8\u5206\u6240\u8ff0\uff0c\u91cd\u653e\u975e\u53f6\u5b50\u7b97\u5b50\u9700\u8981\u4e00\u4e2a\u4e13\u95e8\u7684\u6e90\u7b97\u5b50\u3002\u8be5\u7b97\u5b50\u8d1f\u8d23\u5728\u8ffd\u8e2a\u9636\u6bb5\u8bfb\u53d6\u6570\u636e\u8bb0\u5f55\uff0c\u5e76\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684\u8ba1\u5212\u8282\u70b9\u548c\u7b97\u5b50\u8f6c\u6362\u5668\u4e0e Pollux \u7684\u201cLocalPlanner\u201d\u96c6\u6210\u3002"]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"TraceScanNode"})}),"\n",(0,a.jsx)(r.p,{children:"\u6211\u4eec\u5f15\u5165\u4e86\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u201cTraceScanNode\u201d\u6765\u91cd\u653e\u975e\u53f6\u5b50\u7b97\u5b50\u3002\u8be5\u8282\u70b9\u5145\u5f53\u6e90\u8282\u70b9\uff0c\u5e76\u5728\u91cd\u653e\u671f\u95f4\u4e3a\u6bcf\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a\u4e13\u95e8\u7684\u626b\u63cf\u7b97\u5b50\uff0c\u79f0\n\u4e3a\u201cOperatorTraceScan\u201d\u3002\u201cTraceScanNode\u201d\u5305\u542b\u6307\u5b9a\u8ffd\u8e2a\u8282\u70b9\u7684\u8ffd\u8e2a\u76ee\u5f55\u3001\u4e0e\u5176\u5173\u8054\u7684\u7ba1\u9053 ID \u4ee5\u53ca\u7528\u6237\u5728\u91cd\u653e\u671f\u95f4\u4f20\u9012\u7684\u9a71\u52a8\u7a0b\u5e8f ID \u5217\u8868\uff0c\u4ee5\u4fbf\nOperatorTraceScan \u80fd\u591f\u627e\u5230\u6b63\u786e\u7684\u8ffd\u8e2a\u8f93\u5165\u6570\u636e\u6216\u62c6\u5206\u76ee\u5f55\u3002"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"OperatorTraceScan"})}),"\n",(0,a.jsxs)(r.p,{children:["\u5982",(0,a.jsx)(r.strong,{children:"\u5b58\u50a8\u4f4d\u7f6e"}),"\u90e8\u5206\u6240\u8ff0\uff0c\u4e00\u4e2a\u8ba1\u5212\u8282\u70b9\u53ef\u4ee5\u62c6\u5206\u4e3a\u591a\u4e2a\u7ba1\u9053\uff0c\n\u6bcf\u4e2a\u7ba1\u9053\u53ef\u4ee5\u62c6\u5206\u4e3a\u591a\u4e2a\u7b97\u5b50\u3002\u6bcf\u4e2a\u7b97\u5b50\u5bf9\u5e94\u4e00\u4e2a\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5373\u4e00\u4e2a\u6267\u884c\u7ebf\u7a0b\u3002\u5355\u4e2a\u8ba1\u5212\u8282\u70b9\u53ef\u80fd\u6709\u591a\u4e2a\u8ddf\u8e2a\u6570\u636e\u6587\u4ef6\uff0c\u6bcf\u4e2a\u9a71\u52a8\u7a0b\u5e8f\u4e00\u4e2a\u6587\u4ef6\u3002"]}),"\n",(0,a.jsxs)(r.p,{children:["\u4e3a\u4e86\u8bc6\u522b\u4e0e\u7279\u5b9a ",(0,a.jsx)(r.code,{children:"OperatorTraceScan"})," \u7b97\u5b50\u5173\u8054\u7684\u6b63\u786e\u8f93\u5165\u6570\u636e\u6587\u4ef6\uff0c\u5b83\u5229\u7528 TraceScanNode \u63d0\u4f9b\u7684\u8ddf\u8e2a\u8282\u70b9\u76ee\u5f55\u3001\u6d41\u6c34\u7ebf ID \u548c\u9a71\u52a8\u7a0b\u5e8f ID \u5217\u8868\u3002"]}),"\n",(0,a.jsxs)(r.p,{children:["\u5728\u91cd\u653e\u8fc7\u7a0b\u4e2d\uff0c\u5b83\u4f7f\u7528\u81ea\u8eab\u7684\u9a71\u52a8\u7a0b\u5e8f ID \u4f5c\u4e3a\u7d22\u5f15\uff0c\u4ece ",(0,a.jsx)(r.code,{children:"TraceScanNode"})," \u4e2d\u7684\u9a71\u52a8\u7a0b\u5e8f ID \u5217\u8868\u4e2d\u63d0\u53d6\u91cd\u653e\u9a71\u52a8\u7a0b\u5e8f ID\u3002\u7ed3\u5408 ",(0,a.jsx)(r.code,{children:"TraceScanNode"})," \u4e2d\u7684\u8ddf\u8e2a\n\u8282\u70b9\u76ee\u5f55\u548c\u6d41\u6c34\u7ebf ID\uff0c\u5b83\u627e\u5230\u5176\u5bf9\u5e94\u7684\u8f93\u5165\u6570\u636e\u6587\u4ef6\u3002"]}),"\n",(0,a.jsxs)(r.p,{children:["\u76f8\u5e94\u5730\uff0c",(0,a.jsx)(r.code,{children:"OperatorTraceScan"})," \u7b97\u5b50\u4f7f\u7528 ",(0,a.jsx)(r.code,{children:"$rootDir/$queryId/$taskId/$nodeId/$pipelineId/$dirverId"})," \u4e2d\u7684\u8ddf\u8e2a\u6570\u636e\u6587\u4ef6\n\u6765\u521b\u5efa ",(0,a.jsx)(r.code,{children:"OperatorTraceReader"}),"\u3002",(0,a.jsx)(r.code,{children:"OperatorTraceScan::getOutput"})," \u65b9\u6cd5\u8fd4\u56de\u5176 ",(0,a.jsx)(r.code,{children:"OperatorTraceInputReader"})," \u8bfb\u53d6\u7684\u5411\u91cf\uff0c\u8be5\u5411\n\u91cf\u7684\u8fd4\u56de\u987a\u5e8f\u4e0e\u751f\u4ea7\u6267\u884c\u4e2d\u6700\u521d\u5904\u7406\u7684\u987a\u5e8f\u76f8\u540c\u3002\u8fd9\u786e\u4fdd\u4e86\u91cd\u653e\u4fdd\u6301\u4e0e\u539f\u59cb\u751f\u4ea7\u6267\u884c\u76f8\u540c\u7684\u6570\u636e\u6d41\u3002"]}),"\n",(0,a.jsx)(r.h3,{id:"query-trace-replayer",children:"Query Trace Replayer"}),"\n",(0,a.jsx)(r.p,{children:"\u67e5\u8be2\u8ddf\u8e2a\u91cd\u653e\u5668\u901a\u5e38\u5728\u672c\u5730\u73af\u5883\u4e2d\u4f7f\u7528\uff0c\u5176\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a"}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["\u4f7f\u7528 ",(0,a.jsx)(r.code,{children:"TaskTraceMetadataReader"})," \u52a0\u8f7d\u8ddf\u8e2a\u7684\u67e5\u8be2\u914d\u7f6e\u3001\u8fde\u63a5\u5668\u5c5e\u6027\u548c\u8ba1\u5212\u7247\u6bb5\u3002"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsx)(r.p,{children:"\u4f7f\u7528\u6307\u5b9a\u7684\u8ba1\u5212\u8282\u70b9 ID \u4ece\u8ba1\u5212\u7247\u6bb5\u4e2d\u63d0\u53d6\u76ee\u6807\u8ba1\u5212\u8282\u70b9\u3002"}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["\u4f7f\u7528\u6b65\u9aa4 2 \u4e2d\u7684\u76ee\u6807\u8ba1\u5212\u8282\u70b9\u521b\u5efa\u91cd\u653e\u8ba1\u5212\u8282\u70b9\u3002\u4f7f\u7528 ",(0,a.jsx)(r.code,{children:"exec::test::PlanBuilder"})," \u521b\u5efa\u91cd\u653e\u8ba1\u5212\u3002"]}),"\n"]}),"\n",(0,a.jsxs)(r.li,{children:["\n",(0,a.jsxs)(r.p,{children:["\u5982\u679c\u76ee\u6807\u8ba1\u5212\u8282\u70b9\u662f ",(0,a.jsx)(r.code,{children:"TableScanNode"}),"\uff0c"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"\u5c06\u91cd\u653e\u8ba1\u5212\u8282\u70b9\u4f5c\u4e3a\u6e90\u8282\u70b9\u6dfb\u52a0\u5230\u91cd\u653e\u8ba1\u5212\u4e2d\u3002"}),"\n",(0,a.jsxs)(r.li,{children:["\u4f7f\u7528 ",(0,a.jsx)(r.code,{children:"OperatorInputSplitReader"})," \u83b7\u53d6\u6240\u6709\u8ddf\u8e2a\u7684\u5206\u7247\u3002"]}),"\n",(0,a.jsx)(r.li,{children:"\u5c06\u5206\u7247\u7528\u4f5c\u4efb\u52a1\u91cd\u653e\u7684\u8f93\u5165\u3002"}),"\n"]}),"\n",(0,a.jsxs)(r.ol,{start:"5",children:["\n",(0,a.jsxs)(r.li,{children:["\u5bf9\u4e8e\u975e\u53f6\u5b50\u8fd0\u7b97\u7b26\uff0c\u5c06 ",(0,a.jsx)(r.code,{children:"QueryTraceScanNode"})," \u4f5c\u4e3a\u6e90\u8282\u70b9\u6dfb\u52a0\u5230\u91cd\u653e\u8ba1\u5212\u4e2d\uff0c\n\u7136\u540e\u6dfb\u52a0\u91cd\u653e\u8ba1\u5212\u8282\u70b9\u3002"]}),"\n",(0,a.jsxs)(r.li,{children:["\u4f7f\u7528 ",(0,a.jsx)(r.code,{children:"exec::test::AssertQueryBuilder"})," \u6dfb\u52a0\u63a5\u6536\u5668\u8282\u70b9\uff0c\u5e94\u7528\u67e5\u8be2\u914d\u7f6e\uff08\u7981\u7528\u8ddf\u8e2a\uff09\u548c\u8fde\u63a5\u5668\u5c5e\u6027\uff0c\u5e76\u6267\u884c\u91cd\u653e\u8ba1\u5212\u3002"]}),"\n"]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.code,{children:"OperatorReplayBase"})," \u63d0\u4f9b\u91cd\u653e\u7b97\u5b50\u6240\u9700\u7684\u6838\u5fc3\u529f\u80fd\u3002\n\u5b83\u8d1f\u8d23\u68c0\u7d22\u5143\u6570\u636e\u3001\u521b\u5efa\u91cd\u653e\u8ba1\u5212\u4ee5\u53ca\u6267\u884c\u8ba1\u5212\u3002\n\u5177\u4f53\u7684\u7b97\u5b50\u91cd\u653e\u5668\uff08\u4f8b\u5982 ",(0,a.jsx)(r.code,{children:"HashJoinReplayer"})," \u548c ",(0,a.jsx)(r.code,{children:"AggregationReplayer"}),"\uff09\u6269\u5c55\u4e86\u6b64\u57fa\u7c7b\uff0c\u5e76\u91cd\u5199\u4e86 ",(0,a.jsx)(r.code,{children:"createPlanNode"})," \u65b9\u6cd5\u6765\u521b\u5efa\u7279\u5b9a\u7684\u8ba1\u5212\u8282\u70b9\u3002"]}),"\n",(0,a.jsx)(r.h2,{id:"query-trace-tool-usage",children:"Query Trace Tool Usage"}),"\n",(0,a.jsxs)(r.p,{children:["Enable tracing using configurations in ",(0,a.jsx)(r.a,{href:"https://facebookincubator.github.io/pollux/configs.html#tracing",children:"https://facebookincubator.github.io/pollux/configs.html#tracing"}),".\nAfter the traced query finishes, its metadata and the input data for the target tasks and operators\nare all saved in the directory specified by ",(0,a.jsx)(r.code,{children:"query_trace_dir"}),"."]}),"\n",(0,a.jsx)(r.p,{children:"To get a glance at the traced task, we can execute the following command:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cpp",children:"\n  pollux_query_replayer --root_dir /trace_root --task_id task-4 --summary\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u5b83\u5c06\u663e\u793a\u5982\u4e0b\u5185\u5bb9\uff1a"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cpp",children:"\n  ++++++Query trace summary++++++\n  Number of tasks: 1\n\n  ++++++Query configs++++++\n  \tquery_trace_task_reg_exp: .*\n  \tquery_trace_node_ids: 2\n  \tquery_trace_max_bytes: 107374182400\n  \tquery_trace_dir: /tmp/pollux_test_aJqeFd/basic/traceRoot/\n  \tquery_trace_enabled: 1\n\n  ++++++Connector configs++++++\n\n  ++++++Task query plan++++++\n  -- HashJoin[2][INNER t0=u0] -> t0:BIGINT, t1:VARCHAR, t2:SMALLINT, t3:REAL, u0:BIGINT, u1:INTEGER, u2:SMALLINT, u3:VARCHAR\n    -- TableScan[0][table: hive_table] -> t0:BIGINT, t1:VARCHAR, t2:SMALLINT, t3:REAL\n    -- TableScan[1][table: hive_table] -> u0:BIGINT, u1:INTEGER, u2:SMALLINT, u3:VARCHAR\n\n  ++++++Task Summaries++++++\n\n  ++++++Task task-1++++++\n\n  ++++++Pipeline 2++++++\n  driver 0: opType HashProbe, inputRows 70720, peakMemory 108.00KB\n  driver 1: opType HashProbe, inputRows 70720, peakMemory 108.00KB\n\n  ++++++Pipeline 3++++++\n  driver 0: opType HashBuild, inputRows 48000, peakMemory 4.51MB\n  driver 1: opType HashBuild, inputRows 48000, peakMemory 2.25MB\n"})}),"\n",(0,a.jsx)(r.p,{children:"\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7ec8\u7aef\u4e2d\u7684\u4ee5\u4e0b\u547d\u4ee4\u91cd\u65b0\u6267\u884c\u67e5\u8be2\uff0c\u6216\u8005\u5728 IDE \u4e2d\u4f7f\u7528\u76f8\u540c\u7684\u6807\u5fd7\u8fdb\u884c\u8c03\u8bd5\u3002"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cpp",children:"\n  pollux_query_replayer --root_dir /Users/bytedance/work/native/trace --query_id query-1 --task_id task-1 --node_id 2\n"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-cpp",children:"\n  Stats of replaying operator HashBuild : Output: 0 rows (0B, 0 batches), Cpu time: 48.63us, Wall time: 65.22us, Blocked wall time: 24.08ms, Peak memory: 4.51MB, Memory allocations: 16, Threads: 2, CPU breakdown: B/I/O/F (23.79us/0ns/14.46us/10.38us)\n\n  Stats of replaying operator HashProbe : Output: 13578240 rows (1.17GB, 13280 batches), Cpu time: 3.99s, Wall time: 4.01s, Blocked wall time: 98.58ms, Peak memory: 108.00KB, Memory allocations: 12534, Threads: 2, CPU breakdown: B/I/O/F (8.52ms/1.59s/2.39s/20.29us)\n\n  Memory usage: TaskCursorQuery_0 usage 0B reserved 0B peak 10.00MB\n      task.test_cursor 1 usage 0B reserved 0B peak 10.00MB\n          node.2 usage 0B reserved 0B peak 0B\n              op.2.1.1.OperatorTraceScan usage 0B reserved 0B peak 0B\n              op.2.1.0.OperatorTraceScan usage 0B reserved 0B peak 0B\n          node.N/A usage 0B reserved 0B peak 0B\n              op.N/A.0.1.CallbackSink usage 0B reserved 0B peak 0B\n              op.N/A.0.0.CallbackSink usage 0B reserved 0B peak 0B\n          node.1 usage 0B reserved 0B peak 10.00MB\n              op.1.1.0.HashBuild usage 0B reserved 0B peak 4.51MB\n              op.1.0.1.HashProbe usage 0B reserved 0B peak 108.00KB\n              op.1.1.1.HashBuild usage 0B reserved 0B peak 2.25MB\n              op.1.0.0.HashProbe usage 0B reserved 0B peak 108.00KB\n          node.0 usage 0B reserved 0B peak 0B\n              op.0.0.1.OperatorTraceScan usage 0B reserved 0B peak 0B\n              op.0.0.0.OperatorTraceScan usage 0B reserved 0B peak 0B\n\nHere is a full list of supported command line arguments.\n\n* ``--root_dir``: The root directory where the replayer is reading the traced data, must be set.\n* ``--summary``: Show the summary of the tracing including number of tasks and task ids.\n  It also print the query metadata including query configs, connectors properties, and query plan in JSON format.\n* ``--query_id``: Specify the target query ID, it must be set.\n* ``--task_id``: Specify the target task ID, it must be set.\n* ``--node_id``: Specify the target node ID, it must be set.\n* ``--driver_ids``: Specify the target driver IDs to replay.\n* ``--shuffle_serialization_format``: Specify the shuffle serialization format.\n* ``--table_writer_output_dir``: Specify the output directory of TableWriter.\n* ``--hiveConnectorExecutorHwMultiplier``: Hardware multiplier for hive connector.\n* ``--driver_cpu_executor_hw_multiplier``: Hardware multipler for driver cpu executor.\n* ``--memory_arbitrator_type``: Specify the memory arbitrator type.\n* ``--query_memory_capacity_mb``: Specify the query memory capacity limit in MB. If it is zero, then there is no limit.\n* ``--copy_results``: If true, copy the replaying result.\n"})})]})}function u(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},28453:(e,r,n)=>{"use strict";n.d(r,{R:()=>i,x:()=>c});var a=n(96540);const s={},t=a.createContext(s);function i(e){const r=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(t.Provider,{value:r},e.children)}}}]);