"use strict";(self.webpackChunkkumo_website=self.webpackChunkkumo_website||[]).push([[63662],{62400:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var i=s(74848),t=s(28453);const r={date:"02/21/2024"},a="Concept: \u529f\u80fd",l={id:"kmpkg/concepts/features",title:"Concept: \u529f\u80fd",description:"\u672c\u6587\u8be6\u7ec6\u89e3\u91ca\u4e86\u529f\u80fd\u7684\u6982\u5ff5\u3001\u529f\u80fd\u53ca\u5176\u9884\u671f\u5185\u5bb9\u3002",source:"@site/docs/kmpkg/concepts/features.mdx",sourceDirName:"kmpkg/concepts",slug:"/kmpkg/concepts/features",permalink:"/docs/next/kmpkg/concepts/features",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{date:"02/21/2024"},sidebar:"docs",previous:{title:"Concept: \u9ed8\u8ba4\u529f\u80fd",permalink:"/docs/next/kmpkg/concepts/default-features"},next:{title:"\u6e05\u5355\u6a21\u5f0f",permalink:"/docs/next/kmpkg/concepts/manifest-mode"}},d={},c=[{value:"Features",id:"features",level:2},{value:"Example 1: Multiple file formats",id:"example-1-multiple-file-formats",level:3},{value:"Default features",id:"default-features",level:2},{value:"Example 2: Default features in action",id:"example-2-default-features-in-action",level:3},{value:"Dependency resolution",id:"dependency-resolution",level:2},{value:"Advanced usage",id:"advanced-usage",level:2},{value:"Example 3: Multiple Related Projects in a Single Repository",id:"example-3-multiple-related-projects-in-a-single-repository",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"concept-\u529f\u80fd",children:"Concept: \u529f\u80fd"})}),"\n",(0,i.jsx)(n.p,{children:"\u672c\u6587\u8be6\u7ec6\u89e3\u91ca\u4e86\u529f\u80fd\u7684\u6982\u5ff5\u3001\u529f\u80fd\u53ca\u5176\u9884\u671f\u5185\u5bb9\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,i.jsx)(n.p,{children:"Features represent sets of functionality, behavior, and dependencies that can be selectively added to a package or project upon installation."}),"\n",(0,i.jsx)(n.p,{children:"By design, features should follow these principles:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Additive: enabling a feature should provide new functionality otherwise missing from the package without disabling any other functionality."}),"\n",(0,i.jsx)(n.li,{children:"Non-exclusive: enabling a feature should not prevent other features from being installed."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Features should not be used to define alternative sets of functionalities. For example, a graphics library should not use features to choose between exclusive graphics backends, since it's not possible to install all of them at the same time."}),"\n",(0,i.jsx)(n.p,{children:"Features can have the following effects on a package's dependencies:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add new dependencies, including dependencies on other features from the same package."}),"\n",(0,i.jsx)(n.li,{children:"Enable new features on existing dependencies."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The set of features available are defined by the ",(0,i.jsxs)(n.a,{href:"/docs/next/kmpkg/reference/kmpkg-json#features",children:[(0,i.jsx)(n.code,{children:'"features"'})," field"]}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"example-1-multiple-file-formats",children:"Example 1: Multiple file formats"}),"\n",(0,i.jsx)(n.p,{children:"An image manipulation library, for instance, might support several different image types by depending on different sets of other libraries."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "my-image-lib",\n  "version": "0.1",\n  "features": {\n    "png": { "description": "Support PNG files", "dependencies": ["libpng"]},\n    "jpeg": { "description": "Support JPEG files", "dependencies": ["libjpeg-turbo"]},\n    "tiff": { "description": "Support TIFF files", "dependencies": ["libtiff"]},\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"default-features",children:"Default features"}),"\n",(0,i.jsx)(n.p,{children:"Default features are a set of features to be automatically activated if the top-level project does not explicitly request a build without them. Default features are intended to ensure a minimum level of functionality regardless of how complex and customizable the dependency graph of a project grows."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'[!NOTE]\nDefault features are not intended to model "curation" or "suggestions".'}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For example, consider a library ",(0,i.jsx)(n.code,{children:'"extract-any"'})," that supports over 10 different archive formats, including several that are quite obscure. Because they are all optional, if none are selected the library is not functional: it cannot extract any files."]}),"\n",(0,i.jsxs)(n.p,{children:["Default features ensure that a user who simply adds ",(0,i.jsx)(n.code,{children:'"extract-any"'})," to the list of dependencies in their ",(0,i.jsx)(n.code,{children:"kmpkg.json"})," will get a baseline level of functionality; for example, automatically selecting ",(0,i.jsx)(n.code,{children:".zip"})," and ",(0,i.jsx)(n.code,{children:".tar.gz"})," decompressors."]}),"\n",(0,i.jsx)(n.h3,{id:"example-2-default-features-in-action",children:"Example 2: Default features in action"}),"\n",(0,i.jsxs)(n.p,{children:["When a user adds ",(0,i.jsx)(n.code,{children:'"extract-any"'})," to their ",(0,i.jsx)(n.code,{children:"kmpkg.json"})," without specifying features, the default features (e.g., support for ",(0,i.jsx)(n.code,{children:".zip"})," and ",(0,i.jsx)(n.code,{children:".tar.gz"})," formats) are automatically included, ensuring basic functionality."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'{\n  "name": "my-application",\n  "version": "0.15.2",\n  "dependencies": [\n    "extract-any"\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["If the user wants to explicitly disable the default features, they can do so by adding ",(0,i.jsx)(n.code,{children:'"default-features": false'})," to the dependency:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "my-application",\n  "version": "0.15.2",\n  "dependencies": [\n    {\n      "name": "extract-any",\n      "default-features": false\n    }\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Alternatively, if using kmpkg in ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/consume/classic-mode",children:"classic mode"}),", you can disabled default features via the ",(0,i.jsx)(n.code,{children:"core"})," feature. For example, ",(0,i.jsx)(n.code,{children:"kmpkg install extract-any[core]"})," installs ",(0,i.jsx)(n.code,{children:"extract-any"})," without any default features, as ",(0,i.jsx)(n.code,{children:"[core]"})," explicitly excludes them."]}),"\n",(0,i.jsxs)(n.p,{children:["For more information, check out the ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/concepts/default-features",children:"default features article"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"dependency-resolution",children:"Dependency resolution"}),"\n",(0,i.jsx)(n.p,{children:"When using kmpkg, dependency resolution plays a crucial role, especially when dealing with features that have interdependencies. To illustrate, consider the following scenario involving an image manipulation library:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "my-image-lib",\n  "version": "0.1",\n  "features": {\n    "png": { "description": "Support PNG files", "dependencies": ["libpng"]},\n    "jpeg": { "description": "Support JPEG files", "dependencies": ["libjpeg-turbo"]},\n    "tiff": { "description": "Support TIFF files", "dependencies": ["libtiff"]},\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In scenarios where different libraries depend on various features of a common library, kmpkg ensures that all required features and dependencies are considered. For instance, if ",(0,i.jsx)(n.code,{children:"library-a"})," requires the ",(0,i.jsx)(n.code,{children:"png"})," feature and ",(0,i.jsx)(n.code,{children:"library-b"})," requires the ",(0,i.jsx)(n.code,{children:"jpeg"})," feature from ",(0,i.jsx)(n.code,{children:"my-image-lib"}),", the dependency graph would look like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "library-a",\n  "version": "1",\n  "dependencies": [{"name": "my-image-lib", "features": ["png"]}]\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "library-b",\n  "version": "1",\n  "dependencies": [{"name": "my-image-lib", "features": ["jpeg"]}]\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "project-using-a-and-b",\n  "version": "1",\n  "dependencies": [\n    "library-a",\n    "library-b"\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["When these dependencies are resolved, kmpkg combines all necessary features and dependencies to form a comprehensive installation plan. In this example, a project depending on both ",(0,i.jsx)(n.code,{children:"library-a"})," and ",(0,i.jsx)(n.code,{children:"library-b"})," would result in an installation plan that includes both ",(0,i.jsx)(n.code,{children:"PNG"})," and ",(0,i.jsx)(n.code,{children:"JPEG"})," support from ",(0,i.jsx)(n.code,{children:"my-image-lib"}),", but not ",(0,i.jsx)(n.code,{children:"TIFF"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"libjpeg-turbo[core]\nlibpng[core]\nlibrary-a[core]\nlibrary-b[core]\nmy-image-lib[core,png,jpeg]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This mechanism ensures that the build of ",(0,i.jsx)(n.code,{children:"my-image-lib"})," is optimized for the required features, providing support for ",(0,i.jsx)(n.code,{children:"PNG"})," and ",(0,i.jsx)(n.code,{children:"JPEG"})," while excluding unnecessary ",(0,i.jsx)(n.code,{children:"TIFF"})," support."]}),"\n",(0,i.jsx)(n.h2,{id:"advanced-usage",children:"Advanced usage"}),"\n",(0,i.jsx)(n.h3,{id:"example-3-multiple-related-projects-in-a-single-repository",children:"Example 3: Multiple Related Projects in a Single Repository"}),"\n",(0,i.jsx)(n.p,{children:"When a single repository contains several separate buildable components, such as client and server applications with some shared code, developers of each piece may want to avoid installing expensive dependencies required by other pieces."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "my-game",\n  "dependencies": ["grpc"],\n  "features": {\n    "client": { "description": "Client Game Executable", "dependencies": ["sdl2", "bullet3"]},\n    "server": { "description": "Multiplayer Server Executable", "dependencies": ["proxygen"]},\n    "tests": { "description": "Build tests", "dependencies": ["gtest"] }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Individual developers can then select which features to install:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["On the ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/commands/install",children:"install command line"}),", pass ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/commands/install#feature",children:(0,i.jsx)(n.code,{children:"--x-feature="})})]}),"\n",(0,i.jsxs)(n.li,{children:["When using ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/users/buildsystems/cmake-integration",children:"CMake Integration"}),", set ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/users/buildsystems/cmake-integration#kmpkg_manifest_features",children:(0,i.jsx)(n.code,{children:"KMPKG_MANIFEST_FEATURES"})})," before the ",(0,i.jsx)(n.code,{children:"project()"})," command."]}),"\n",(0,i.jsxs)(n.li,{children:["When using ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/users/buildsystems/msbuild-integration",children:"MSBuild Integration"}),", pass ",(0,i.jsx)(n.code,{children:"--x-feature="})," via ",(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/users/buildsystems/msbuild-integration#kmpkg-additional-install-options",children:(0,i.jsx)(n.code,{children:"KmpkgAdditionalInstallOptions"})})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For more information, see the following:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/commands/depend-info",children:"depend-info"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/reference/kmpkg-json#overrides",children:"overrides"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/users/versioning#baselines",children:"baselines"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/next/kmpkg/users/versioning",children:"versioning"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(96540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);