"use strict";(self.webpackChunkkumo_website=self.webpackChunkkumo_website||[]).push([[69045],{41964:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>l});var s=n(74848),c=n(28453);const r={},i="\u96c6\u6210\u4e0e\u6784\u5efa",d={id:"cpp/base/testing/doct/build-systems",title:"\u96c6\u6210\u4e0e\u6784\u5efa",description:"\u6784\u5efa\u7cfb\u7edf",source:"@site/versioned_docs/version-1.1.1/cpp/base/testing/doct/build-systems.mdx",sourceDirName:"cpp/base/testing/doct",slug:"/cpp/base/testing/doct/build-systems",permalink:"/docs/cpp/base/testing/doct/build-systems",draft:!1,unlisted:!1,tags:[],version:"1.1.1",frontMatter:{},sidebar:"docs",previous:{title:"faq",permalink:"/docs/cpp/base/testing/doct/faq"},next:{title:"\u6846\u67b6\u6027\u80fd",permalink:"/docs/cpp/base/testing/doct/benchmarks"}},o={},l=[{value:"\u6784\u5efa\u7cfb\u7edf",id:"\u6784\u5efa\u7cfb\u7edf",level:2},{value:"CMake",id:"cmake",level:3},{value:"\u5305\u7ba1\u7406\u5668",id:"\u5305\u7ba1\u7406\u5668",level:3}];function a(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"\u96c6\u6210\u4e0e\u6784\u5efa",children:"\u96c6\u6210\u4e0e\u6784\u5efa"})}),"\n",(0,s.jsx)(t.h2,{id:"\u6784\u5efa\u7cfb\u7edf",children:"\u6784\u5efa\u7cfb\u7edf"}),"\n",(0,s.jsxs)(t.p,{children:["\u6700\u65b0\u53d1\u5e03\u7684 doctest \u7248\u672c\u53ef\u4ee5\u4ece\u8fd9\u91cc\u83b7\u53d6\uff1a ",(0,s.jsx)(t.a,{href:"https://gitee.com/kumo-hub/doctest/raw/master/doctest/doctest.h",children:(0,s.jsx)(t.code,{children:"https://gitee.com/kumo-hub/doctest/raw/master/doctest/doctest.h"})})]}),"\n",(0,s.jsxs)(t.p,{children:["\u60a8\u53ef\u4ee5\u5c06\u4e0a\u9762 URL \u4e2d\u7279\u5b9a\u7248\u672c\u7684",(0,s.jsx)(t.code,{children:"master"}),"\u66ff\u6362\u4e3a",(0,s.jsx)(t.code,{children:"dev"}),"\u6216",(0,s.jsx)(t.code,{children:"v1.4.8"}),"\u7b49\u6807\u7b7e\u3002"]}),"\n",(0,s.jsx)(t.h3,{id:"cmake",children:"CMake"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"doctest"})," \u6700\u5bb9\u6613\u5728\u60a8\u81ea\u5df1\u7684\u5b58\u50a8\u5e93\u4e2d\u7528\u4f5c\u5355\u4e2a\u6587\u4ef6\u3002\u7136\u540e\u4e0b\u9762\u7684\u6700\u5c0f\u793a\u4f8b\u5c06\u8d77\u4f5c\u7528\uff1a"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cmake",children:"cmake_minimum_required(VERSION 3.0)\nproject(cmake_test VERSION 0.0.1 LANGUAGES CXX)\n\n# Prepare doctest for other targets to use\nfind_package(doctest REQUIRED)\n\n# Make test executable\nadd_executable(tests main.cpp)\ntarget_compile_features(tests PRIVATE cxx_std_17)\ntarget_link_libraries(tests PRIVATE doctest::doctest)\n"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b CMake \u4ee3\u7801\u7247\u6bb5\u81ea\u52a8\u4ece github \u83b7\u53d6\u6574\u4e2a ",(0,s.jsx)(t.strong,{children:"doctest"})," \u5b58\u50a8\u5e93\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u5916\u90e8\u9879\u76ee\uff1a"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cmake",children:'include(ExternalProject)\nfind_package(Git REQUIRED)\n\nExternalProject_Add(\n    doctest\n    PREFIX ${CMAKE_BINARY_DIR}/doctest\n    GIT_REPOSITORY https://gitee.com/kumo-hub/doctest.git\n    TIMEOUT 10\n    UPDATE_COMMAND ${GIT_EXECUTABLE} pull\n    CONFIGURE_COMMAND ""\n    BUILD_COMMAND ""\n    INSTALL_COMMAND ""\n    LOG_DOWNLOAD ON\n)\n\n# Expose required variable (DOCTEST_INCLUDE_DIR) to parent scope\nExternalProject_Get_Property(doctest source_dir)\nset(DOCTEST_INCLUDE_DIR ${source_dir}/doctest CACHE INTERNAL "Path to include folder for doctest")\n'})}),"\n",(0,s.jsx)(t.p,{children:"\u7a0d\u540e\u60a8\u5c06\u80fd\u591f\u4f7f\u7528 doctest include \u76ee\u5f55\uff0c\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cmake",children:"# add it globally\ninclude_directories(${DOCTEST_INCLUDE_DIR})\n\n# or per target\ntarget_include_directories(my_target PUBLIC ${DOCTEST_INCLUDE_DIR})\n"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\u5982\u679c\u60a8\u62e5\u6709\u6574\u4e2a doctest \u5b58\u50a8\u5e93\uff08\u4f5c\u4e3a\u5b50\u6a21\u5757\u6216\u6587\u4ef6\uff09\uff0c\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(t.code,{children:"add_subdirectory(path/to/doctest)"})," \u5c06\u5176\u5305\u542b\u5728 CMake \u6784\u5efa\u4e2d\uff0c\u7136\u540e\u60a8\u53ef\u4ee5\u50cf\u8fd9\u6837\u4f7f\u7528\u5b83\u8fd9\uff1a"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cmake",children:"add_executable(my_tests src_1.cpp src_2.cpp ...)\ntarget_link_libraries(my_tests doctest)\n"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"doctest \u5b58\u50a8\u5e93\u7684\u201cCMakeLists.txt\u201d\u6587\u4ef6\u5177\u6709\u201cinstall()\u201d\u547d\u4ee4\uff0c\u56e0\u6b64\u60a8\u4e5f\u53ef\u4ee5\u5c06 doctest \u4f5c\u4e3a\u5305\u4f7f\u7528\u3002"}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["\u8981\u4ece\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u53d1\u73b0\u6d4b\u8bd5\u5e76\u5c06\u5176\u6ce8\u518c\u5230ctest\u4e2d\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528",(0,s.jsx)(t.code,{children:"scripts/cmake/doctest.cmake"}),"\u4e2d\n\u7684",(0,s.jsx)(t.a,{href:"https://gitee.com/kumo-hub/doctest/tree/master/scripts/cmake/doctest.cmake",children:(0,s.jsx)(t.code,{children:"doctest_discover_tests(<target>)"})}),"- \u9605\u8bfb\u6587\u4ef6\u4e2d\u6709\u5173\u5982\u4f55\n\u4f7f\u7528\u5b83\u7684\u6ce8\u91ca\u3002\u5b83\u7684\u5de5\u4f5c\u539f\u7406\u5c31\u50cf",(0,s.jsx)(t.a,{href:"https://github.com/catchorg/Catch2/blob/master/docs/cmake-integration.mdx#automatic-test-registration",children:"Catch \u4e2d\u7684\u76f8\u540c\u529f\u80fd"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"\u5305\u7ba1\u7406\u5668",children:"\u5305\u7ba1\u7406\u5668"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"doctest"})," \u53ef\u901a\u8fc7\u4ee5\u4e0b\u5305\u7ba1\u7406\u5668\u83b7\u5f97\uff1a"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"kmpkg"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kmpkg integrate install\nkmpkg install doctest\n"})}),"\n",(0,s.jsxs)(t.p,{children:["kmpkg \u4e2d\u7684 doctest \u7aef\u53e3\u7531 ",(0,s.jsx)(t.code,{children:"Kumo"})," \u56e2\u961f\u6210\u5458\u4fdd\u6301\u6700\u65b0\u3002\u5982\u679c\u7248\u672c\u5df2\u8fc7\u65f6\uff0c\u8bf7\u5728 ",(0,s.jsx)(t.a,{href:"https://gitee.com/kumo-pub/kmpkg",children:"kmpkg \u5b58\u50a8\u5e93"})," \u4e0a\u521b\u5efa\u95ee\u9898\u6216\u62c9\u53d6\u8bf7\u6c42\u3002"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"hunter"}),"\n",(0,s.jsxs)(t.li,{children:["conan","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://conan.io/center/doctest",children:"https://conan.io/center/doctest"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/conan-io/conan-center-index/tree/master/recipes/doctest",children:"https://github.com/conan-io/conan-center-index/tree/master/recipes/doctest"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["Homebrew (",(0,s.jsx)(t.code,{children:"brew install doctest"}),")"]}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{title:"\u91cd\u8981",type:"warning",children:(0,s.jsxs)(t.p,{children:["kmpkg \u5b89\u88c5\u7684\u7248\u672c\u662f ",(0,s.jsx)(t.code,{children:"kumo"})," \u5728",(0,s.jsx)(t.code,{children:"GITEE"}),"\u7684\u955c\u50cf\u7248\u672c\uff0c\u5176\u4ed6\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u7684\u662f\u5b98\u7f51\u7248\u672c\u3002\u4f7f\u7528\u4e0a\u6ca1\u6709\u5dee\u5f02\u3002"]})})]})}function h(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>d});var s=n(96540);const c={},r=s.createContext(c);function i(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);