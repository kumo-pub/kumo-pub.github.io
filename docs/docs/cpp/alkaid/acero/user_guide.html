<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.1.1 docs-doc-page docs-doc-id-cpp/alkaid/acero/user_guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">用户指南 | Kumo AI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kumo-pub.github.io/docs/cpp/alkaid/acero/user_guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.1.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" name="docsearch:version" content="1.1.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" property="og:title" content="用户指南 | Kumo AI"><meta data-rh="true" name="description" content="本页介绍如何使用 Acero。建议您先阅读"><meta data-rh="true" property="og:description" content="本页介绍如何使用 Acero。建议您先阅读"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://kumo-pub.github.io/docs/cpp/alkaid/acero/user_guide"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/cpp/alkaid/acero/user_guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/cpp/alkaid/acero/user_guide" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kumo AI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kumo AI Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Kumo AI JSON Feed">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E5CR2Q1NRE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E5CR2Q1NRE",{})</script>


<link rel="alternate" type="application/rss+xml" href="/changelog/rss.xml" title="Docusaurus changelog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/changelog/atom.xml" title="Docusaurus changelog Atom Feed">
<link rel="alternate" type="application/json" href="/changelog/feed.json" title="Docusaurus changelog JSON Feed">



<link rel="icon" href="/img/docusaurus.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/docusaurus.png">
<link rel="mask-icon" href="/img/docusaurus.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/docusaurus.png">
<meta name="msapplication-TileColor" content="#000">



<link rel="alternate" type="application/rss+xml" href="/tests/blog/rss.xml" title="Docusaurus Tests Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tests/blog/atom.xml" title="Docusaurus Tests Blog Atom Feed">
<link rel="alternate" type="application/json" href="/tests/blog/feed.json" title="Docusaurus Tests Blog JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kumo AI" href="/opensearch.xml">

<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.21fbef88.css">
<script src="/assets/js/runtime~main.4a84cfb3.js" defer="defer"></script>
<script src="/assets/js/main.fbc4aaaa.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme-b4f")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss-b4f")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">🎉️ <b><a target="_blank" href="https://docusaurus.io/blog/releases/1.1">Kumo v1.1</a> is out!</b> 🥳️</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"></div><b class="navbar__title text--truncate">主页</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">文档</a><a class="navbar__item navbar__link" href="/docs/category/kmsearch">API</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/changelog">发布</a><a class="navbar__item navbar__link" href="/showcase">应用案例</a><a class="navbar__item navbar__link" href="/community/support">支持与资源</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/cpp/alkaid/acero/user_guide">1.1.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next">nightly 🚧</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/cpp/alkaid/acero/user_guide">1.1.1</a></li><li><hr class="dropdown-separator"></li><li class="dropdown-archived-versions"><b>Archived versions</b></li><li><a href="https://docusaurus-archive-october-2023.netlify.app/docs/2.3.1" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.0.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://v1.docusaurus.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.x.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/cpp/alkaid/acero/user_guide" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://github.com/facebook/docusaurus/issues/3526" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"><b>主页</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">概述</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/基础准备">基础准备</a><button aria-label="Collapse sidebar category &#x27;基础准备&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_be">后端开发环境</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_fe">前端开发环境</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/持续集成----kmpkg">持续集成 -- kmpkg</a><button aria-label="Expand sidebar category &#x27;持续集成 -- kmpkg&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/c开发">c++开发</a><button aria-label="Expand sidebar category &#x27;c++开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/搜素基础开发">搜素基础开发</a><button aria-label="Collapse sidebar category &#x27;搜素基础开发&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/数据与计算">数据与计算</a><button aria-label="Collapse sidebar category &#x27;数据与计算&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/overview">概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/memory">内存管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/arrays">数组</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/datatypes">数据类型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/tables">表格数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/io">输入/输出和文件系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/ipc">IPC format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/json">JSON format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/csv">CSV format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/format">列存格式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/threading">线程管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/compute">计算与计算函数</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/流式计算">流式计算</a><button aria-label="Collapse sidebar category &#x27;流式计算&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/acero/overview">概览</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cpp/alkaid/acero/user_guide">用户指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/acero/developer_guide">  开发者指南</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/alkaid/conventions">約定</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/搜索应用开发">搜索应用开发</a><button aria-label="Expand sidebar category &#x27;搜索应用开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/向量数据库教程">向量数据库教程</a><button aria-label="Expand sidebar category &#x27;向量数据库教程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/搜索统一执行引擎">搜索统一执行引擎</a><button aria-label="Expand sidebar category &#x27;搜索统一执行引擎&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/搜索-ui">搜索 UI</a><button aria-label="Expand sidebar category &#x27;搜索 UI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/搜素基础开发"><span itemprop="name">搜素基础开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/数据与计算"><span itemprop="name">数据与计算</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/流式计算"><span itemprop="name">流式计算</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">用户指南</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.1.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>用户指南</h1></header>
<p>本页介绍如何使用 Acero。建议您先阅读
概述并熟悉基本概念。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用-acero">使用 Acero<a href="#使用-acero" class="hash-link" aria-label="Direct link to 使用 Acero" title="Direct link to 使用 Acero">​</a></h2>
<p>Acero 的基本工作流程如下：</p>
<ol>
<li>
<p>首先，创建一个描述计划的“Declaration”对象图</p>
</li>
<li>
<p>调用其中一个DeclarationToXyz 方法执行声明。</p>
</li>
<li>
<p>从声明图创建一个新的 ExecPlan。每个
Declaration 将对应计划中的一个 ExecNode。
此外，将添加一个接收器节点，具体取决于使用了哪个
DeclarationToXyz 方法。</p>
</li>
<li>
<p>执行 ExecPlan。通常，这是作为
DeclarationToXyz 调用的一部分发生的，但在DeclarationToReader 中，读取器在计划执行完成之前返回。</p>
</li>
<li>
<p>计划完成后，它将被销毁</p>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建计划">创建计划<a href="#创建计划" class="hash-link" aria-label="Direct link to 创建计划" title="Direct link to 创 建计划">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-substrait">Using Substrait<a href="#using-substrait" class="hash-link" aria-label="Direct link to Using Substrait" title="Direct link to Using Substrait">​</a></h3>
<p>Substrait 是创建计划（<code>Declaration</code> 图）的首选机制。原因如下：</p>
<ul>
<li>Substrait 生产者花费大量时间和精力创建用户友好的 API，以便以简单的方式生成复杂的执行计划。例如，可以使用一系列复杂的 <code>aggregate</code> 节点来
实现 <code>pivot_wider</code> 操作。生产者将为您提供更简单的 API，而不是手动创建所有这些 <code>aggregate</code> 节点。</li>
<li>如果您正在使用 Substrait，那么如果您在某个时候发现它比 Acero 更能满足您的需求，您可以轻松切换到任何其他使用 Substrait 的引擎。</li>
<li>我们希望最终会出现基于 Substrait 的优化器和规划器的工具。通过使用 Substrait，您将来可以更轻松地使用这些工具。</li>
</ul>
<p>您可以自己创建 Substrait 计划，但找到现有的 Substrait 生产者可能会更容易。例如，
您可以使用
<a href="https://github.com/ibis-project/ibis-substrait" target="_blank" rel="noopener noreferrer">ibis-substrait</a>
轻松地从 Python 表达式创建 Substrait 计划。有几种
不同的工具能够从 SQL 创建 Substrait 计划。
最终，我们希望基于 C++ 的 Substrait 生成器能够出现。
但是，我们目前还不知道有任何这样的生成器。
有关从 Substrait 创建执行计划的详细说明，
可以在<code>Substrait 页面&lt;acero-substrait&gt;</code>中找到</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="程序化计划制定">程序化计划制定<a href="#程序化计划制定" class="hash-link" aria-label="Direct link to 程序化计划制定" title="Direct link to 程序化计划制定">​</a></h3>
<p>通过编程方式创建执行计划比从 Substrait 创建计划更简单  ，但会失去一些灵活性和面向未来的保证。创建声明的
最简单方法是简单地实例化一个。您将需要声明的名称、输入向量和选项对象。例如：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a project node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Scan-Project-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a Scan operation can be used to load the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// into the execution plan, how a project operation can be applied on the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data stream and how the output is collected into a table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanProjectSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expression a_times_2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;multiply&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration project</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;project&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ProjectNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">a_times_2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">project</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上述代码创建了一个扫描声明（没有输入）和一个项目声明（使用扫描作为输入）。这很简单，但我们可以让它稍微简单一
些。如果您要创建一个线性声明序列（如上例所示），那么您也可以使用<code>Declaration::Sequence</code>函数。</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Inputs do not have to be passed to the project node when using Sequence</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration plan </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Declaration</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Sequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;project&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ProjectNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">a_times_2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>本文档后面还会提供更多有关程序化计划创建的示例。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="执行计划">执行计划<a href="#执行计划" class="hash-link" aria-label="Direct link to 执行计划" title="Direct link to 执行计划">​</a></h3>
<p>有多种不同的方法可用于执行
声明。每种方法提供的数据形式略有不同。
由于所有这些方法都以<code>DeclarationTo...</code>开头，因此本指南
通常将这些方法称为<code>DeclarationToXyz</code>方法。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="declarationtotable">DeclarationToTable<a href="#declarationtotable" class="hash-link" aria-label="Direct link to DeclarationToTable" title="Direct link to DeclarationToTable">​</a></h3>
<p><code>DeclarationToTable</code> 方法会将所有结果累积到单个 <code>alkaid::Table</code> 中。这也许是从 Acero
收集结果的最简单方法。这种方法的主要缺点是它需要将所有结果累积到内存中。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Acero 以小块的形式处理大型数据集。开发人员指南中对此进行了更详细的描述。因此，您可能会惊讶地发现使用 StatementToTable 收集的表的分块方式与您的输入
不同。例如，您的输入可能是一个大型表，其中单个块包含 200 万行。然后，您的输出表可能有 64 个块，每个块有 32Ki 行。</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="declarationtoreader">DeclarationToReader<a href="#declarationtoreader" class="hash-link" aria-label="Direct link to DeclarationToReader" title="Direct link to DeclarationToReader">​</a></h3>
<p><code>DeclarationToReader</code> 方法允许您迭代地使用
结果。它将创建一个 <code>alkaid::RecordBatchReader</code>，您可以在闲暇时从中读取。如果您没有足够快地从读取器读取，则将施加背压，执行计划将暂停。
关闭读取器将取消正在运行的执行计划，读取器的析构函数将等待执行计划完成它正在执行的任何操作，因此它可能会阻塞。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="declarationtostatus">DeclarationToStatus<a href="#declarationtostatus" class="hash-link" aria-label="Direct link to DeclarationToStatus" title="Direct link to DeclarationToStatus">​</a></h3>
<p>如果您想要运行该计划但实际上并不想使用结果，则 <code>DeclarationToStatus</code> 方法很有用。例如，在进行基准测试或计划具
有副作用（例如数据集写入节点）时，这很有用。如果计划生成任何结果，则这些结果将被立即丢弃。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="running-a-plan-directly">Running a Plan Directly<a href="#running-a-plan-directly" class="hash-link" aria-label="Direct link to Running a Plan Directly" title="Direct link to Running a Plan Directly">​</a></h3>
<p>如果出于某种原因，<code>DeclarationToXyz</code> 方法之一不够用，那么可以直接运行计划。只有在执行某些独特
操作时才需要这样做。例如，如果您创建了自定义接收器节点，或者您需要具有多个输出的计划。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>在学术文献和许多现有系统中，普遍假设执行计划最多只有一个输出。Acero 中的某
些方法（例如 StatementToXyz 方法）会期望这一点。但是，设计中没有任何内容严格阻止有多个接收器节点。</p></div></div>
<p>有关如何执行此操作的详细说明超出了本指南的范围
但大致步骤如下：</p>
<ol>
<li>
<p>创建一个新的 <code>ExecPlan</code> 对象。</p>
</li>
<li>
<p>将接收器节点添加到 <code>Declaration</code> 对象图（这是
 创建接收器节点声明所需的唯一类型）</p>
</li>
<li>
<p>使用 <code>Declaration::AddToPlan</code> 将声明添加到计划
（如果您有多个输出，则您将无法使用
此方法，并且需要一次添加一个节点）</p>
</li>
<li>
<p>使用 <code>ExecPlan::Validate</code> 验证计划</p>
</li>
<li>
<p>使用 <code>ExecPlan::StartProducing</code> 启动计划</p>
</li>
<li>
<p>等待 <code>ExecPlan::finished</code> 返回的未来完成。</p>
</li>
</ol>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="提供输入">提供输入<a href="#提供输入" class="hash-link" aria-label="Direct link to 提供输入" title="Direct link to 提供输入">​</a></h2>
<p>执行计划的输入数据可以来自各种来源。它通常是从存储在某种文件系统上的文件中读取的。输入通常来自内存数据。例
如，在类似 pandas 的前端中，内存数据很常见。输入也可以来自网络流，如航班请求。Acero 可以支持所有这些情况，甚
至可以支持此处未提及的独特和自定义情况。</p>
<p>有预定义的源节点涵盖最常见的输入场景。这些列在下面。但是，如果您的源数据是唯一的，那么您将需要使用通用的<code>源</code>节点。
此节点希望您提供异步批处理流，并在<code>此处 &lt;stream_execution_source_docs&gt;</code>中有更详细的介绍。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="可用的-execnode-实现">可用的 <code>ExecNode</code> 实现<a href="#可用的-execnode-实现" class="hash-link" aria-label="Direct link to 可用的-execnode-实现" title="Direct link to 可用的-execnode-实现">​</a></h2>
<hr>
<p>下表快速总结了可用的运算符。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="源节点----sources-nodes">源节点 -- Sources Nodes<a href="#源节点----sources-nodes" class="hash-link" aria-label="Direct link to 源节点 -- Sources Nodes" title="Direct link to 源节点 -- Sources Nodes">​</a></h3>
<p>  这些节点可以作为数据源</p>
<table><thead><tr><th style="text-align:left">Factory Name</th><th style="text-align:left">Options</th><th style="text-align:left">Brief Description</th></tr></thead><tbody><tr><td style="text-align:left"><code>source</code></td><td style="text-align:left"><code>SourceNodeOptions</code></td><td style="text-align:left">A generic source node that wraps an asynchronous stream of data (<code>example &lt;stream_execution_source_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>table_source</code></td><td style="text-align:left"><code>TableSourceNodeOptions</code></td><td style="text-align:left">Generates data from an<code>alkaid::Table</code> (<code>example &lt;stream_execution_table_source_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>record_batch_source</code></td><td style="text-align:left"><code>RecordBatchSourceNodeOptions</code></td><td style="text-align:left">Generates data from an iterator of <code>alkaid::RecordBatch</code></td></tr><tr><td style="text-align:left"><code>record_batch_reader_source</code></td><td style="text-align:left"><code>RecordBatchReaderSourceNodeOptions</code></td><td style="text-align:left">Generates data from an<code>alkaid::RecordBatchReader</code></td></tr><tr><td style="text-align:left"><code>exec_batch_source</code></td><td style="text-align:left"><code>ExecBatchSourceNodeOptions</code></td><td style="text-align:left">Generates data from an iterator of <code>alkaid::compute::ExecBatch</code></td></tr><tr><td style="text-align:left"><code>array_vector_source</code></td><td style="text-align:left"><code>ArrayVectorSourceNodeOptions</code></td><td style="text-align:left">Generates data from an iterator of vectors of <code>alkaid::Array</code></td></tr><tr><td style="text-align:left"><code>scan</code></td><td style="text-align:left"><code>alkaid::dataset::ScanNodeOptions</code></td><td style="text-align:left">Generates data from an <code>alkaid::dataset::Dataset</code> (requires the datasets module)(<code>example &lt;stream_execution_scan_docs&gt;</code>)</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="计算节点----compute-nodes">计算节点 -- Compute Nodes<a href="#计算节点----compute-nodes" class="hash-link" aria-label="Direct link to 计算节点 -- Compute Nodes" title="Direct link to 计算节点 -- Compute Nodes">​</a></h3>
<p>这些节点对数据进行计算，并可能转换或重塑数据</p>
<table><thead><tr><th style="text-align:left">Factory Name</th><th style="text-align:left">Options</th><th style="text-align:left">Brief Description</th></tr></thead><tbody><tr><td style="text-align:left"><code>filter</code></td><td style="text-align:left"><code>FilterNodeOptions</code></td><td style="text-align:left">Removes rows that do not match a given filter expression(<code>example &lt;stream_execution_filter_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>project</code></td><td style="text-align:left"><code>ProjectNodeOptions</code></td><td style="text-align:left">Creates new columns by evaluating compute expressions.  Can also drop and reorder columns(<code>example &lt;stream_execution_project_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>aggregate</code></td><td style="text-align:left"><code>AggregateNodeOptions</code></td><td style="text-align:left">Calculates summary statistics across the entire input stream or on groups of data(<code>example &lt;stream_execution_aggregate_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>pivot_longer</code></td><td style="text-align:left"><code>PivotLongerNodeOptions</code></td><td style="text-align:left">Reshapes data by converting some columns into additional rows</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="排列节点----arrangement-nodes">排列节点 -- Arrangement Nodes<a href="#排列节点----arrangement-nodes" class="hash-link" aria-label="Direct link to 排列节点 -- Arrangement Nodes" title="Direct link to 排列节点 -- Arrangement Nodes">​</a></h3>
<p>这些节点对数据流进行重新排序、组合或切片</p>
<table><thead><tr><th style="text-align:left">Factory Name</th><th style="text-align:left">Options</th><th style="text-align:left">Brief Description</th></tr></thead><tbody><tr><td style="text-align:left"><code>hash_join</code></td><td style="text-align:left"><code>HashJoinNodeOptions</code></td><td style="text-align:left">Joins two inputs based on common columns (:ref:<code>example &lt;stream_execution_hashjoin_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>asofjoin</code></td><td style="text-align:left"><code>AsofJoinNodeOptions</code></td><td style="text-align:left">Joins multiple inputs to the first input based on a common ordered column (often time)</td></tr><tr><td style="text-align:left"><code>union</code></td><td style="text-align:left">N/A</td><td style="text-align:left">Merges two inputs with identical schemas (:ref:<code>example &lt;stream_execution_union_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>order_by</code></td><td style="text-align:left"><code>OrderByNodeOptions</code></td><td style="text-align:left">Reorders a stream</td></tr><tr><td style="text-align:left"><code>fetch</code></td><td style="text-align:left"><code>FetchNodeOptions</code></td><td style="text-align:left">Slices a range of rows from a stream</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="汇聚节点----sink-nodes">汇聚节点 -- Sink Nodes<a href="#汇聚节点----sink-nodes" class="hash-link" aria-label="Direct link to 汇聚节点 -- Sink Nodes" title="Direct link to 汇聚节点 -- Sink Nodes">​</a></h3>
<p>这些节点终止计划。用户通常不会创建接收节点，因为它们是根据用于消费计划的DeclarationToXyz方法选择的。但
是，对于那些开发新接收节点或以高级方式使用Acero的人来说，此列表可能很有用。</p>
<table><thead><tr><th style="text-align:left">Factory Name</th><th style="text-align:left">Options</th><th style="text-align:left">Brief Description</th></tr></thead><tbody><tr><td style="text-align:left"><code>sink</code></td><td style="text-align:left"><code>SinkNodeOptions</code></td><td style="text-align:left">Collects batches into a FIFO queue with optional backpressure</td></tr><tr><td style="text-align:left"><code>write</code></td><td style="text-align:left"><code>alkaid::dataset::WriteNodeOptions</code></td><td style="text-align:left">Writes batches to a filesystem (:ref:<code>example &lt;stream_execution_write_docs&gt;</code>)</td></tr><tr><td style="text-align:left"><code>consuming_sink</code></td><td style="text-align:left"><code>ConsumingSinkNodeOptions</code></td><td style="text-align:left">Consumes batches using a user provided callback function</td></tr><tr><td style="text-align:left"><code>table_sink</code></td><td style="text-align:left"><code>TableSinkNodeOptions</code></td><td style="text-align:left">Collects batches into an :class:<code>alkaid::Table</code></td></tr><tr><td style="text-align:left"><code>order_by_sink</code></td><td style="text-align:left"><code>OrderBySinkNodeOptions</code></td><td style="text-align:left">Deprecated</td></tr><tr><td style="text-align:left"><code>select_k_sink</code></td><td style="text-align:left"><code>SelectKSinkNodeOptions</code></td><td style="text-align:left">Deprecated</td></tr></tbody></table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="示例">示例<a href="#示例" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h2>
<p>本文档的其余部分包含示例执行计划。每个示例
都重点介绍了特定执行节点的行为。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="源-source"><code>源</code> <code>source</code><a href="#源-source" class="hash-link" aria-label="Direct link to 源-source" title="Direct link to 源-source">​</a></h3>
<p><code>source</code> 操作可视为创建流式执行计划的入口点。<code>SourceNodeOptions</code> 用于创建 <code>source</code> 操作。<code>source</code> 操作是目前
最通用、最灵活的源类型，但配置起来可能相当棘手。首先，您应该查看其他源节点类型，以确保没有更简单的选择。</p>
<p>源节点需要某种可以调用来轮询更多数据的函数。此函数不应带任何参数，并且应返回 <code>alkaid::Future&lt;std::optional&lt;alkaid::ExecBatch&gt;&gt;</code>。此
函数可能正在读取文件、遍历内存结构或从网络连接接收数据。alkaid 库将这些函数称为 <code>alkaid::AsyncGenerator</code>，并且有许多实用程序可用于使用这些
函数。对于此示例，我们使用已存储在内存中的记录批次向量。此外，必须预先知道数据的模式。Acero 必须在开始任何处理之前知道执行图每个阶段的数据模式。
这意味着我们必须为源节点提供与数据本身分开的模式。在这里，我们定义一个结构来保存数据生成器定义。这包括内存批次、模式和用作数据生成器的函数：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">BatchesWithSchema</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> batches</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Schema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This method uses internal alkaid utilities to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// convert a vector of record batches to an AsyncGenerator of optional batches</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> opt_batches </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">internal</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MapVector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch batch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">make_optional</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        batches</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gen </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeVectorGenerator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">opt_batches</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>生成用于计算的样本批次：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">BatchesWithSchema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BatchesWithSchema out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> field_vector </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">boolean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1_bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">BooleanType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2_bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">BooleanType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3_bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">BooleanType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b1_bool</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b2_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b2_bool</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b3_bool</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batches </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <code>source</code> 的示例（sink 的用法在
<code>sink&lt;stream_execution_sink_docs&gt;</code> 中有详细说明）：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example demonstrating a source and sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Table Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a custom source can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes source node using pregenerated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data and collecting it into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This sort of custom source is often not needed.  In most cases you can</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// use a scan (for a dataset source) or a source like table_source, array_vector_source,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// exec_batch_source, or record_batch_source (for in-memory data)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="table_source"><code>table_source</code><a href="#table_source" class="hash-link" aria-label="Direct link to table_source" title="Direct link to table_source">​</a></h3>
<p>在上一个示例源节点 <code>&lt;stream_execution_source_docs&gt;</code>中，源节点用于输入数据。但是在开发应用程序时，如果
数据已经作为表存储在内存中，则使用<code>TableSourceNodeOptions</code>会更加容易，性能也更高。在这里，
输入数据可以作为<code>std::shared_ptr&lt;alkaid::Table&gt;</code>以及<code>max_batch_size</code>传递。<code>max_batch_size</code>用于拆分大型记录批次，以便
可以并行处理它们。需要注意的是，当源表的批次较小时，表批次不会合并形成更大的批次。</p>
<p>使用<code>table_source</code>的示例</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a table source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// TableSource-Table Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a table_source can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes a table source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// receiving data from a table.  This plan simply collects the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data back into a table but nodes could be added that modify</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// or transform the data as well (as is shown in later examples)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">TableSourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> max_batch_size </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table_source_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TableSourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max_batch_size</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;table_source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_source_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="filter"><code>filter</code><a href="#filter" class="hash-link" aria-label="Direct link to filter" title="Direct link to filter">​</a></h3>
<p><code>filter</code> 操作，顾名思义，提供了一个定义数据过滤条件的选项。它选择给定表达式计算结果为 true 的
行。可以使用 <code>alkaid::compute::Expression</code> 编写过滤器，并且表达式的返回类型应为布尔值。例如，
如果我们希望保留列 <code>b</code> 的值大于 3 的行，那么我们可以使用以下表达式。</p>
<p>过滤器示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a filter node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Filter-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a filter can be used in an execution plan,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// to filter data from a source. The output from the execution plan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is collected into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanFilterSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// specify the filter.  This filter removes all rows where the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// value of the &quot;a&quot; column is greater than 3.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expression filter_expr </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">greater</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// set filter for scanner : on-disk / push-down filtering.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This step can be skipped if you are not reading from disk.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">filter </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> filter_expr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// empty projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// construct the scan node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Initialized Scanning Options&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Scan node options created&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// pipe the scan node into the filter node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Need to set the filter in scan node options and filter node options.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// At scan node it is used for on-disk / push-down filtering.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// At filter node it is used for in-memory filtering.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration filter</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;filter&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FilterNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter_expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="project"><code>project</code><a href="#project" class="hash-link" aria-label="Direct link to project" title="Direct link to project">​</a></h3>
<p><code>project</code> 操作会重新排列、删除、转换和创建
列。每个输出列都是通过针对源记录批次评估表达式来计算的。这些必须是标量表达式
（由标量文字、字段引用和标量
函数组成的表达式，即元素函数，为每个输入行返回一个值，而与所有其他行的值无关）。这通过 <code>ProjectNodeOptions</code> 公开，它要求每个输出列都有一个 <code>alkaid::compute::Expression</code>
和名称（如果没有提供名称，则将使用 exprs 的字符串表示形式）。</p>
<p><code>project</code>示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a project node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Scan-Project-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a Scan operation can be used to load the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// into the execution plan, how a project operation can be applied on the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data stream and how the output is collected into a table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanProjectSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expression a_times_2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;multiply&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration project</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;project&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ProjectNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">a_times_2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">project</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="aggregate"><code>aggregate</code><a href="#aggregate" class="hash-link" aria-label="Direct link to aggregate" title="Direct link to aggregate">​</a></h3>
<p><code>aggregate</code> 节点计算各种类型的数据聚合。</p>
<p>Alkaid 支持两种类型的聚合：“标量”聚合和“哈希”聚合。标量聚合将数组或标量输入简化为单个标量输出（例如，计算列的平均值）。
哈希聚合的作用类似于 SQL 中的 <code>GROUP BY</code>，首先根据一个或多个关键列对数据进行分区，然后减少每个分区中的数据。<code>aggregate</code>
节点支持这两种类型的计算，并且可以一次计算任意数量的聚合。</p>
<p><code>AggregateNodeOptions</code> 用于定义聚合标准。它需要一个聚合函数及其选项的列表；要聚合的目标字段列表，每个函数一个；以及
输出字段的名称列表，每个函数一个。在哈希聚合的情况下，它还可以选择用于对数据进行分区的列列表。可以从<code>此聚合函数列表&lt;aggregation-option-list&gt;</code>
中选择聚合函数。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>此节点是一个<code>管道断路器</code>，它将在内存中完全实现数据集。将来，将添加溢出机制，以缓解这一限制。</p></div></div>
<p>聚合可以将结果作为组或标量提供。例如，像 <code>hash_count</code> 这样的操  作将每个唯一记录的计数作为分组结果提供，而像 <code>sum</code> 这样的操作则提供单个记录。</p>
<p>标量聚合示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing an aggregation node to aggregate an entire table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Aggregation-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how an aggregation operation can be applied on a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// execution plan resulting in a scalar output. The source node loads the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data and the aggregation (counting unique types in column &#x27;a&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is applied on this data. The output is collected into a table (that will</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// have exactly one row)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceScalarAggregateSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> aggregate_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AggregateNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*aggregates=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;sum&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;sum(a)&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration aggregate</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;aggregate&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>组聚合示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing an aggregation node to perform a group-by operation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Aggregation-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how an aggregation operation can be applied on a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// execution plan resulting in grouped output. The source node loads the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data and the aggregation (counting unique types in column &#x27;a&#x27;) is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// applied on this data. The output is collected into a table that will contain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// one row for each unique combination of group keys.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceGroupAggregateSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">cp</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">CountOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">CountOptions</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ONLY_VALID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> aggregate_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AggregateNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*aggregates=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;hash_count&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;count(a)&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*keys=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration aggregate</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;aggregate&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sink"><code>sink</code><a href="#sink" class="hash-link" aria-label="Direct link to sink" title="Direct link to sink">​</a></h3>
<p><code>sink</code> 操作提供输出，是流式执行定义的最终节点。<code>SinkNodeOptions</code> 接口用于传递所需的选项。与源操作符类
似，sink 操作符每次调用时都会使用返回记录批处理未来的函数来公开输出。预计调用者将重复调用此函数，直到生成器函数耗
尽（返回<code>std::optional::nullopt</code>）。如果此函数调用不够频繁，则记录批处理将在内存中累积。执行计划应该只有一个“终端”节点（一个接收器节
点）。<code>ExecPlan</code> 可能会因取消或错误而提前终止，在输出被完全使用之前。但是，该计划可以独立于接收器安全地销毁，接收器将通
过<code>exec_plan-&gt;finished()</code> 保存未使用的批次。</p>
<p>作为源示例的一部分，还包括 Sink 操作；</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example demonstrating a source and sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Table Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a custom source can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes source node using pregenerated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data and collecting it into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This sort of custom source is often not needed.  In most cases you can</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// use a scan (for a dataset source) or a source like table_source, array_vector_source,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// exec_batch_source, or record_batch_source (for in-memory data)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="consuming_sink"><code>consuming_sink</code><a href="#consuming_sink" class="hash-link" aria-label="Direct link to consuming_sink" title="Direct link to consuming_sink">​</a></h3>
<p><code>consuming_sink</code> 操作符是执行计划中包含消费操作的接收操作（即，执行计划在消费完成之前不应完成）。
与 <code>sink</code> 节点不同，此节点接收预期消费批次的回调函数。一旦此回调完成，执行计划将不再保留对批次的任何
引用。消费函数可能在上一次调用完成之前被调用。如果  消费函数运行不够快，那么许多并发执行可能会堆积起来，从而阻塞 CPU
线程池。在所有消费函数回调完成之前，执行计划不会被标记为完成。一旦所有批次都已交付，执行计划将等待 <code>finish</code> 未来完成，然后
再将执行计划标记为完成。这允许工作流，其中消费函数将批次转换为异步任务（这目前在数据集写入节点内部完成）。</p>
<p>例子：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// define a Custom SinkNodeConsumer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CustomSinkNodeConsumer</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> cp</span><span class="token base-clause double-colon punctuation" style="color:#393A34">::</span><span class="token base-clause class-name" style="color:#116329">SinkNodeConsumer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">CustomSinkNodeConsumer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain">finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">batches_seen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Consumption logic can be written here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">Consume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch batch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// data can be consumed in the expected way</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// transfer to another system or just do some work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// and write to disk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">CustomSinkNodeConsumer</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> consumer </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">CustomSinkNodeConsumer</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">acero</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNode </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">consuming_sink</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consuming_sink</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;consuming_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ConsumingSinkNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consumer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Consuming-Sink 示例:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a consuming sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Consuming-Sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how the data can be consumed within the execution plan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// by using a ConsumingSink node. There is no data output from this execution plan.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceConsumingSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CustomSinkNodeConsumer</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> ac</span><span class="token base-clause double-colon punctuation" style="color:#393A34">::</span><span class="token base-clause class-name" style="color:#116329">SinkNodeConsumer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">CustomSinkNodeConsumer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">batches_seen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">Init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Schema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">BackpressureControl</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> backpressure_control</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This will be called as the plan is started (before the first call to Consume)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// and provides the schema of the data coming into the node, controls for pausing /</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// resuming input, and a pointer to the plan itself which can be used to access</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// other utilities such as the thread indexer or async task scheduler.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">Consume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch batch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Here you can perform whatever (possibly async) cleanup is needed, e.g. closing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// output file handles and flushing remaining work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeFinished</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">CustomSinkNodeConsumer</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> consumer </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">CustomSinkNodeConsumer</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration consuming_sink</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;consuming_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ConsumingSinkNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consumer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Since we are consuming the data within the plan there is no output and we simply</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// run the plan to completion instead of collecting into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">DeclarationToStatus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consuming_sink</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;The consuming sink node saw &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot; batches&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="order_by_sink"><code>order_by_sink</code><a href="#order_by_sink" class="hash-link" aria-label="Direct link to order_by_sink" title="Direct link to order_by_sink">​</a></h3>
<p><code>order_by_sink</code> 操作是 <code>sink</code> 操作的扩展。此操作通过提供 <code>OrderBySinkNodeOptions</code> 来保证流的排序。
这里提供了 <code>alkaid::compute::SortOptions</code> 来定义哪些列用于排序以及是否按升序或降序值排序。</p>
<div></div>
<p>此节点是一个“管道断路器”，它将在内存中完全实现数据集。将来，将添加溢出机制，以缓解这一限制。
:::</p>
<p>Order-By-Sink 示例:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTableWithCustomSink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Schema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// translate sink_gen (async) to sink_reader (sync)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RecordBatchReader</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> sink_reader </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeGeneratorReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">default_memory_pool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// validate the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">Validate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;ExecPlan created : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// start the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">StartProducing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// collect sink_reader into a Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Table</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> response_table</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response_table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Table</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FromRecordBatchReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sink_reader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Results : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> response_table</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// stop producing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">StopProducing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// plan mark finished</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> future </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">finished</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> future</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing an order-by node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-OrderBy-Sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// In this example, the data enters through the source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// and the data is ordered in the sink node. The order can be</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// ASCENDING or DESCENDING and it is configurable. The output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is obtained as a table from the sink node.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceOrderBySinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">ExecPlan</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">threaded_exec_context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeSortTestBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNode </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;order_by_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">OrderBySinkNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SortOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SortKey</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SortOrder</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Descending</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">sink_gen</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTableWithCustomSink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="select_k_sink"><code>select_k_sink</code><a href="#select_k_sink" class="hash-link" aria-label="Direct link to select_k_sink" title="Direct link to select_k_sink">​</a></h3>
<p><code>select_k_sink</code> 选项允许选择顶部/底部 K 个元素，</p>
<p>类似于 SQL <code>ORDER BY ... LIMIT K</code> 子句。<code>SelectKOptions</code></p>
<p>是使用 <code>OrderBySinkNode</code> 定义定义的。此选项返回</p>
<p>一个接收输入然后计算 top_k/bottom_k 的接收器节点。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>此节点是一个“管道断路器”，将在内存中完全实现输入。将来，将添加溢出机制，这应该可以缓解这一限制。</p></div></div>
<p>SelectK 示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a select-k node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-KSelect</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how K number of elements can be selected</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// either from the top or bottom. The output node is a modified</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// sink node where output can be obtained as a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceKSelectExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeGroupableBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">ExecPlan</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">threaded_exec_context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNode </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SelectKOptions options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">SelectKOptions</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">TopKDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*k=*/</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;i32&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;select_k_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SelectKSinkNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">sink_gen</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;i32&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;str&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">utf8</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTableWithCustomSink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="table_sink"><code>table_sink</code><a href="#table_sink" class="hash-link" aria-label="Direct link to table_sink" title="Direct link to table_sink">​</a></h3>
<p><code>table_sink</code> 节点提供了将输出作为内存表接收的功能。这比流执行引擎提供的其他接收器节点更易于使用，但只有当输出
适合内存时才有意义。该节点是使用<code>TableSinkNodeOptions</code>创建的。</p>
<p>使用 <code>table_sink</code> 的示例</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a table sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// TableSink Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a table_sink can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes a source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// receiving data as batches and the table sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// which emits the output as a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">TableSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">ExecPlan</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">threaded_exec_context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNode </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Table</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> output_table</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table_sink_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TableSinkNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">output_table</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;table_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> table_sink_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// validate the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">Validate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;ExecPlan created : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// start the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">StartProducing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Wait for the plan to finish</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> finished </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">finished</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finished</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Results : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> output_table</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scan"><code>scan</code><a href="#scan" class="hash-link" aria-label="Direct link to scan" title="Direct link to scan">​</a></h3>
<p><code>scan</code> 是用于加载和处理数据集的操作。当您的输入是数据集时，它应该优于更通用的 <code>source</code> 节点。该行为
使用 <code>alkaid::dataset::ScanNodeOptions</code> 定义。有关数据集和各种扫描选项的更多信息，请参阅 <code>../dataset</code>。</p>
<p>此节点能够将下推过滤器应用于文件读取器，从而减少需要读取的数据量。这意味着您可以向扫描节点提供与 FilterNode 相同的过滤器表达式，因为过滤是在两个不同的地方完成的。</p>
<p>扫描示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example demonstrating a scan and sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Scan-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how scan operation can be applied on a dataset.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// There are operations that can be applied on the scan (project, filter)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// and the input data can be processed. The output is obtained as a table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// create empty projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// construct the scan node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="write"><code>write</code><a href="#write" class="hash-link" aria-label="Direct link to write" title="Direct link to write">​</a></h3>
<p><code>write</code> 节点使用 Alkaid 中的 <code>../dataset</code> 功能将查询结果保存为 Parquet、Feather、CSV 等格式的文件数据集。写入选项通
过 <code>alkaid::dataset::WriteNodeOptions</code> 提供，而 <code>alkaid::dataset::FileSystemDatasetWriteOptions</code> 又包
含 <code>alkaid::dataset::FileSystemDatasetWriteOptions</code>。<code>alkaid::dataset::FileSystemDatasetWriteOptions</code> 提
供对写入数据集的控制，包括输出目录、文件命名方案等选项。</p>
<p>写入示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a write node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \param file_path The destination to write to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Scan-Filter-Write</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how scan node can be used to load the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// and after processing how it can be written to disk.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanFilterWriteExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// empty projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string root_path </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string uri </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;file://&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">fs</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">FileSystem</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> filesystem</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">fs</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FileSystemFromUri</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uri</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">root_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> base_path </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> root_path </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;/parquet_dataset&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Uncomment the following line, if run repeatedly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// TURBO_RETURN_NOT_OK(filesystem-&gt;DeleteDirContents(base_path));</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filesystem</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">CreateDir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The partition schema determines which fields are part of the partitioning.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> partition_schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// We&#x27;ll use Hive-style partitioning,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// which creates directories with &quot;key=value&quot; pairs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> partitioning </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">HivePartitioning</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">partition_schema</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// We&#x27;ll write Parquet files.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> format </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ParquetFileFormat</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">FileSystemDatasetWriteOptions write_options</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">file_write_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> format</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">DefaultWriteOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filesystem </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> filesystem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">base_dir </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> base_path</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">partitioning </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> partitioning</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">basename_template </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;part{i}.parquet&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">WriteNodeOptions write_node_options</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">write_options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration write</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;write&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">write_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Since the write node has no output we simply run the plan to completion and the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// data should be written</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">DeclarationToStatus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Dataset written to &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> base_path </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="union"><code>union</code><a href="#union" class="hash-link" aria-label="Direct link to union" title="Direct link to union">​</a></h3>
<p><code>union</code> 将具有相同架构的多个数据流合并为一个，
类似于 SQL <code>UNION ALL</code> 子句。</p>
<p>以下示例演示了如何使用两个数据源实现这一点。</p>
<p>联合示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a union node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Union-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a union operation can be applied on two</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data sources. The output is collected into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceUnionSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration lhs</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lhs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">label </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;lhs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration rhs</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rhs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">label </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;rhs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration union_plan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;union&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lhs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rhs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">union_plan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hash_join"><code>hash_join</code><a href="#hash_join" class="hash-link" aria-label="Direct link to hash_join" title="Direct link to hash_join">​</a></h3>
<p><code>hash_join</code> 操作提供关系代数操作，使用基于哈希的算法进行连接。<code>HashJoinNodeOptions</code> 包含定义连接所需的选项。
hash_join 支持 <a href="https://en.wikipedia.org/wiki/Join_(SQL)" target="_blank" rel="noopener noreferrer">左/右/全半/反/外连接</a>。此外，可以通过连接选项设
置连接键（即要连接的列）和后缀（即后缀术语，如“_x”，可以作为在左关系和右关系中重复的列名的后缀附加）。
<a href="https://en.wikipedia.org/wiki/Hash_join" target="_blank" rel="noopener noreferrer">阅读更多关于 hash-joins</a>。</p>
<p>Hash-Join 示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a hash join node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-HashJoin-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how source node gets the data and how a self-join</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is applied on the data. The join options are configurable. The output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is collected into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceHashJoinSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeGroupableBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration left</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration right</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">HashJoinNodeOptions join_opts</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">JoinType</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">INNER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*left_keys=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;str&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*right_keys=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;str&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;l_&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;r_&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration hashjoin</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;hashjoin&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">left</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">right</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">join_opts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hashjoin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>这些节点的示例可以在 Alkaid 源中的
<code>cpp/examples/alkaid/execution_plan_documentation_examples.cc</code> 中找到。</p>
<p>完整示例：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/array.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/builder.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/acero/exec_plan.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/compute/api.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/compute/api_vector.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/compute/cast.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/csv/api.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/dataset/dataset.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/dataset/file_base.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/dataset/file_parquet.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/dataset/plan.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/dataset/scanner.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/io/interfaces.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/io/memory.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/result.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/status.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/table.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/ipc/api.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/util/future.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/util/range.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/util/thread_pool.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;alkaid/util/vector.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;iostream&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;memory&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;utility&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Demonstrate various operators in Alkaid Streaming Execution Engine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">namespace</span><span class="token plain"> cp </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">compute</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">namespace</span><span class="token plain"> ac </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">acero</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token plain"> kSep</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;******&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;\n\t&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> kSep </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> msg </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> kSep </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;\n&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TYPE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">enable_if</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">is_number_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TYPE</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">value </span><span class="token operator" style="color:#D73A49">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                             alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">is_boolean_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TYPE</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">value </span><span class="token operator" style="color:#D73A49">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                             alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">is_temporal_type</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TYPE</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">value</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">type</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Array</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetArrayDataSample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TYPE</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">c_type</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> values</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> AlkaidBuilderType </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TypeTraits</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TYPE</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">BuilderType</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AlkaidBuilderType builder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Reserve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">AppendValues</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TYPE</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Array</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetBinaryArrayDataSample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> values</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> AlkaidBuilderType </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TypeTraits</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">TYPE</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">BuilderType</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AlkaidBuilderType builder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Reserve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">AppendValues</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RecordBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetSampleRecordBatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ArrayVector array_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">FieldVector</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> field_vector</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RecordBatch</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> record_batch</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> struct_result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">StructArray</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">array_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> field_vector</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> record_batch</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">FromStructArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">struct_result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief Create a sample table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// The table&#x27;s contents will be:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// a,b</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 1,null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 2,true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// null,true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 3,false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// null,true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 4,false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 5,null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 6,false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 7,false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// 8,true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \return The created table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Table</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> null_long </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">numeric_limits</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int64_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">quiet_NaN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> int64_array</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int64Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> null_long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> null_long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">BooleanBuilder boolean_builder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">BooleanArray</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> bool_array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint8_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> bool_values </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                      </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> is_valid </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">boolean_builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Reserve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">boolean_builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">AppendValues</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bool_values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> is_valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">boolean_builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">bool_array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> record_batch </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">RecordBatch</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                              alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">boolean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">int64_array</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bool_array</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Table</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FromRecordBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">record_batch</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief Create a sample dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \return An in-memory dataset based on GetTable()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> ds </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">InMemoryDataset</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> ds</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">FieldVector</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> field_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ArrayVector</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> array_vector</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RecordBatch</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> record_batch</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> res_batch</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetSampleRecordBatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">array_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> field_vector</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch batch</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">res_batch</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> batch</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: BatchesWithSchema Definition)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">BatchesWithSchema</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> batches</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Schema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This method uses internal alkaid utilities to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// convert a vector of record batches to an AsyncGenerator of optional batches</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> opt_batches </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">internal</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MapVector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch batch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">make_optional</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        batches</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gen </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeVectorGenerator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">opt_batches</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: BatchesWithSchema Definition)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: MakeBasicBatches Definition)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">BatchesWithSchema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BatchesWithSchema out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> field_vector </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">boolean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1_bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">BooleanType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2_bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">BooleanType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3_bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">BooleanType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b1_bool</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b2_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b2_bool</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b3_bool</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batches </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_vector</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: MakeBasicBatches Definition)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">BatchesWithSchema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeSortTestBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BatchesWithSchema out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> field </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">121</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">101</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">12</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">210</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">121</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b4_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">101</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">34</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b5_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">12</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b6_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">101</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">12</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b7_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">210</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">11</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b8_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1_int</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b2_int</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b8_int</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b4_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b5_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b6_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b7_int</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batches </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b4</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Result</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">BatchesWithSchema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeGroupableBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> multiplicity </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BatchesWithSchema out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> fields </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;i32&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;str&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">utf8</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">Int32Type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1_str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetBinaryArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">StringType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                         </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;alpha&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;beta&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;alpha&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2_str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetBinaryArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">StringType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                         </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;alpha&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;gamma&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;alpha&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3_str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">GetBinaryArrayDataSample</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">StringType</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                         </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;gamma&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;beta&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;alpha&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b1_str</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b2_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b2_str</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetExecBatchFromVectors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b3_int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b3_str</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batches </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">b1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  size_t batch_count </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batches</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> repeat </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> repeat </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> multiplicity</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">++</span><span class="token plain">repeat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size_t i </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> batch_count</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">++</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batches</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">push_back</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batches</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration plan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// collect sink_reader into a Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Table</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> response_table</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response_table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">DeclarationToTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Results : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> response_table</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Scan Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example demonstrating a scan and sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Scan-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how scan operation can be applied on a dataset.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// There are operations that can be applied on the scan (project, filter)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// and the input data can be processed. The output is obtained as a table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// create empty projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// construct the scan node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Scan Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Source Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example demonstrating a source and sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Table Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a custom source can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes source node using pregenerated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data and collecting it into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This sort of custom source is often not needed.  In most cases you can</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// use a scan (for a dataset source) or a source like table_source, array_vector_source,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// exec_batch_source, or record_batch_source (for in-memory data)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Source Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Table Source Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a table source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// TableSource-Table Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a table_source can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes a table source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// receiving data from a table.  This plan simply collects the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data back into a table but nodes could be added that modify</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// or transform the data as well (as is shown in later examples)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">TableSourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> max_batch_size </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table_source_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TableSourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> max_batch_size</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;table_source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_source_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Table Source Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Filter Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a filter node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Filter-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a filter can be used in an execution plan,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// to filter data from a source. The output from the execution plan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is collected into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanFilterSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// specify the filter.  This filter removes all rows where the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// value of the &quot;a&quot; column is greater than 3.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expression filter_expr </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">greater</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// set filter for scanner : on-disk / push-down filtering.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This step can be skipped if you are not reading from disk.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">filter </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> filter_expr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// empty projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// construct the scan node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Initialized Scanning Options&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Scan node options created&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// pipe the scan node into the filter node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Need to set the filter in scan node options and filter node options.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// At scan node it is used for on-disk / push-down filtering.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// At filter node it is used for in-memory filtering.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration filter</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;filter&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FilterNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter_expr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Filter Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Project Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a project node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Scan-Project-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a Scan operation can be used to load the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// into the execution plan, how a project operation can be applied on the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data stream and how the output is collected into a table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanProjectSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expression a_times_2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;multiply&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration project</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;project&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ProjectNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">a_times_2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">project</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Project Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This is a variation of ScanProjectSinkExample introducing how to use the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Declaration::Sequence function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanProjectSequenceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Expression a_times_2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;multiply&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field_ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Project Sequence Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Inputs do not have to be passed to the project node when using Sequence</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration plan </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Declaration</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Sequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;project&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ProjectNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">a_times_2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Project Sequence Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Scalar Aggregate Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing an aggregation node to aggregate an entire table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Aggregation-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how an aggregation operation can be applied on a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// execution plan resulting in a scalar output. The source node loads the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data and the aggregation (counting unique types in column &#x27;a&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is applied on this data. The output is collected into a table (that will</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// have exactly one row)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceScalarAggregateSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> aggregate_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AggregateNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*aggregates=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;sum&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;sum(a)&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration aggregate</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;aggregate&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Scalar Aggregate Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Group Aggregate Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing an aggregation node to perform a group-by operation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Aggregation-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how an aggregation operation can be applied on a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// execution plan resulting in grouped output. The source node loads the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data and the aggregation (counting unique types in column &#x27;a&#x27;) is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// applied on this data. The output is collected into a table that will contain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// one row for each unique combination of group keys.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceGroupAggregateSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">cp</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">CountOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">CountOptions</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ONLY_VALID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> aggregate_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AggregateNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*aggregates=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;hash_count&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;count(a)&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*keys=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration aggregate</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;aggregate&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Group Aggregate Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: ConsumingSink Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a consuming sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Consuming-Sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how the data can be consumed within the execution plan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// by using a ConsumingSink node. There is no data output from this execution plan.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceConsumingSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CustomSinkNodeConsumer</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> ac</span><span class="token base-clause double-colon punctuation" style="color:#393A34">::</span><span class="token base-clause class-name" style="color:#116329">SinkNodeConsumer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">CustomSinkNodeConsumer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">batches_seen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">Init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Schema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">BackpressureControl</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> backpressure_control</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This will be called as the plan is started (before the first call to Consume)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// and provides the schema of the data coming into the node, controls for pausing /</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// resuming input, and a pointer to the plan itself which can be used to access</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// other utilities such as the thread indexer or async task scheduler.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">Consume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch batch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Finish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Here you can perform whatever (possibly async) cleanup is needed, e.g. closing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// output file handles and flushing remaining work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeFinished</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">uint32_t</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Future</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">CustomSinkNodeConsumer</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> consumer </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">CustomSinkNodeConsumer</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">batches_seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> finish</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration consuming_sink</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;consuming_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ConsumingSinkNodeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consumer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Since we are consuming the data within the plan there is no output and we simply</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// run the plan to completion instead of collecting into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">DeclarationToStatus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">consuming_sink</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;The consuming sink node saw &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> batches_seen</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot; batches&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: ConsumingSink Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: OrderBySink Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTableWithCustomSink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Schema</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// translate sink_gen (async) to sink_reader (sync)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RecordBatchReader</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> sink_reader </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeGeneratorReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">default_memory_pool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// validate the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">Validate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;ExecPlan created : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// start the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">StartProducing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// collect sink_reader into a Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Table</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> response_table</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response_table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Table</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FromRecordBatchReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sink_reader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Results : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> response_table</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// stop producing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">StopProducing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// plan mark finished</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> future </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">finished</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> future</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing an order-by node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-OrderBy-Sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// In this example, the data enters through the source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// and the data is ordered in the sink node. The order can be</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// ASCENDING or DESCENDING and it is configurable. The output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is obtained as a table from the sink node.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceOrderBySinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">ExecPlan</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">threaded_exec_context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeSortTestBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNode </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;order_by_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">OrderBySinkNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SortOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SortKey</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SortOrder</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Descending</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">sink_gen</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTableWithCustomSink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: OrderBySink Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: HashJoin Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a hash join node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-HashJoin-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how source node gets the data and how a self-join</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is applied on the data. The join options are configurable. The output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// is collected into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceHashJoinSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeGroupableBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration left</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration right</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">HashJoinNodeOptions join_opts</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">JoinType</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">INNER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*left_keys=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;str&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*right_keys=*/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;str&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">literal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;l_&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;r_&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration hashjoin</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;hashjoin&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">left</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">right</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">join_opts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hashjoin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: HashJoin Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: KSelect Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a select-k node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-KSelect</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how K number of elements can be selected</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// either from the top or bottom. The output node is a modified</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// sink node where output can be obtained as a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceKSelectExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeGroupableBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">ExecPlan</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">threaded_exec_context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNode </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SelectKOptions options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">SelectKOptions</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">TopKDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token comment" style="color:#6B6B6B;font-style:italic">/*k=*/</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;i32&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;select_k_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SelectKSinkNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">sink_gen</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;i32&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;str&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">utf8</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTableWithCustomSink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: KSelect Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Write Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a write node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \param file_path The destination to write to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Scan-Filter-Write</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how scan node can be used to load the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// and after processing how it can be written to disk.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">ScanFilterWriteExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Dataset</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDataset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ScanOptions</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// empty projection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token plain">projection </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> scan_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ScanNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration scan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;scan&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AsyncGenerator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecBatch</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token plain"> sink_gen</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string root_path </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string uri </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;file://&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">fs</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">FileSystem</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> filesystem</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">fs</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">FileSystemFromUri</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uri</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">root_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> base_path </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> root_path </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;/parquet_dataset&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Uncomment the following line, if run repeatedly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// TURBO_RETURN_NOT_OK(filesystem-&gt;DeleteDirContents(base_path));</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filesystem</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">CreateDir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The partition schema determines which fields are part of the partitioning.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> partition_schema </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// We&#x27;ll use Hive-style partitioning,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// which creates directories with &quot;key=value&quot; pairs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> partitioning </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">HivePartitioning</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">partition_schema</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// We&#x27;ll write Parquet files.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> format </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">dataset</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">ParquetFileFormat</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">FileSystemDatasetWriteOptions write_options</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">file_write_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> format</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">DefaultWriteOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filesystem </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> filesystem</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">base_dir </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> base_path</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">partitioning </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> partitioning</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  write_options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">basename_template </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;part{i}.parquet&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">WriteNodeOptions write_node_options</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">write_options</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration write</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;write&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">write_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Since the write node has no output we simply run the plan to completion and the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// data should be written</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">DeclarationToStatus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Dataset written to &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> base_path </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Write Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Union Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a union node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// Source-Union-Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a union operation can be applied on two</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// data sources. The output is collected into a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">SourceUnionSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration lhs</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lhs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">label </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;lhs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration rhs</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rhs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">label </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;rhs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration union_plan</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#C6105F">&quot;union&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lhs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rhs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">union_plan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Union Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Table Sink Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing a table sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// TableSink Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a table_sink can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes a source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// receiving data as batches and the table sink node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// which emits the output as a table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">TableSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecPlan</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">ExecPlan</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">cp</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">threaded_exec_context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBasicBatches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> source_node_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> basic_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ExecNode </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> source_node_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Table</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> output_table</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table_sink_options </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TableSinkNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">output_table</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MakeExecNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;table_sink&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> table_sink_options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// validate the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">Validate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;ExecPlan created : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// start the ExecPlan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">StartProducing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Wait for the plan to finish</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> finished </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> plan</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">finished</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">RETURN_NOT_OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">finished</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Results : &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> output_table</span><span class="token operator" style="color:#D73A49">-&gt;</span><span class="token function" style="color:#8250DF">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name" style="color:#116329">Status</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">OK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: Table Sink Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: RecordBatchReaderSource Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// \brief An example showing the usage of a RecordBatchReader as the data source.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// RecordBatchReaderSourceSink Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// This example shows how a record_batch_reader_source can be used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// in an execution plan. This includes the source node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">/// receiving data from a TableRecordBatchReader.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status </span><span class="token function" style="color:#8250DF">RecordBatchReaderSourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">TURBO_MOVE_OR_RAISE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RecordBatchReader</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> reader </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">make_shared</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">alkaid</span><span class="token generic-function generic class-name double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function generic class-name" style="color:#116329">TableBatchReader</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Declaration reader_source</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;record_batch_reader_source&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                ac</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">RecordBatchReaderSourceNodeOptions</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">reader</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ExecutePlanAndCollectAsTable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reader_source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// (Doc section: RecordBatchReaderSource Example)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">enum</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ExampleMode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SOURCE_SINK </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TABLE_SOURCE_SINK </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SCAN </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FILTER </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PROJECT </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SCALAR_AGGREGATION </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  GROUP_AGGREGATION </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CONSUMING_SINK </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ORDER_BY_SINK </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HASHJOIN </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  KSELECT </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WRITE </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UNION </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TABLE_SOURCE_TABLE_SINK </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RECORD_BATCH_READER_SOURCE </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PROJECT_SEQUENCE </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> argc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Fake success for CI purposes.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> EXIT_SUCCESS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">string base_save_path </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> mode </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">atoi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  turbo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Status status</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// ensure alkaid::dataset node factories are in the registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alkaid</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">dataset</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">internal</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Initialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> SOURCE_SINK</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Source Sink Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> TABLE_SOURCE_SINK</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Table Source Sink Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">TableSourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> SCAN</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Scan Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ScanSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> FILTER</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Filter Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ScanFilterSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> PROJECT</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Project Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ScanProjectSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> PROJECT_SEQUENCE</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Project Example (using Declaration::Sequence)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ScanProjectSequenceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> GROUP_AGGREGATION</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Aggregate Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceGroupAggregateSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> SCALAR_AGGREGATION</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Aggregate Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceScalarAggregateSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> CONSUMING_SINK</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Consuming-Sink Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceConsumingSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> ORDER_BY_SINK</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;OrderBy Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceOrderBySinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> HASHJOIN</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;HashJoin Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceHashJoinSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> KSELECT</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;KSelect Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceKSelectExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> WRITE</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Write Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ScanFilterWriteExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base_save_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> UNION</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Union Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SourceUnionSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> TABLE_SOURCE_TABLE_SINK</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;TableSink Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">TableSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">case</span><span class="token plain"> RECORD_BATCH_READER_SOURCE</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#8250DF">PrintBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;RecordBatchReaderSource Example&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">RecordBatchReaderSourceSinkExample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">default</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> EXIT_SUCCESS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Error occurred: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> status</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">message</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> EXIT_FAILURE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-05-24T10:16:12.000Z" itemprop="dateModified">May 24, 2025</time></b> by <b>Jeff lothar</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cpp/alkaid/acero/overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">概览</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cpp/alkaid/acero/developer_guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">开发者指南</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#使用-acero" class="table-of-contents__link toc-highlight">使用 Acero</a></li><li><a href="#创建计划" class="table-of-contents__link toc-highlight">创建计划</a><ul><li><a href="#using-substrait" class="table-of-contents__link toc-highlight">Using Substrait</a></li><li><a href="#程序化计划制定" class="table-of-contents__link toc-highlight">程序化计划制定</a></li><li><a href="#执行计划" class="table-of-contents__link toc-highlight">执行计划</a></li><li><a href="#declarationtotable" class="table-of-contents__link toc-highlight">DeclarationToTable</a></li><li><a href="#declarationtoreader" class="table-of-contents__link toc-highlight">DeclarationToReader</a></li><li><a href="#declarationtostatus" class="table-of-contents__link toc-highlight">DeclarationToStatus</a></li><li><a href="#running-a-plan-directly" class="table-of-contents__link toc-highlight">Running a Plan Directly</a></li></ul></li><li><a href="#提供输入" class="table-of-contents__link toc-highlight">提供输入</a></li><li><a href="#可用的-execnode-实现" class="table-of-contents__link toc-highlight">可用的 <code>ExecNode</code> 实现</a><ul><li><a href="#源节点----sources-nodes" class="table-of-contents__link toc-highlight">源节点 -- Sources Nodes</a></li><li><a href="#计算节点----compute-nodes" class="table-of-contents__link toc-highlight">计算节点 -- Compute Nodes</a></li><li><a href="#排列节点----arrangement-nodes" class="table-of-contents__link toc-highlight">排列节点 -- Arrangement Nodes</a></li><li><a href="#汇聚节点----sink-nodes" class="table-of-contents__link toc-highlight">汇聚节点 -- Sink Nodes</a></li></ul></li><li><a href="#示例" class="table-of-contents__link toc-highlight">示例</a><ul><li><a href="#源-source" class="table-of-contents__link toc-highlight"><code>源</code> <code>source</code></a></li><li><a href="#table_source" class="table-of-contents__link toc-highlight"><code>table_source</code></a></li><li><a href="#filter" class="table-of-contents__link toc-highlight"><code>filter</code></a></li><li><a href="#project" class="table-of-contents__link toc-highlight"><code>project</code></a></li><li><a href="#aggregate" class="table-of-contents__link toc-highlight"><code>aggregate</code></a></li><li><a href="#sink" class="table-of-contents__link toc-highlight"><code>sink</code></a></li><li><a href="#consuming_sink" class="table-of-contents__link toc-highlight"><code>consuming_sink</code></a></li><li><a href="#order_by_sink" class="table-of-contents__link toc-highlight"><code>order_by_sink</code></a></li><li><a href="#select_k_sink" class="table-of-contents__link toc-highlight"><code>select_k_sink</code></a></li><li><a href="#table_sink" class="table-of-contents__link toc-highlight"><code>table_sink</code></a></li><li><a href="#scan" class="table-of-contents__link toc-highlight"><code>scan</code></a></li><li><a href="#write" class="table-of-contents__link toc-highlight"><code>write</code></a></li><li><a href="#union" class="table-of-contents__link toc-highlight"><code>union</code></a></li><li><a href="#hash_join" class="table-of-contents__link toc-highlight"><code>hash_join</code></a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">阅读</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">文档</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation">安装</a></li></ul></div><div class="col footer__col"><div class="footer__title">支持与资源</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/feature-requests">Feature Requests</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/community/support">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">更新</a></li><li class="footer__item"><a href="https://gitee.com/kumo-pub" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kumo-ai.tech" target="_blank" rel="noopener noreferrer" class="footer__link-item">网站<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">版权 © 2025 北京科米智创科技有限公司</div></div></div></footer></div>
</body>
</html>