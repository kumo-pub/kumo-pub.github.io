<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.1.1 docs-doc-page docs-doc-id-cpp/base/testing/kt/kmock_cook_book" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">kmock æ•™ç¨‹ | Kumo AI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kumo-pub.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kumo-pub.github.io/docs/cpp/base/testing/kt/kmock_cook_book"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.1.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" name="docsearch:version" content="1.1.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.1.1"><meta data-rh="true" property="og:title" content="kmock æ•™ç¨‹ | Kumo AI"><meta data-rh="true" name="description" content="æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°ä½¿ç”¨ kMock çš„æ•™ç¨‹ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»è¿‡ï¼Œè¯·é˜…è¯»"><meta data-rh="true" property="og:description" content="æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°ä½¿ç”¨ kMock çš„æ•™ç¨‹ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»è¿‡ï¼Œè¯·é˜…è¯»"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://kumo-pub.github.io/docs/cpp/base/testing/kt/kmock_cook_book"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/cpp/base/testing/kt/kmock_cook_book" hreflang="en"><link data-rh="true" rel="alternate" href="https://kumo-pub.github.io/docs/cpp/base/testing/kt/kmock_cook_book" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kumo AI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kumo AI Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Kumo AI JSON Feed">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E5CR2Q1NRE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-E5CR2Q1NRE",{})</script>


<link rel="alternate" type="application/rss+xml" href="/changelog/rss.xml" title="Docusaurus changelog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/changelog/atom.xml" title="Docusaurus changelog Atom Feed">
<link rel="alternate" type="application/json" href="/changelog/feed.json" title="Docusaurus changelog JSON Feed">



<link rel="icon" href="/img/docusaurus.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/docusaurus.png">
<link rel="mask-icon" href="/img/docusaurus.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/docusaurus.png">
<meta name="msapplication-TileColor" content="#000">



<link rel="alternate" type="application/rss+xml" href="/tests/blog/rss.xml" title="Docusaurus Tests Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tests/blog/atom.xml" title="Docusaurus Tests Blog Atom Feed">
<link rel="alternate" type="application/json" href="/tests/blog/feed.json" title="Docusaurus Tests Blog JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kumo AI" href="/opensearch.xml">

<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.21fbef88.css">
<script src="/assets/js/runtime~main.b6add41e.js" defer="defer"></script>
<script src="/assets/js/main.d99df9f3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme-b4f")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss-b4f")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">ğŸ‰ï¸ <b><a target="_blank" href="https://docusaurus.io/blog/releases/1.1">Kumo v1.1</a> is out!</b> ğŸ¥³ï¸</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"></div><b class="navbar__title text--truncate">ä¸»é¡µ</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/docs/category/kmsearch">API</a><a class="navbar__item navbar__link" href="/blog">åšå®¢</a><a class="navbar__item navbar__link" href="/changelog">å‘å¸ƒ</a><a class="navbar__item navbar__link" href="/showcase">åº”ç”¨æ¡ˆä¾‹</a><a class="navbar__item navbar__link" href="/community/support">æ”¯æŒä¸èµ„æº</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/cpp/base/testing/kt/kmock_cook_book">1.1.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/cpp/base/testing/kt/kmock_cook_book">nightly ğŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/cpp/base/testing/kt/kmock_cook_book">1.1.1</a></li><li><hr class="dropdown-separator"></li><li class="dropdown-archived-versions"><b>Archived versions</b></li><li><a href="https://docusaurus-archive-october-2023.netlify.app/docs/2.3.1" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.0.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://v1.docusaurus.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">1.x.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr class="dropdown-separator"></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/cpp/base/testing/kt/kmock_cook_book" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://github.com/facebook/docusaurus/issues/3526" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/kumo_logo.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE" height="48" width="128"><img src="/img/kumo_logo_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="48" width="128"><b>ä¸»é¡µ</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/åŸºç¡€å‡†å¤‡">åŸºç¡€å‡†å¤‡</a><button aria-label="Collapse sidebar category &#x27;åŸºç¡€å‡†å¤‡&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_be">åç«¯å¼€å‘ç¯å¢ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env_prepare_fe">å‰ç«¯å¼€å‘ç¯å¢ƒ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æŒç»­é›†æˆ----kmpkg">æŒç»­é›†æˆ -- kmpkg</a><button aria-label="Expand sidebar category &#x27;æŒç»­é›†æˆ -- kmpkg&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/cå¼€å‘">c++å¼€å‘</a><button aria-label="Collapse sidebar category &#x27;c++å¼€å‘&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/overview">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/è§„èŒƒé”™è¯¯ä¸é”™è¯¯è¿”å›å€¼">è§„èŒƒé”™è¯¯ä¸é”™è¯¯è¿”å›å€¼</a><button aria-label="Expand sidebar category &#x27;è§„èŒƒé”™è¯¯ä¸é”™è¯¯è¿”å›å€¼&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/æ€§èƒ½æµ‹è¯•ä¸å•å…ƒæµ‹è¯•">æ€§èƒ½æµ‹è¯•ä¸å•å…ƒæµ‹è¯•</a><button aria-label="Collapse sidebar category &#x27;æ€§èƒ½æµ‹è¯•ä¸å•å…ƒæµ‹è¯•&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/overview">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/doctestå•å…ƒæµ‹è¯•">doctestå•å…ƒæµ‹è¯•</a><button aria-label="Expand sidebar category &#x27;doctestå•å…ƒæµ‹è¯•&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/kumo-test">Kumo test</a><button aria-label="Collapse sidebar category &#x27;Kumo test&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/quickstart">å¿«é€Ÿå¼€å§‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/primer">ktest å…¥é—¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/reference/testing">æµ‹è¯•å‚è€ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/reference/assertions">æ–­è¨€å‚è€ƒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/advanced">ktest é«˜çº§æ•™ç¨‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/samples">ktest ç¤ºä¾‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/faq">ktest FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/kmock_for_dummies">kMock å…¥é—¨ç‰ˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cpp/base/testing/kt/kmock_cook_book">kmock æ•™ç¨‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/kmock_cheat_sheet">kmock å¤‡å¿˜å½•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/kt/kmock_faq">kMock å¸¸è§é—®é¢˜è§£ç­”</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/testing/benchmark">google benchmark</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cpp/base/time">æ—¶é—´ä¸æ—¥å†</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/å‘½ä»¤è¡Œä¸é…ç½®">å‘½ä»¤è¡Œä¸é…ç½®</a><button aria-label="Expand sidebar category &#x27;å‘½ä»¤è¡Œä¸é…ç½®&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/hashå®¹å™¨">hashå®¹å™¨</a><button aria-label="Expand sidebar category &#x27;hashå®¹å™¨&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/å­—ç¬¦ä¸å­—ç¬¦ä¸²">å­—ç¬¦ä¸å­—ç¬¦ä¸²</a><button aria-label="Expand sidebar category &#x27;å­—ç¬¦ä¸å­—ç¬¦ä¸²&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/æ ¼å¼ä¸è§£æ">æ ¼å¼ä¸è§£æ</a><button aria-label="Expand sidebar category &#x27;æ ¼å¼ä¸è§£æ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/æ–‡ä»¶å’Œæ–‡ä»¶ç³»ç»Ÿ">æ–‡ä»¶å’Œæ–‡ä»¶ç³»ç»Ÿ</a><button aria-label="Expand sidebar category &#x27;æ–‡ä»¶å’Œæ–‡ä»¶ç³»ç»Ÿ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/å­—ç¬¦ç¼–ç ">å­—ç¬¦ç¼–ç </a><button aria-label="Expand sidebar category &#x27;å­—ç¬¦ç¼–ç &#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/å¤šæ ¸ç¼–ç¨‹">å¤šæ ¸ç¼–ç¨‹</a><button aria-label="Expand sidebar category &#x27;å¤šæ ¸ç¼–ç¨‹&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/logæ—¥å¿—åº“">logæ—¥å¿—åº“</a><button aria-label="Expand sidebar category &#x27;logæ—¥å¿—åº“&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/ç›‘æ§ä¸ä¸ŠæŠ¥">ç›‘æ§ä¸ä¸ŠæŠ¥</a><button aria-label="Expand sidebar category &#x27;ç›‘æ§ä¸ä¸ŠæŠ¥&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/krpcæ•™ç¨‹">krpcæ•™ç¨‹</a><button aria-label="Expand sidebar category &#x27;krpcæ•™ç¨‹&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æœç´ åŸºç¡€å¼€å‘">æœç´ åŸºç¡€å¼€å‘</a><button aria-label="Expand sidebar category &#x27;æœç´ åŸºç¡€å¼€å‘&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æœç´¢åº”ç”¨å¼€å‘">æœç´¢åº”ç”¨å¼€å‘</a><button aria-label="Expand sidebar category &#x27;æœç´¢åº”ç”¨å¼€å‘&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/å‘é‡æ•°æ®åº“æ•™ç¨‹">å‘é‡æ•°æ®åº“æ•™ç¨‹</a><button aria-label="Expand sidebar category &#x27;å‘é‡æ•°æ®åº“æ•™ç¨‹&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/åˆ†å¸ƒå¼æ•°æ®åº“">åˆ†å¸ƒå¼æ•°æ®åº“</a><button aria-label="Expand sidebar category &#x27;åˆ†å¸ƒå¼æ•°æ®åº“&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/æœç´¢-ui">æœç´¢ UI</a><button aria-label="Expand sidebar category &#x27;æœç´¢ UI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/cå¼€å‘"><span itemprop="name">c++å¼€å‘</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/æ€§èƒ½æµ‹è¯•ä¸å•å…ƒæµ‹è¯•"><span itemprop="name">æ€§èƒ½æµ‹è¯•ä¸å•å…ƒæµ‹è¯•</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/kumo-test"><span itemprop="name">Kumo test</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">kmock æ•™ç¨‹</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.1.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>kmock æ•™ç¨‹</h1></header>
<p>æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°ä½¿ç”¨ kMock çš„æ•™ç¨‹ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»è¿‡ï¼Œè¯·é˜…è¯»
<a href="/docs/cpp/base/testing/kt/kmock_for_dummies">å…¥é—¨æ•™ç¨‹</a> é¦–å…ˆç¡®ä¿æ‚¨äº†è§£
åŸºç¡€çŸ¥è¯†ã€‚</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><strong>æ³¨æ„ï¼š</strong> kMock å­˜åœ¨äº <code>testing</code> å‘½åç©ºé—´ä¸­ã€‚ä¸ºäº†å¯è¯»æ€§ï¼Œå®ƒæ˜¯
å»ºè®®åœ¨ä½¿ç”¨ä¹‹å‰åœ¨æ–‡ä»¶ä¸­å†™å…¥ä¸€æ¬¡<code>using ::testing::Foo;</code>
åç§° <code>Foo</code> ç”± kMock å®šä¹‰ã€‚æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­çœç•¥æ­¤ç±»â€œusingâ€è¯­å¥
ç®€æ´ï¼Œä½†æ‚¨åº”è¯¥åœ¨è‡ªå·±çš„ä»£ç ä¸­æ‰§è¡Œæ­¤æ“ä½œã€‚</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="creating-mock-classes">åˆ›å»ºæ¨¡æ‹Ÿç±»<a href="#creating-mock-classes" class="hash-link" aria-label="Direct link to åˆ›å»ºæ¨¡æ‹Ÿç±»" title="Direct link to åˆ›å»ºæ¨¡æ‹Ÿç±»">â€‹</a></h2>
<p>æ¨¡æ‹Ÿç±»è¢«å®šä¹‰ä¸ºæ™®é€šç±»ï¼Œä½¿ç”¨<code>MOCK_METHOD</code>å®æ¥
ç”Ÿæˆæ¨¡æ‹Ÿæ–¹æ³•ã€‚è¯¥å®æœ‰ 3 æˆ– 4 ä¸ªå‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MyMock</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReturnType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MethodName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Args</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReturnType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MethodName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Args</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Specs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å‰ 3 ä¸ªå‚æ•°åªæ˜¯æ–¹æ³•å£°æ˜ï¼Œåˆ†ä¸º 3 éƒ¨åˆ†ã€‚
ç¬¬å››ä¸ªå‚æ•°æ¥å—é™å®šç¬¦çš„å°é—­åˆ—è¡¨ï¼Œè¿™ä¼šå½±å“
ç”Ÿæˆæ–¹æ³•ï¼š</p>
<ul>
<li><strong><code>const</code></strong> - ä½¿æ¨¡æ‹Ÿæ–¹æ³•æˆä¸ºâ€œconstâ€æ–¹æ³•ã€‚å¿…éœ€çš„ï¼Œå¦‚æœ
é‡å†™ <code>const</code> æ–¹æ³•ã€‚</li>
<li><strong><code>override</code></strong> - ç”¨â€œoverrideâ€æ ‡è®°æ–¹æ³•ã€‚å¦‚æœè¦†ç›–åˆ™æ¨è
ä¸€ä¸ªâ€œè™šæ‹Ÿâ€æ–¹æ³•ã€‚</li>
<li><strong><code>noexcept</code></strong> - ç”¨â€œnoexceptâ€æ ‡è®°æ–¹æ³•ã€‚å¦‚æœè¦†ç›–åˆ™éœ€è¦
<code>noexcept</code> æ–¹æ³•ã€‚</li>
<li><strong><code>Calltype(...)</code></strong> - è®¾ç½®æ–¹æ³•çš„è°ƒç”¨ç±»å‹ï¼ˆä¾‹å¦‚
<code>STDMETHODCALLTYPE</code>)ï¼Œåœ¨ Windows ä¸­å¾ˆæœ‰ç”¨ã€‚</li>
<li><strong><code>ref(...)</code></strong> - ä½¿ç”¨å‚è€ƒé™å®šæ ‡è®°æ–¹æ³•
æŒ‡å®šçš„ã€‚å¦‚æœé‡å†™å…·æœ‰å¼•ç”¨çš„æ–¹æ³•ï¼Œåˆ™ä¸ºå¿…éœ€
èµ„æ ¼ã€‚ä¾‹å¦‚â€œref(&amp;)â€æˆ–â€œref(&amp;&amp;)â€ã€‚</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="dealing-with-unprotected-commas">å¤„ç†ä¸å—ä¿æŠ¤çš„é€—å·<a href="#dealing-with-unprotected-commas" class="hash-link" aria-label="Direct link to å¤„ç†ä¸å—ä¿æŠ¤çš„é€—å·" title="Direct link to å¤„ç†ä¸å—ä¿æŠ¤çš„é€—å·">â€‹</a></h3>
<p>ä¸å—ä¿æŠ¤çš„é€—å·ï¼Œå³æ²¡æœ‰è¢«æ‹¬å·åŒ…å›´çš„é€—å·ï¼Œå¯ä»¥é˜²æ­¢
æ­£ç¡®è§£æå…¶å‚æ•°çš„<code>MOCK_METHOD</code>ï¼š</p>
<p><code>{: .bad}</code></p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">pair</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetPair</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Won&#x27;t compile!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CheckMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Won&#x27;t compile!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è§£å†³æ–¹æ¡ˆ 1 - ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼š</p>
<p><code>{: .good}</code></p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">pair</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetPair</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CheckMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç”¨æ‹¬å·åŒ…è£…è¿”å›æˆ–å‚æ•°ç±»å‹æ˜¯ï¼š
æ— æ•ˆçš„ C++ã€‚ <code>MOCK_METHOD</code> åˆ é™¤æ‹¬å·ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆ 2 - å®šä¹‰åˆ«åï¼š</p>
<p><code>{: .good}</code></p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> BoolAndInt </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">pair</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BoolAndInt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetPair</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> MapIntDouble </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CheckMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MapIntDouble</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mocking-private-or-protected-methods">æ¨¡æ‹Ÿç§æœ‰æˆ–å—ä¿æŠ¤çš„æ–¹æ³•<a href="#mocking-private-or-protected-methods" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿç§æœ‰æˆ–å—ä¿æŠ¤çš„æ–¹æ³•" title="Direct link to æ¨¡æ‹Ÿç§æœ‰æˆ–å—ä¿æŠ¤çš„æ–¹æ³•">â€‹</a></h3>
<p>æ‚¨å¿…é¡»å§‹ç»ˆå°†æ¨¡æ‹Ÿæ–¹æ³•å®šä¹‰ï¼ˆ<code>MOCK_METHOD</code>ï¼‰æ”¾åœ¨<code>publicï¼š</code>ä¸­
æ¨¡æ‹Ÿç±»çš„éƒ¨åˆ†ï¼Œæ— è®ºè¢«æ¨¡æ‹Ÿçš„æ–¹æ³•æ˜¯<code>public</code>ï¼Œ
åŸºç±»ä¸­çš„<code>protected</code>æˆ–<code>private</code>ã€‚è¿™å…è®¸<code>ON_CALL</code>å’Œ
<code>EXPECT_CALL</code> ä»æ¨¡æ‹Ÿç±»å¤–éƒ¨å¼•ç”¨æ¨¡æ‹Ÿå‡½æ•°ã€‚
ï¼ˆæ˜¯çš„ï¼ŒC++ å…è®¸å­ç±»æ›´æ”¹è™šå‡½æ•°çš„è®¿é—®çº§åˆ«
åŸºç±»ã€‚ï¼‰ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Gadget</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> g</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">protected</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Resume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">private</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetTimeOut</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Transform</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Gadget</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> g</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The following must be in the public section, even though the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// methods are protected or private in the base class.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Resume</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetTimeOut</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mocking-overloaded-methods">æ¨¡æ‹Ÿé‡è½½æ–¹æ³•<a href="#mocking-overloaded-methods" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿé‡è½½æ–¹æ³•" title="Direct link to æ¨¡æ‹Ÿé‡è½½æ–¹æ³•">â€‹</a></h3>
<p>æ‚¨å¯ä»¥åƒå¾€å¸¸ä¸€æ ·æ¨¡æ‹Ÿé‡è½½å‡½æ•°ã€‚ä¸éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Must be virtual as we&#x27;ll inherit from Foo.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Overloaded on the types and/or numbers of arguments.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Element x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> times</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Element x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Overloaded on the const-ness of this object.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> Bar</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Bar</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Add</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Element x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Add</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> times</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Element x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Bar</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetBar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Bar</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetBar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœä½ ä¸æ¨¡æ‹Ÿé‡è½½æ–¹æ³•çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨
å°†ä¼šå‘æ‚¨å‘å‡ºæœ‰å…³åŸºç±»ä¸­æŸäº›æ–¹æ³•è¢«éšè—çš„è­¦å‘Šã€‚åˆ°
è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨<code>using</code>å°†å®ƒä»¬çº³å…¥èŒƒå›´ï¼š</p></div></div>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Add</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Add</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Element x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// We don&#x27;t want to mock int Add(int times, Element x);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mocking-class-templates">æ¨¡æ‹Ÿç±»æ¨¡æ¿<a href="#mocking-class-templates" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿç±»æ¨¡æ¿" title="Direct link to æ¨¡æ‹Ÿç±»æ¨¡æ¿">â€‹</a></h3>
<p>æ‚¨å¯ä»¥åƒä»»ä½•ç±»ä¸€æ ·æ¨¡æ‹Ÿç±»æ¨¡æ¿ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Elem</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">StackInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Must be virtual as we&#x27;ll inherit from StackInterface.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">StackInterface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetSize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Elem</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Elem</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockStack</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">StackInterface</span><span class="token base-clause operator" style="color:#D73A49">&lt;</span><span class="token base-clause class-name" style="color:#116329">Elem</span><span class="token base-clause operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetSize</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Push</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Elem</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="MockingNonVirtualMethods">æ¨¡æ‹Ÿéè™šæ‹Ÿæ–¹æ³•<a href="#MockingNonVirtualMethods" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿéè™šæ‹Ÿæ–¹æ³•" title="Direct link to æ¨¡æ‹Ÿéè™šæ‹Ÿæ–¹æ³•">â€‹</a></h3>
<p>kMock å¯ä»¥æ¨¡æ‹Ÿç”¨äº Hi-perf ä¾èµ–æ³¨å…¥çš„éè™šæ‹Ÿå‡½æ•°ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨çš„ä¸æ˜¯ä¸çœŸå®ç±»å…±äº«å…¬å…±åŸºç±»ï¼Œè€Œæ˜¯
æ¨¡æ‹Ÿç±»å°†ä¸çœŸå®ç±»<strong>æ— å…³</strong>ï¼Œä½†åŒ…å«å¸¦æœ‰
ç›¸åŒçš„ç­¾åã€‚æ¨¡æ‹Ÿéè™šæ‹Ÿæ–¹æ³•çš„è¯­æ³•ä¸ä»¥ä¸‹<em>ç›¸åŒ</em>
æ¨¡æ‹Ÿè™šæ‹Ÿæ–¹æ³•ï¼ˆåªæ˜¯ä¸è¦æ·»åŠ <code>override</code>ï¼‰ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// A simple packet stream class.  None of its members is virtual.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ConcretePacketStream</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">AppendPacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Packet</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> new_packet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Packet</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetPacket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size_t packet_number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  size_t </span><span class="token function" style="color:#8250DF">NumberOfPackets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// A mock packet stream class.  It inherits from no other, but defines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// GetPacket() and NumberOfPackets().</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockPacketStream</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Packet</span><span class="token operator" style="color:#D73A49">*</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetPacket</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size_t packet_number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size_t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> NumberOfPackets</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œä¸çœŸå®ç±»ä¸åŒï¼Œæ¨¡æ‹Ÿç±»æ²¡æœ‰å®šä¹‰<code>AppendPacket()</code>ã€‚
åªè¦æµ‹è¯•ä¸éœ€è¦è°ƒç”¨å®ƒå°±å¯ä»¥ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦ä¸€ç§æ–¹å¼æ¥è¡¨æ˜æ‚¨æƒ³è¦åœ¨ä¸­ä½¿ç”¨ <code>ConcretePacketStream</code>
ç”Ÿäº§ä»£ç ï¼Œå¹¶åœ¨æµ‹è¯•ä¸­ä½¿ç”¨<code>MockPacketStream</code>ã€‚ç”±äºå‡½æ•°æ˜¯
ä¸æ˜¯è™šæ‹Ÿçš„ï¼Œå¹¶ä¸”ä¸¤ä¸ªç±»ä¸ç›¸å…³ï¼Œæ‚¨å¿…é¡»åœ¨ä»¥ä¸‹ä½ç½®æŒ‡å®šæ‚¨çš„é€‰æ‹©
<em>ç¼–è¯‘æ—¶</em>ï¼ˆç›¸å¯¹äºè¿è¡Œæ—¶ï¼‰ã€‚</p>
<p>ä¸€ç§æ–¹æ³•æ˜¯å°†éœ€è¦ä½¿ç”¨æ•°æ®åŒ…æµçš„ä»£ç æ¨¡æ¿åŒ–ã€‚
æ›´å…·ä½“åœ°è¯´ï¼Œæ‚¨å°†ä¸ºä»£ç æä¾›è¯¥ç±»å‹çš„æ¨¡æ¿ç±»å‹å‚æ•°
æ•°æ®åŒ…æµçš„ã€‚åœ¨ç”Ÿäº§ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å®ä¾‹åŒ–æ‚¨çš„  æ¨¡æ¿
<code>ConcretePacketStream</code> ä½œä¸ºç±»å‹å‚æ•°ã€‚åœ¨æµ‹è¯•ä¸­ï¼Œæ‚¨å°†å®ä¾‹åŒ–
ä¸<code>MockPacketStream</code>ç›¸åŒçš„æ¨¡æ¿ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å†™ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">PacketStream</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">CreateConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PacketStream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">PacketStream</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">PacketReader</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ReadPackets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PacketStream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> stream</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size_t packet_num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç„¶åä½ å¯ä»¥ä½¿ç”¨<code>CreateConnection&lt;ConcretePacketStream&gt;()</code>å¹¶ä¸”
ç”Ÿäº§ä»£ç ä¸­çš„<code>PacketReader&lt;ConcretePacketStream&gt;</code>ï¼Œå¹¶ä½¿ç”¨
<code>CreateConnection&lt;MockPacketStream&gt;()</code> å’Œ <code>PacketReader&lt;MockPacketStream&gt;</code> ä¸­
æµ‹è¯•ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  MockPacketStream mock_stream</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_stream</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> set more expectations on mock_stream </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PacketReader</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">MockPacketStream</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">reader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">mock_stream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> exercise reader </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mocking-free-functions">æ¨¡æ‹Ÿå‡½æ•°<a href="#mocking-free-functions" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿå‡½æ•°" title="Direct link to æ¨¡æ‹Ÿå‡½æ•°">â€‹</a></h3>
<p>ä¸å¯èƒ½ç›´æ¥æ¨¡æ‹Ÿè‡ªç”±å‡½æ•°ï¼ˆå³ C é£æ ¼å‡½æ•°æˆ–
é™æ€æ–¹æ³•ï¼‰ã€‚å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥é‡å†™ä»£ç ä»¥ä½¿ç”¨æ¥å£
ï¼ˆæŠ½è±¡ç±»ï¼‰ã€‚</p>
<p>ä¸è¦ç›´æ¥è°ƒç”¨è‡ªç”±å‡½æ•°ï¼ˆä¾‹å¦‚<code>OpenFile</code>ï¼‰ï¼Œè€Œæ˜¯å¼•å…¥ä¸€ä¸ª
å®ƒçš„æ¥å£ï¼Œå¹¶æœ‰ä¸€ä¸ªè°ƒç”¨ <code>free</code> å‡½æ•°çš„å…·ä½“å­ç±»ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">FileInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">File</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">FileInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">OpenFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨çš„ä»£ç åº”è¯¥ä¸<code>FileInterface</code>å¯¹è¯ä»¥æ‰“å¼€æ–‡ä»¶ã€‚ç°åœ¨å¾ˆå®¹æ˜“å˜²ç¬‘
å‡ºå‡½æ•°ã€‚</p>
<p>è¿™çœ‹èµ·æ¥ä¼¼ä¹å¾ˆéº»çƒ¦ï¼Œä½†å®é™…ä¸Šä½ ç»å¸¸ä¼šé‡åˆ°å¤šä¸ªé—®é¢˜æ‚¨å¯ä»¥å°†ç›¸å…³å‡½æ•°æ”¾å…¥åŒä¸€ç•Œé¢ä¸­ï¼Œå› æ­¤æ¯ä¸ªå‡½æ•°
è¯­æ³•å¼€é”€ä¼šä½å¾—å¤šã€‚</p>
<p>å¦‚æœæ‚¨æ‹…å¿ƒè™šæ‹ŸåŒ–å¸¦æ¥çš„æ€§èƒ½å¼€é”€åŠŸèƒ½ï¼Œå¹¶ä¸”åˆ†æè¯å®äº†æ‚¨çš„æ‹…å¿§ï¼Œæ‚¨å¯ä»¥å°†å…¶ä¸
<a href="#MockingNonVirtualMethods">æ¨¡æ‹Ÿéè™šæ‹Ÿæ–¹æ³•</a> çš„é…æ–¹ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="NiceStrictNaggy">å–„è‰¯ã€ä¸¥æ ¼å’Œæ— è¶£çš„è°ƒç”¨<a href="#NiceStrictNaggy" class="hash-link" aria-label="Direct link to å–„è‰¯ã€ä¸¥æ ¼å’Œæ— è¶£çš„è°ƒç”¨" title="Direct link to å–„è‰¯ã€ä¸¥æ ¼å’Œæ— è¶£çš„è°ƒç”¨">â€‹</a></h3>
<p>å¦‚æœæ¨¡æ‹Ÿæ–¹æ³•æ²¡æœ‰<code>EXPECT_CALL</code>è§„èŒƒä½†è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬è¯´å®ƒæ˜¯ä¸€ä¸ª
â€œæ— è¶£çš„è°ƒç”¨â€ï¼Œä»¥åŠé»˜è®¤æ“ä½œï¼ˆå¯ä»¥ä½¿ç”¨æŒ‡å®š
å°†é‡‡ç”¨è¯¥æ–¹æ³•çš„<code>ON_CALL()</code>)ã€‚ç›®å‰ï¼Œä¸€ä¸ªæ— è¶£çš„å‘¼å«å°†
é»˜è®¤æƒ…å†µä¸‹ä¹Ÿä¼šå¯¼è‡´ kMock æ‰“å°è­¦å‘Šã€‚</p>
<p>ç„¶è€Œï¼Œæœ‰æ—¶æ‚¨å¯èƒ½æƒ³å¿½ç•¥è¿™äº›æ— è¶£çš„è°ƒç”¨ï¼Œå¹¶ä¸”
æœ‰æ—¶æ‚¨å¯èƒ½æƒ³å°†å®ƒä»¬è§†ä¸ºé”™è¯¯ã€‚ kMock è®©æ‚¨åšå‡ºå†³å®š
åŸºäºæ¯ä¸ªæ¨¡æ‹Ÿå¯¹è±¡ã€‚</p>
<p>å‡è®¾æ‚¨çš„æµ‹è¯•ä½¿ç”¨æ¨¡æ‹Ÿç±»<code>MockFoo</code>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo mock_foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> code that uses mock_foo </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœè°ƒç”¨ <code>DoThis()</code> ä¹‹å¤–çš„ <code>mock_foo</code> æ–¹æ³•ï¼Œæ‚¨å°†å¾—åˆ°ä¸€ä¸ª
è­¦å‘Šã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨é‡å†™æµ‹è¯•ä»¥ä½¿ç”¨ <code>NiceMock&lt;MockFoo&gt;</code> ä»£æ›¿ï¼Œ
æ‚¨å¯ä»¥æŠ‘åˆ¶è­¦å‘Šï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">NiceMock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NiceMock</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">MockFoo</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> mock_foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> code that uses mock_foo </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>NiceMock&lt;MockFoo&gt;</code> æ˜¯ <code>MockFoo</code> çš„å­ç±»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨
<code>MockFoo</code> è¢«æ¥å—ã€‚</p>
<p>å¦‚æœ <code>MockFoo</code> çš„æ„é€ å‡½æ•°æ¥å—ä¸€äº›å‚æ•°ï¼Œå®ƒä¹Ÿå¯ä»¥å·¥ä½œï¼Œå¦‚
<code>NiceMock&lt;MockFoo&gt;</code> â€œç»§æ‰¿â€ <code>MockFoo</code> çš„æ„é€ å‡½æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">NiceMock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NiceMock</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">MockFoo</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">mock_foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;hi&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Calls MockFoo(5, &quot;hi&quot;).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> code that uses mock_foo </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>StrictMock</code> çš„ç”¨æ³•ç±»ä¼¼ï¼Œåªä¸è¿‡å®ƒè®©ä¸€åˆ‡å˜å¾—æ— è¶£
è°ƒç”¨å¤±è´¥ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">StrictMock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  StrictMock</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">MockFoo</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> mock_foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> code that uses mock_foo </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The test will fail if a method of mock_foo other than DoThis()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// is called.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>æ³¨æ„ï¼š<code>NiceMock</code>å’Œ<code>StrictMock</code>ä»…å½±å“<em>æ— è¶£çš„</em>è°ƒç”¨ï¼ˆ
<em>æ–¹æ³•</em>æ²¡æœ‰ä»»ä½•æœŸæœ›ï¼‰ï¼›å®ƒä»¬ä¸ä¼šå½±å“<em>æ„å¤–</em>è°ƒç”¨ï¼ˆ
æ–¹æ³•ç¬¦åˆé¢„æœŸï¼Œä½†å®ƒä»¬ä¸åŒ¹é…ï¼‰ã€‚çœ‹
<a href="#uninteresting-vs-unexpected">äº†è§£æ— è¶£ä¸æ„å¤–çš„å‘¼å«</a>ã€‚</p></div></div>
<p>ä½†æœ‰ä¸€äº›è­¦å‘Šï¼ˆé—æ†¾çš„æ˜¯å®ƒä»¬æ˜¯ C++ çš„å‰¯ä½œç”¨ï¼‰
é™åˆ¶ï¼‰ï¼š</p>
<ol>
<li><code>NiceMock&lt;MockFoo&gt;</code> å’Œ <code>StrictMock&lt;MockFoo&gt;</code> ä»…é€‚ç”¨äºæ¨¡æ‹Ÿæ–¹æ³•
<strong>ç›´æ¥</strong>åœ¨<code>MockFoo</code>ç±»ä¸­ä½¿ç”¨<code>MOCK_METHOD</code>å®å®šä¹‰ã€‚
å¦‚æœåœ¨ <code>MockFoo</code> çš„ <strong>åŸºç±»</strong> ä¸­å®šä¹‰äº†æ¨¡æ‹Ÿæ–¹æ³•ï¼Œåˆ™â€œniceâ€æˆ–
â€œstrictâ€ä¿®é¥°ç¬¦å¯èƒ½ä¸ä¼šå½±å“å®ƒï¼Œå…·ä½“å–å†³äºç¼–è¯‘å™¨ã€‚åœ¨
ç‰¹åˆ«æ˜¯ï¼ŒåµŒå¥—â€œNiceMockâ€å’Œâ€œStrictMockâ€ï¼ˆä¾‹å¦‚
<strong>ä¸</strong>æ”¯æŒ <code>NiceMock&lt;StrictMock&lt;MockFoo&gt; &gt;</code>)ã€‚</li>
<li><code>NiceMock&lt;MockFoo&gt;</code> å’Œ <code>StrictMock&lt;MockFoo&gt;</code> å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå¦‚æœ
<code>MockFoo</code> çš„ææ„å‡½æ•°ä¸æ˜¯è™šæ‹Ÿçš„ã€‚æˆ‘ä»¬æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯
éœ€è¦æ¸…ç†ç°æœ‰çš„æµ‹è¯•ã€‚</li>
</ol>
<p>æœ€åï¼Œæ‚¨åº”è¯¥<strong>éå¸¸è°¨æ…</strong>ä½•æ—¶ä½¿ç”¨ naggy æˆ– strict
æ¨¡æ‹Ÿï¼Œå› ä¸ºå®ƒä»¬å¾€å¾€ä¼šä½¿æµ‹è¯•å˜å¾—æ›´è„†å¼±ä¸”æ›´éš¾ä»¥ç»´æŠ¤ã€‚å½“ä½ 
é‡æ„æ‚¨çš„ä»£ç è€Œä¸æ”¹å˜å…¶å¤–éƒ¨å¯è§çš„è¡Œä¸ºï¼Œç†æƒ³æƒ…å†µä¸‹æ‚¨
ä¸éœ€è¦æ›´æ–°ä»»ä½•æµ‹è¯•ã€‚å¦‚æœä½ çš„ä»£ç ä¸çƒ¦äººçš„æ¨¡æ‹Ÿäº¤äº’ï¼Œ
ä½†æ˜¯ï¼Œç”±äºæ‚¨çš„æ“ä½œï¼Œæ‚¨å¯èƒ½ä¼šå¼€å§‹æ”¶åˆ°è­¦å‘Šåƒåœ¾é‚®ä»¶
æ”¹å˜ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœæ‚¨çš„ä»£ç ä¸ä¸¥æ ¼çš„æ¨¡æ‹Ÿäº¤äº’ï¼Œæ‚¨çš„æµ‹è¯•å¯èƒ½ä¼šå¼€å§‹
å¤±è´¥ï¼Œä½ å°†è¢«è¿«ä¿®å¤å®ƒä»¬ã€‚æˆ‘ä»¬çš„ä¸€èˆ¬å»ºè®®æ˜¯ä½¿ç”¨
æ¼‚äº®çš„æ¨¡æ‹Ÿï¼ˆè¿˜ä¸æ˜¯é»˜è®¤çš„ï¼‰å¤§å¤šæ•°æ—¶å€™ï¼Œä½¿ç”¨ naggy æ¨¡æ‹Ÿï¼ˆå½“å‰çš„
é»˜è®¤ï¼‰åœ¨å¼€å‘æˆ–è°ƒè¯•æµ‹è¯•æ—¶ï¼Œå¹¶ä¸”ä»…ä½¿ç”¨ä¸¥æ ¼  æ¨¡æ‹Ÿä½œä¸º
æœ€åçš„æ‰‹æ®µã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="SimplerInterfaces">ç®€åŒ–ç•Œé¢è€Œä¸ç ´åç°æœ‰ä»£ç <a href="#SimplerInterfaces" class="hash-link" aria-label="Direct link to ç®€åŒ–ç•Œé¢è€Œä¸ç ´åç°æœ‰ä»£ç " title="Direct link to ç®€åŒ–ç•Œé¢è€Œä¸ç ´åç°æœ‰ä»£ç ">â€‹</a></h3>
<p>Sometimes a method has a long list of arguments that is mostly uninteresting.
For example:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">LogSink</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LogSeverity severity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> full_filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> base_filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">struct</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">tm</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> tm_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size_t message_len</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å¾ˆé•¿ä¸”éš¾ä»¥ä½¿ç”¨ï¼ˆ<code>message</code>
å‚æ•°ç”šè‡³ä¸æ˜¯ 0 ç»ˆæ­¢çš„ï¼‰ã€‚å¦‚æœæˆ‘ä»¬æŒ‰åŸæ ·æ¨¡æ‹Ÿå®ƒï¼Œåˆ™ä½¿ç”¨æ¨¡æ‹Ÿå°†æ˜¯
å°´å°¬çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ç®€åŒ–æ­¤ç•Œé¢ï¼Œåˆ™éœ€è¦ä¿®å¤æ‰€æœ‰é—®é¢˜
å®¢æˆ·ä¾èµ–å®ƒï¼Œè¿™é€šå¸¸æ˜¯ä¸å¯è¡Œçš„ã€‚</p>
<p>è¯€çªæ˜¯é‡æ–°è°ƒåº¦æ¨¡æ‹Ÿç±»ä¸­çš„æ–¹æ³•ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ScopedMockLog</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">LogSink</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LogSeverity severity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> full_filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> base_filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> tm</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> tm_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size_t message_len</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// We are only interested in the log severity, full file name, and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// log message.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">severity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> full_filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message_len</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Implements the mock method:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">//   void Log(LogSeverity severity,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">//            const string&amp; file_path,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">//            const string&amp; message);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LogSeverity severity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é€šè¿‡ä½¿ç”¨ä¿®å‰ªè¿‡çš„å‚æ•°åˆ—è¡¨å®šä¹‰ä¸€ä¸ªæ–°çš„æ¨¡æ‹Ÿæ–¹æ³•ï¼Œæˆ‘ä»¬ä½¿æ¨¡æ‹Ÿ
ç±»æ›´åŠ äººæ€§åŒ–ã€‚</p>
<p>è¯¥æŠ€æœ¯ä¹Ÿå¯ç”¨äºä½¿é‡è½½æ–¹æ³•æ›´é€‚åˆ
å˜²ç¬‘ã€‚ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨é‡è½½æ¥å®ç°é»˜è®¤å€¼æ—¶
è®ºç‚¹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockTurtleFactory</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">TurtleFactory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Turtle</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeTurtle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> weight</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Turtle</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeTurtle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> weight</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> speed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// the above methods delegate to this one:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Turtle</span><span class="token operator" style="color:#D73A49">*</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoMakeTurtle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™å…è®¸ä¸å…³å¿ƒè°ƒç”¨å“ªä¸ªé‡è½½çš„æµ‹è¯•æ¥é¿å…æŒ‡å®š
å‚æ•°åŒ¹é…å™¨ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">factory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoMakeTurtle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">MakeMockTurtle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="alternative-to-mocking-concrete-classes">æ¨¡æ‹Ÿå…·ä½“ç±»çš„æ›¿ä»£æ–¹æ¡ˆ<a href="#alternative-to-mocking-concrete-classes" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿå…·ä½“ç±»çš„æ›¿ä»£æ–¹æ¡ˆ" title="Direct link to æ¨¡æ‹Ÿå…·ä½“ç±»çš„æ›¿ä»£æ–¹æ¡ˆ">â€‹</a></h3>
<p>é€šå¸¸ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°è‡ªå·±ä½¿ç”¨ä¸å®ç°æ¥å£çš„ç±»ã€‚åœ¨
ä¸ºäº†æµ‹è¯•ä½¿ç”¨æ­¤ç±»çš„ä»£ç ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º<code>Concrete</code>ï¼‰ï¼Œæ‚¨
å¯èƒ½ä¼šæƒ³å°† <code>Concrete</code> çš„æ–¹æ³•è™šæ‹ŸåŒ–ï¼Œç„¶åæ¨¡æ‹Ÿå®ƒã€‚</p>
<p>å°½é‡ä¸è¦è¿™æ ·åšã€‚</p>
<p>å°†éè™šæ‹Ÿå‡½æ•°è®¾ä¸ºè™šæ‹Ÿæ˜¯ä¸€ä¸ªé‡å¤§å†³å®šã€‚å®ƒåˆ›å»ºäº†ä¸€ä¸ªæ‰©å±•
å­ç±»å¯ä»¥è°ƒæ•´ç±»çš„è¡Œä¸ºã€‚è¿™ä¼šå‰Šå¼±ä½ çš„æ§åˆ¶åŠ›
åœ¨ç±»ä¸Šï¼Œå› ä¸ºç°åœ¨ç»´æŠ¤ç±»ä¸å˜é‡å˜å¾—æ›´åŠ å›°éš¾ã€‚ä½ 
ä»…å½“æœ‰æ­£å½“ç†ç”±éœ€è¦å­ç±»æ—¶æ‰åº”å°†å‡½ æ•°è®¾ä¸ºè™šæ‹Ÿ
è¦†ç›–å®ƒã€‚</p>
<p>ç›´æ¥æ¨¡æ‹Ÿå…·ä½“ç±»æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºå®ƒä¼šäº§ç”Ÿç´§å¯†è€¦åˆ
åœ¨è¯¾å ‚å’Œæµ‹è¯•ä¹‹é—´ - è¯¾å ‚ä¸Šçš„ä»»ä½•å¾®å°å˜åŒ–éƒ½å¯èƒ½æ— æ•ˆ
æ‚¨çš„æµ‹è¯•å¹¶ä½¿æµ‹è¯•ç»´æŠ¤å˜å¾—ç—›è‹¦ã€‚</p>
<p>ä¸ºäº†é¿å…æ­¤ç±»é—®é¢˜ï¼Œè®¸å¤šç¨‹åºå‘˜ä¸€ç›´åœ¨ç»ƒä¹ <code>ç¼–ç åˆ° æ¥å£(&quot;coding to interfaces&quot;)</code>ï¼šæ‚¨çš„ä»£ç å°†å®šä¹‰è€Œä¸æ˜¯ä¸<code>Concrete</code>ç±»å¯¹è¯
ä¸€ä¸ªç•Œé¢å¹¶ä¸ä¹‹äº¤è°ˆã€‚ç„¶åä½ å°†è¯¥æ¥å£å®ç°ä¸ºé€‚é…å™¨
<code>Concrete</code>çš„é¡¶éƒ¨ã€‚åœ¨æµ‹è¯•ä¸­ï¼Œæ‚¨å¯ä»¥è½»æ¾æ¨¡æ‹Ÿè¯¥ç•Œé¢ä»¥è§‚å¯Ÿå¦‚ä½•
ä½ çš„ä»£ç æ­£åœ¨åšã€‚</p>
<p>è¿™ç§æŠ€æœ¯ä¼šäº§ç”Ÿä¸€äº›å¼€é”€ï¼š</p>
<ul>
<li>æ‚¨æ”¯ä»˜è™šå‡½æ•°è°ƒç”¨çš„æˆæœ¬ï¼ˆé€šå¸¸ä¸æ˜¯é—®é¢˜ï¼‰ã€‚</li>
<li>æœ‰æ›´å¤šçš„æŠ½è±¡å¯ä¾›ç¨‹åºå‘˜å­¦ä¹ ã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œé™¤äº†æ›´å¥½çš„æ•ˆæœä¹‹å¤–ï¼Œå®ƒè¿˜å¯ä»¥å¸¦æ¥æ˜¾ç€çš„å¥½å¤„ã€‚
å¯æµ‹è¯•æ€§ï¼š</p>
<ul>
<li><code>Concrete</code> çš„ API å¯èƒ½ä¸å¤ªé€‚åˆæ‚¨çš„é—®é¢˜é¢†åŸŸï¼Œå› ä¸ºæ‚¨å¯èƒ½ä¸é€‚åˆ
æˆä¸ºå®ƒè¯•å›¾æœåŠ¡çš„å”¯ä¸€å®¢æˆ·ã€‚é€šè¿‡è®¾è®¡è‡ªå·±çš„ç•Œé¢ï¼Œæ‚¨
æœ‰æœºä¼šæ ¹æ®æ‚¨çš„éœ€è¦å®šåˆ¶å®ƒ - æ‚¨å¯ä»¥æ·»åŠ æ›´é«˜çº§åˆ«çš„
åŠŸèƒ½ã€é‡å‘½åç­‰ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¿®å‰ªç±»ã€‚è¿™
å…è®¸æ‚¨ä»¥æ›´è‡ªç„¶çš„æ–¹å¼ç¼–å†™ä»£ç ï¼ˆç•Œé¢çš„ç”¨æˆ·ï¼‰ï¼Œ
è¿™æ„å‘³ç€å®ƒå°†æ›´å…·å¯è¯»æ€§ï¼Œæ›´æ˜“äºç»´æŠ¤ï¼Œå¹¶ä¸”æ‚¨ä¼šæ›´å®¹æ˜“
å¯Œæœ‰æˆæ•ˆã€‚</li>
<li>å¦‚æœ <code>Concrete</code> çš„å®ç°éœ€è¦æ”¹å˜ï¼Œä½ ä¸å¿…é‡å†™
å®ƒæ— å¤„ä¸åœ¨ã€‚ç›¸åï¼Œä½ å¯ä»¥å¸æ”¶ä½ çš„å˜åŒ–
æ¥å£çš„å®ç°ï¼Œä»¥åŠæ‚¨çš„å…¶ä»–ä»£ç å’Œæµ‹è¯•å°†æ˜¯
å…å—è¿™ç§å˜åŒ–çš„å½±å“ã€‚</li>
</ul>
<p>æœ‰äººæ‹…å¿ƒï¼Œå¦‚æœæ¯ä¸ªäººéƒ½ç»ƒä¹ è¿™ç§æŠ€æœ¯ï¼Œä»–ä»¬å°±ä¼šç»“æŸ
å†™äº†å¾ˆå¤šå†—ä½™ä»£ç ã€‚è¿™ç§æ‹…å¿§æ˜¯å®Œå…¨å¯ä»¥ç†è§£çš„ã€‚
ç„¶è€Œï¼Œæœ‰ä¸¤ä¸ªåŸå› å¯èƒ½å¯¼è‡´æƒ…å†µå¹¶éå¦‚æ­¤ï¼š</p>
<ul>
<li>ä¸åŒçš„é¡¹ç›®å¯èƒ½éœ€è¦ä»¥ä¸åŒçš„æ–¹å¼ä½¿ç”¨<code>Concrete</code>ï¼Œæ‰€ä»¥æœ€å¥½
ä»–ä»¬çš„ç•Œé¢ä¼šæœ‰æ‰€ä¸åŒã€‚å› æ­¤ï¼Œä»–ä»¬æ¯ä¸ªäººéƒ½ä¼šæœ‰è‡ªå·±çš„
åœ¨â€œConcreteâ€ä¹‹ä¸Šæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šäºé¢†åŸŸçš„æ¥å£ï¼Œå¹¶ä¸”å®ƒä»¬ä¸ä¼šæ˜¯
  ç›¸åŒçš„ä»£ç ã€‚</li>
<li>å¦‚æœæœ‰è¶³å¤Ÿå¤šçš„é¡¹ç›®æƒ³è¦ä½¿ç”¨ç›¸åŒçš„æ¥å£ï¼Œä»–ä»¬æ€»æ˜¯å¯ä»¥å…±äº«å®ƒï¼Œ
å°±åƒä»–ä»¬ä¸€ç›´åœ¨åˆ†äº«â€œæ··å‡åœŸâ€ä¸€æ ·ã€‚æ‚¨å¯ä»¥åœ¨ç•Œé¢ä¸­æŸ¥çœ‹
é€‚é…å™¨ä½äº <code>Concrete</code> é™„è¿‘ï¼ˆå¯èƒ½åœ¨ <code>contrib</code> ä¸­ï¼‰
å­ç›®å½•ï¼‰å¹¶è®©è®¸å¤šé¡¹ç›®ä½¿ç”¨å®ƒã€‚</li>
</ul>
<p>æ‚¨éœ€è¦é’ˆå¯¹æ‚¨çš„ç‰¹å®šé—®é¢˜ä»”ç»†æƒè¡¡åˆ©å¼Šï¼Œä½†æ˜¯
æˆ‘æƒ³å‘æ‚¨ä¿è¯ï¼ŒJava ç¤¾åŒºå·²ç»å®è·µè¿™ä¸€ç‚¹å¾ˆä¹…äº†
ç»è¿‡å¾ˆé•¿æ—¶é—´çš„è€ƒéªŒï¼Œè¿™æ˜¯ä¸€ç§è¡Œä¹‹æœ‰æ•ˆçš„æŠ€æœ¯ï¼Œé€‚ç”¨äºå¤šç§é¢†åŸŸ
æƒ…å†µã€‚ :-)</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="DelegatingToFake">å°†å‘¼å«å§”æ‰˜ç»™fake<a href="#DelegatingToFake" class="hash-link" aria-label="Direct link to å°†å‘¼å«å§”æ‰˜ç»™fake" title="Direct link to å°†å‘¼å«å§”æ‰˜ç»™fake">â€‹</a></h3>
<p>æœ‰æ—¶ï¼Œæ‚¨æœ‰ä¸€ä¸ªä¸å¹³å‡¡çš„å‡æ¥å£å®ç°ã€‚ä¸ºäº†
ä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">FakeFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">char</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> </span><span class="token char">&#x27;+&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> </span><span class="token char">&#x27;-&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token char">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">p </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç°åœ¨æ‚¨æƒ³è¦æ¨¡æ‹Ÿæ­¤æ¥å£ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å¯¹å…¶è®¾ç½®æœŸæœ›ã€‚
ä½†æ˜¯ï¼Œæ‚¨è¿˜æƒ³ä½¿ç”¨ <code>FakeFoo</code> ä½œä¸ºé»˜è®¤è¡Œä¸ºï¼Œå› ä¸ºå¤åˆ¶
å®ƒåœ¨æ¨¡æ‹Ÿå¯¹è±¡ä¸­æ˜¯ï¼Œå—¯ï¼Œå¾ˆå¤šå·¥ä½œã€‚</p>
<p>å½“æ‚¨ä½¿ç”¨ kMock å®šä¹‰æ¨¡æ‹Ÿç±»æ—¶ï¼Œæ‚¨å¯ä»¥è®©å®ƒå§”æ‰˜å…¶é»˜è®¤å€¼
ä½¿ç”¨ä»¥ä¸‹æ¨¡å¼å¯¹æ‚¨å·²ç»æ‹¥æœ‰çš„å‡ç±»æ‰§è¡Œæ“ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Normal mock method definitions using kMock.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">char</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Delegates the default actions of the methods to a FakeFoo object.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This must be called *before* the custom ON_CALL() statements.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DelegateToFake</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> fake_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      fake_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">private</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FakeFoo fake_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Keeps an instance of the fake in the mock.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™æ ·ï¼Œæ‚¨å°±å¯ä»¥åƒå¾€å¸¸ä¸€æ ·åœ¨æµ‹è¯•ä¸­ä½¿ç”¨<code>MockFoo</code>äº†ã€‚åªè¦è®°ä½ï¼Œå¦‚æœ
æ‚¨æ²¡æœ‰åœ¨<code>ON_CALL()</code>æˆ–<code>EXPECT_CALL()</code>ä¸­æ˜¾å¼è®¾ç½®æ“ä½œï¼Œ
å‡è´§å°†è¢«è¦æ±‚è¿™æ ·åšï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AbcTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Xyz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DelegateToFake</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Enables the fake for delegation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Put your ON_CALL(foo, ...)s here, if any.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// No action specified, meaning to use the default action.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;+&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// FakeFoo::DoThis() is invoked.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Hi&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// FakeFoo::DoThat() is invoked.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ä¸€äº›æç¤ºï¼š</strong></p>
<ul>
<li>
<p>å¦‚æœéœ€è¦ï¼Œæ‚¨ä»ç„¶å¯ä»¥é€šè¿‡æä¾›è‡ªå·±çš„æ“ä½œæ¥è¦†ç›–é»˜è®¤æ“ä½œ
<code>ON_CALL()</code> æˆ–åœ¨ <code>EXPECT_CALL()</code> ä¸­ä½¿ç”¨ <code>.WillOnce()</code> / <code>.WillRepeatedly()</code>ã€‚</p>
</li>
<li>
<p>åœ¨<code>DelegateToFake()</code>ä¸­ï¼Œåªéœ€è¦å§”æ‰˜é‚£äº›fakeçš„æ–¹æ³•
æ‚¨æ‰“ç®—ä½¿ç”¨çš„å®ç°ã€‚</p>
</li>
<li>
<p>è¿™é‡Œè®¨è®ºçš„ä¸€èˆ¬æŠ€æœ¯é€‚ç”¨äºé‡è½½æ–¹æ³•ï¼Œä½†æ˜¯
æ‚¨éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨æ‚¨æŒ‡çš„æ˜¯å“ªä¸ªç‰ˆæœ¬ã€‚ä¸ºäº†æ¶ˆé™¤æ­§ä¹‰
æ¨¡æ‹Ÿå‡½æ•°ï¼ˆæ‚¨åœ¨<code>ON_CALL()</code>æ‹¬å·å†…æŒ‡å®šçš„å‡½æ•°ï¼‰ï¼Œ
ä½¿ç”¨<a href="#SelectOverload">æ­¤æŠ€æœ¯</a>ï¼›æ¶ˆé™¤ä¼ªå‡½æ•°çš„æ­§ä¹‰ï¼ˆ
æ”¾ç½®åœ¨ <code>Invoke()</code> ä¸­çš„ä¸€ä¸ªï¼‰ï¼Œä½¿ç”¨ <code>static_cast</code> æ¥æŒ‡å®š
å‡½æ•°çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç±» <code>Foo</code> æœ‰æ–¹æ³• <code>char DoThis(int n)</code> å’Œ <code>bool DoThis(double x) const</code>ï¼Œå¹¶ä¸”æ‚¨æƒ³è°ƒç”¨åè€…ï¼Œ
ä½ éœ€è¦å†™<code>Invoke(&amp;fake_, static_cast&lt;bool (FakeFoo::*)(double) const&gt;(&amp;FakeFoo::DoThis))</code> è€Œä¸æ˜¯ <code>Invoke(&amp;fake_, &amp;FakeFoo::DoThis)</code>
ï¼ˆ<code>static_cast</code> å°–æ‹¬å·å†…çœ‹èµ·æ¥å¥‡æ€ªçš„ä¸œè¥¿æ˜¯
æŒ‡å‘ç¬¬äºŒä¸ª <code>DoThis()</code> æ–¹æ³•çš„å‡½æ•°æŒ‡é’ˆçš„ç±»å‹ã€‚ï¼‰ã€‚</p>
</li>
<li>
<p>å¿…é¡»æ··åˆæ¨¡æ‹Ÿå’Œå‡é€šå¸¸æ˜¯å‡ºç°é—®é¢˜çš„è¿¹è±¡ã€‚
ä¹Ÿè®¸æ‚¨è¿˜æ²¡æœ‰ä¹ æƒ¯åŸºäºäº¤äº’çš„æµ‹è¯•æ–¹å¼ã€‚æˆ–è€…
ä¹Ÿè®¸ä½ çš„ç•Œé¢æ‰¿æ‹…äº†å¤ªå¤šçš„è§’è‰²ï¼Œåº”è¯¥åˆ†å¼€ã€‚
å› æ­¤ï¼Œ<strong>ä¸è¦æ»¥ç”¨è¿™ä¸ª</strong>ã€‚æˆ‘ä»¬åªå»ºè®®å°†å…¶ä½œä¸º
é‡æ„ä»£ç æ—¶çš„ä¸­é—´æ­¥éª¤ã€‚</p>
</li>
</ul>
<p>å…³äºæ··åˆæ¨¡æ‹Ÿå’Œå‡çš„æŠ€å·§ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­è¯´æ˜ä¸ºä»€ä¹ˆå®ƒå¯èƒ½
è¿™æ˜¯ä¸€ä¸ªåå…†å¤´ï¼šå‡è®¾ä½ æœ‰ä¸€ä¸ªç”¨äºä½çº§ç³»ç»Ÿçš„ç±»<code>System</code>
è¿è¥ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒæ‰§è¡Œæ–‡ä»¶å’Œ I/O æ“ä½œã€‚å‡è®¾ä½ æƒ³è¦
æµ‹è¯•ä½ çš„ä»£ç å¦‚ä½•ä½¿ç”¨<code>System</code>è¿›è¡Œ I/Oï¼Œè€Œä½ åªéœ€è¦è¯¥æ–‡ä»¶
æ“ä½œæ‰èƒ½æ­£å¸¸è¿›è¡Œã€‚å¦‚æœä½ æ¨¡æ‹Ÿæ•´ä¸ª<code>System</code>ç±»ï¼Œä½ ä¼š
å¿…é¡»ä¸ºæ–‡ä»¶æ“ä½œéƒ¨åˆ†æä¾›ä¸€ä¸ªå‡çš„å®ç°ï¼Œ
è¡¨æ˜â€œSystemâ€æ‰®æ¼”äº†å¤ªå¤šè§’è‰²ã€‚</p>
<p>ç›¸åï¼Œæ‚¨å¯ä»¥å®šä¹‰ä¸€ä¸ª<code>FileOps</code>æ¥å£å’Œä¸€ä¸ª<code>IOOps</code>æ¥å£ï¼Œå¹¶å°†<code>System</code>çš„åŠŸèƒ½æ‹†åˆ†ä¸ºä¸¤ä¸ªæ¥å£ã€‚ç„¶åä½ å¯ä»¥æ¨¡æ‹Ÿ<code>IOOps</code>è€Œä¸æ¨¡æ‹Ÿ<code>FileOps</code>ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å°†è°ƒç”¨å§”æ‰˜ç»™çœŸå®å¯¹è±¡">å°†è°ƒç”¨å§”æ‰˜ç»™çœŸå®å¯¹è±¡<a href="#å°†è°ƒç”¨å§”æ‰˜ç»™çœŸå®å¯¹è±¡" class="hash-link" aria-label="Direct link to å°†è°ƒç”¨å§”æ‰˜ç»™çœŸå®å¯¹è±¡" title="Direct link to å°†è°ƒç”¨å§”æ‰˜ç»™çœŸå®å¯¹è±¡">â€‹</a></h3>
<p>å½“ä½¿ç”¨æµ‹è¯•æ›¿èº«ï¼ˆmocksã€fakesã€stubs ç­‰ï¼‰æ—¶ï¼Œæœ‰æ—¶ä»–ä»¬çš„
è¡Œä¸ºå°†ä¸çœŸå®å¯¹è±¡çš„è¡Œä¸ºæœ‰æ‰€ä¸åŒã€‚è¿™ä¸ªå·®å¼‚å¯èƒ½æ˜¯
è¦ä¹ˆæ˜¯æ•…æ„çš„ï¼ˆä¾‹å¦‚æ¨¡æ‹Ÿé”™è¯¯ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥æµ‹è¯•é”™è¯¯
å¤„  ç†ä»£ç ï¼‰æˆ–æ— æ„çš„ã€‚å¦‚æœä½ çš„æ¨¡æ‹Ÿæœ‰ä¸åŒçš„è¡Œä¸º
å¦‚æœé”™è¯¯åœ°ä½¿ç”¨çœŸå®çš„å¯¹è±¡ï¼Œæ‚¨æœ€ç»ˆå¯èƒ½ä¼šå¾—åˆ°é€šè¿‡æµ‹è¯•çš„ä»£ç ï¼Œä½†æ˜¯
ç”Ÿäº§å¤±è´¥ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ <em>delegating-to-real</em> æŠ€æœ¯æ¥ç¡®ä¿æ‚¨çš„æ¨¡æ‹Ÿå…·æœ‰
ä¸çœŸå®å¯¹è±¡å…·æœ‰ç›¸åŒçš„è¡Œä¸ºï¼ŒåŒæ—¶ä¿ç•™éªŒè¯è°ƒç”¨çš„èƒ½åŠ›ã€‚
è¿™ç§æŠ€æœ¯ä¸ <a href="#DelegatingToFake">delegating-to-fake</a> éå¸¸ç›¸ä¼¼
æŠ€æœ¯ï¼Œä¸åŒä¹‹å¤„åœ¨äºæˆ‘ä»¬ä½¿ç”¨çœŸå®çš„ç‰©ä½“è€Œä¸æ˜¯å‡çš„ã€‚
è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AtLeast</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MockFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// By default, all calls are delegated to the real object.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> real_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#CF222E">this</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      real_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">char</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">private</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Foo real_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo mock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Hi&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AtLeast</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> use mock in test </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™æ ·ï¼ŒkMock å°†éªŒè¯æ‚¨çš„ä»£ç æ˜¯å¦è¿›è¡Œäº†æ­£ç¡®çš„è°ƒç”¨ï¼ˆä½¿ç”¨æ­£ç¡®çš„
å‚æ•°ï¼Œä»¥æ­£ç¡®çš„é¡ºåºï¼Œè°ƒç”¨æ­£ç¡®çš„æ¬¡æ•°ç­‰ï¼‰ï¼Œä»¥åŠ
çœŸå®å¯¹è±¡å°†åº”ç­”è°ƒç”¨ï¼ˆå› æ­¤è¡Œä¸ºå°†ä¸
ç”Ÿäº§ï¼‰ã€‚è¿™è®©æ‚¨ä¸¤å…¨å…¶ç¾ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="delegating-calls-to-a-parent-class">å°†è°ƒç”¨å§”æ‰˜ç»™çˆ¶ç±»<a href="#delegating-calls-to-a-parent-class" class="hash-link" aria-label="Direct link to å°†è°ƒç”¨å§”æ‰˜ç»™çˆ¶ç±»" title="Direct link to å°†è°ƒç”¨å§”æ‰˜ç»™çˆ¶ç±»">â€‹</a></h3>
<p>ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥å¯¹æ¥å£è¿›è¡Œç¼–ç ï¼Œå…¶æ–¹æ³•éƒ½æ˜¯çº¯è™šæ‹Ÿçš„ã€‚åœ¨
ç°å®ä¸­ï¼Œæœ‰æ—¶ä½ ç¡®å®éœ€è¦æ¨¡æ‹Ÿä¸€ä¸ªä¸çº¯çš„è™šæ‹Ÿæ–¹æ³•ï¼ˆå³ï¼Œ
å®ƒå·²ç»æœ‰ä¸€ä¸ªå®ç°ï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Pure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Concrete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Mocking a pure method.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Pure</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Mocking a concrete method.  Foo::Concrete() is shadowed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Concrete</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æœ‰æ—¶ä½ å¯èƒ½æƒ³è°ƒç”¨ <code>Foo::Concrete()</code> è€Œä¸æ˜¯
<code>MockFoo::Concrete()</code>ã€‚ä¹Ÿè®¸æ‚¨æƒ³å°†å…¶ä½œä¸ºå­˜æ ¹æ“ä½œçš„ä¸€éƒ¨åˆ†æ¥æ‰§è¡Œï¼Œæˆ–è€…
ä¹Ÿè®¸ä½ çš„æµ‹è¯•æ ¹æœ¬ä¸éœ€è¦æ¨¡æ‹Ÿ <code>Concrete()</code> ï¼ˆä½†å®ƒä¼šæ˜¯
å“¦ï¼Œå½“ä½ ä¸éœ€è¦æ¨¡æ‹Ÿæ—¶ï¼Œå¿…é¡»å®šä¹‰ä¸€ä¸ªæ–°çš„æ¨¡æ‹Ÿç±»ï¼ŒçœŸæ˜¯å¤ªç—›è‹¦äº†
å…¶æ–¹æ³•ä¹‹ä¸€ï¼‰ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åœ¨æ“ä½œå†…è°ƒç”¨ <code>Foo::Concrete()</code>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Concrete</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name" style="color:#116329">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Concrete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ–è€…å‘Šè¯‰æ¨¡æ‹Ÿå¯¹è±¡æ‚¨ä¸æƒ³æ¨¡æ‹Ÿ <code>Concrete()</code>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Concrete</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name" style="color:#116329">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Concrete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ï¼ˆä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç›´æ¥å†™ <code>{ return foo.Concrete(str); }</code>ï¼Ÿå¦‚æœä½ è¿™æ ·åšï¼Œ
<code>MockFoo::Concrete()</code> å°†è¢«è°ƒç”¨ï¼ˆå¹¶å¯¼è‡´æ— é™é€’å½’ï¼‰ï¼Œå› ä¸º
<code>Foo::Concrete()</code> æ˜¯è™šæ‹Ÿçš„ã€‚è¿™å°±æ˜¯ C++ çš„å·¥ä½œåŸç†ã€‚ï¼‰</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-matchers">ä½¿ç”¨åŒ¹é…å™¨<a href="#using-matchers" class="hash-link" aria-label="Direct link to ä½¿ç”¨åŒ¹é…å™¨" title="Direct link to ä½¿ç”¨åŒ¹é…å™¨">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="matching-argument-values-exactly">ç²¾ç¡®åŒ¹é…å‚æ•°å€¼<a href="#matching-argument-values-exactly" class="hash-link" aria-label="Direct link to ç²¾ç¡®åŒ¹é…å‚æ•°å€¼" title="Direct link to ç²¾ç¡®åŒ¹é…å‚æ•°å€¼">â€‹</a></h3>
<p>æ‚¨å¯ä»¥å‡†ç¡®æŒ‡å®šæ¨¡æ‹Ÿæ–¹æ³•éœ€è¦å“ªäº›å‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Hello&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-simple-matchers">ä½¿ç”¨ç®€å•åŒ¹é…å™¨<a href="#using-simple-matchers" class="hash-link" aria-label="Direct link to ä½¿ç”¨ç®€å•åŒ¹é…å™¨" title="Direct link to ä½¿ç”¨ç®€å•åŒ¹é…å™¨">â€‹</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨åŒ¹é…å™¨æ¥åŒ¹é…å…·æœ‰ç‰¹å®šå±æ€§çš„å‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">NotNull</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Ge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The argument must be &gt;= 5.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Hello&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The second argument must not be NULL.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¸¸ç”¨çš„åŒ¹é…å™¨æ˜¯<code>_</code>ï¼Œå®ƒå¯ä»¥åŒ¹é…ä»»ä½•å†…å®¹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="CombiningMatchers">ç»„åˆåŒ¹é…å™¨<a href="#CombiningMatchers" class="hash-link" aria-label="Direct link to ç»„åˆåŒ¹é…å™¨" title="Direct link to ç»„åˆåŒ¹é…å™¨">â€‹</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨<code>AllOf()</code>ä»ç°æœ‰åŒ¹é…å™¨æ„å»ºå¤æ‚çš„åŒ¹é…å™¨ï¼Œ
<code>AllOfArray()</code>ã€<code>AnyOf()</code>ã€<code>AnyOfArray()</code> å’Œ <code>Not()</code>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AllOf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">HasSubstr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Ne</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Not</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The argument must be &gt; 5 and != 10.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AllOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Gt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token function" style="color:#8250DF">Ne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The first argument must not contain sub-string &quot;blah&quot;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Not</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">HasSubstr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;blah&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token constant" style="color:#005CC5">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŒ¹é…å™¨æ˜¯å‡½æ•°å¯¹è±¡ï¼Œå‚æ•°åŒ–åŒ¹é…å™¨å¯ä»¥ç›´æ¥ç»„æˆ
å°±åƒä»»ä½•å…¶ä»–åŠŸèƒ½ä¸€æ ·ã€‚ç„¶è€Œï¼Œå› ä¸ºå®ƒä»¬çš„ç±»å‹å¯èƒ½å¾ˆé•¿å¹¶ä¸”å¾ˆå°‘
æä¾›æœ‰æ„ä¹‰çš„ä¿¡æ¯ï¼Œç”¨C++14å¯ä»¥æ›´å®¹æ˜“åœ°è¡¨è¾¾å®ƒä»¬
æ³›å‹ lambda ä»¥é¿å…æŒ‡å®šç±»å‹ã€‚ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Contains</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Property</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">constexpr</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token plain"> HasFoo </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">auto</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Property</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">MyClass</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Contains</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">HasFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;blah&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="SafeMatcherCast">é€‰è§’åŒ¹é…å™¨<a href="#SafeMatcherCast" class="hash-link" aria-label="Direct link to é€‰è§’åŒ¹é…å™¨" title="Direct link to é€‰è§’åŒ¹é…å™¨">â€‹</a></h3>
<p>kMock åŒ¹é…å™¨æ˜¯é™æ€ç±»å‹çš„ï¼Œè¿™æ„å‘³ç€ç¼–è¯‘å™¨å¯ä»¥æ•è·æ‚¨çš„
å¦‚æœæ‚¨ä½¿ç”¨é”™è¯¯ç±»å‹çš„åŒ¹é…å™¨ï¼Œåˆ™ä¼šå‡ºé”™ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä½¿ç”¨<code>Eq(5)</code>
åŒ¹é…<code>string</code>å‚æ•°ï¼‰ã€‚å¯¹ä½ æœ‰å¥½å¤„ï¼</p>
<p>ç„¶è€Œï¼Œæœ‰æ—¶ï¼Œæ‚¨çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œå¹¶å¸Œæœ›ç¼–è¯‘å™¨ä¸ºæ‚¨æä¾›
æœ‰äº›æ‡ˆæ€ ã€‚ä¸€ä¸ªä¾‹å­æ˜¯ä½ æœ‰ä¸€ä¸ªâ€œlongâ€åŒ¹é…å™¨å’Œå‚æ•°
ä½ æƒ³è¦åŒ¹é…çš„æ˜¯<code>int</code>ã€‚è™½ç„¶è¿™ä¸¤ç§ç±»å‹å¹¶ä¸å®Œå…¨ç›¸åŒï¼Œä½†
ä½¿ç”¨ <code>Matcher&lt;long&gt;</code> æ¥åŒ¹é… <code>int</code> å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ - ä¹‹å
æ‰€æœ‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†<code>int</code>å‚æ•°æ— æŸåœ°è½¬æ¢ä¸º<code>long</code>
å°†å…¶äº¤ç»™åŒ¹é…å™¨ã€‚</p>
<p>ä¸ºäº†æ”¯æŒè¿™ç§éœ€æ±‚ï¼ŒkMock ä¸ºæ‚¨æä¾›äº†<code>SafeMatcherCast&lt;T&gt;(m)</code>å‡½æ•°ã€‚å®ƒ
å°†åŒ¹é…å™¨ <code>m</code> è½¬æ¢ä¸ºç±»å‹ <code>Matcher&lt;T&gt;</code>ã€‚ä¸ºäº†ç¡®ä¿å®‰å…¨ï¼ŒkMock ä¼šæ£€æŸ¥
ï¼ˆä»¤â€œUâ€ä¸ºâ€œmâ€æ¥å—çš„ç±»å‹ï¼š</p>
<ol>
<li>ç±»å‹ <code>T</code> å¯ä»¥<em>éšå¼</em>è½¬æ¢ä¸ºç±»å‹ <code>U</code>ï¼›</li>
<li>å½“ <code>T</code> å’Œ <code>U</code> éƒ½æ˜¯å†…ç½®ç®— æœ¯ç±»å‹ï¼ˆ<code>bool</code>ã€æ•´æ•°å’Œ
æµ®ç‚¹æ•°ï¼‰ï¼Œä»<code>T</code>åˆ°<code>U</code>çš„è½¬æ¢æ˜¯æ²¡æœ‰æŸè€—çš„ï¼ˆåœ¨
æ¢å¥è¯è¯´ï¼Œä»»ä½•å¯ä»¥ç”¨<code>T</code>è¡¨ç¤ºçš„å€¼ä¹Ÿå¯ä»¥ç”¨<code>U</code>è¡¨ç¤ºï¼‰ï¼›
å’Œ</li>
<li>å½“<code>U</code>æ˜¯å¼•ç”¨æ—¶ï¼Œ<code>T</code>ä¹Ÿå¿…é¡»æ˜¯å¼•ç”¨ï¼ˆä½œä¸ºåº•å±‚
åŒ¹é…å™¨å¯èƒ½å¯¹â€œUâ€å€¼çš„åœ°å€æ„Ÿå…´è¶£ï¼‰ã€‚</li>
</ol>
<p>å¦‚æœä¸æ»¡è¶³å…¶ä¸­ä»»ä½•æ¡ä»¶ï¼Œåˆ™ä»£ç å°†æ— æ³•ç¼–è¯‘ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SafeMatcherCast</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// A base class and a child class.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Base</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Derived</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Base</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Derived</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> derived</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// m is a Matcher&lt;Base*&gt; we got from somewhere.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SafeMatcherCast</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Derived</span><span class="token generic-function generic class-name operator" style="color:#D73A49">*</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæ‚¨å‘ç° <code>SafeMatcherCast&lt;T&gt;(m)</code> å¤ªæœ‰é™ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„å‡½æ•°
<code>MatcherCast&lt;T&gt;(m)</code>ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œåªè¦æ‚¨æœ‰æ—¶é—´ï¼Œ<code>MatcherCast</code>å°±å¯ä»¥å·¥ä½œ
å¯ä»¥é€šè¿‡â€œstatic_castâ€å°†â€œTâ€ç±»å‹è½¬æ¢ä¸º<code>U</code>ç±»å‹ã€‚</p>
<p><code>MatcherCast</code> æœ¬è´¨ä¸Šå¯ä»¥è®©ä½ ç»•è¿‡ C++ çš„ç±»å‹ç³»ç»Ÿï¼ˆ<code>static_cast</code> ä¸æ˜¯
æ€»æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šä¸¢å¼ƒä¿¡æ¯ï¼Œä¾‹å¦‚ï¼‰ï¼Œæ‰€ä»¥è¦å°å¿ƒä¸è¦
è¯¯ç”¨/æ»¥ç”¨å®ƒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="SelectOverload">åœ¨é‡è½½å‡½æ•°ä¹‹é—´è¿›è¡Œé€‰æ‹©<a href="#SelectOverload" class="hash-link" aria-label="Direct link to åœ¨é‡è½½å‡½æ•°ä¹‹é—´è¿›è¡Œé€‰æ‹©" title="Direct link to åœ¨é‡è½½å‡½æ•°ä¹‹é—´è¿›è¡Œé€‰æ‹©">â€‹</a></h3>
<p>å¦‚æœæ‚¨æœŸæœ›è°ƒç”¨é‡è½½å‡½æ•°ï¼Œç¼–è¯‘å™¨å¯èƒ½éœ€è¦ä¸€äº›
å¸®åŠ©äº†è§£å®ƒæ˜¯å“ªä¸ªé‡è½½ç‰ˆæœ¬ã€‚</p>
<p>è¦æ¶ˆé™¤åœ¨æ­¤å¯¹è±¡çš„å¸¸é‡ä¸Šé‡è½½çš„å‡½æ•°çš„æ­§ä¹‰ï¼Œè¯·ä½¿ç”¨
<code>Const()</code> å‚æ•°åŒ…è£…å™¨ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ReturnRef</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Bar</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetBar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Bar</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetBar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Bar bar1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bar2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">         </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The non-const GetBar().</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnRef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Const</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The const GetBar().</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnRef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ï¼ˆ<code>Const()</code> ç”± kMock å®šä¹‰ï¼Œå¹¶è¿”å›å¯¹å…¶å‚æ•°çš„ <code>const</code> å¼•ç”¨ã€‚ï¼‰</p>
<p>æ¶ˆé™¤å‚æ•°æ•°é‡ç›¸åŒä½†é‡è½½å‡½æ•°çš„æ­§ä¹‰ä¸åŒçš„å‚æ•°ç±»å‹ï¼Œæ‚¨å¯èƒ½éœ€è¦æŒ‡å®šåŒ¹é…å™¨çš„ç¡®åˆ‡ç±»å‹ï¼Œ
é€šè¿‡å°†åŒ¹é…å™¨åŒ…è£…åœ¨ <code>Matcher&lt;type&gt;()</code> ä¸­ï¼Œæˆ–è€…ä½¿ç”¨å…¶åŒ¹é…å™¨ç±»å‹æ˜¯å›ºå®šçš„ï¼ˆ<code>TypedEq&lt;type&gt;</code>ã€<code>An&lt;type&gt;()</code>ç­‰ï¼‰ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">An</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Matcher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">TypedEq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockPrinter</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Printer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Print</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Print</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">char</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PrinterTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Print</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockPrinter printer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">printer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">An</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">            </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// void Print(int);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">printer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">Matcher</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Lt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// void Print(int);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">printer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">TypedEq</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">char</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// void Print(char);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  printer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  printer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  printer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œ">æ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œ<a href="#æ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œ" class="hash-link" aria-label="Direct link to æ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œ" title="Direct link to æ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œ">â€‹</a></h3>
<p>å½“è°ƒç”¨æ¨¡æ‹Ÿæ–¹æ³•æ—¶ï¼Œ<em>æœ€å</em>åŒ¹é…çš„æœŸæœ›ä»ç„¶æ˜¯
å°†é€‰æ‹©æ´»åŠ¨ï¼ˆè®¤ä¸ºâ€œè¾ƒæ–°çš„è¦†ç›–è¾ƒæ—§çš„â€ï¼‰ã€‚æ‰€ä»¥ï¼Œä½ å¯ä»¥åšä¸€ä¸ª
æ–¹æ³•æ ¹æ®å…¶å‚æ•°å€¼æ‰§è¡Œä¸åŒçš„æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The default case.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The more specific case.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Lt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç°åœ¨ï¼Œå¦‚æœè°ƒç”¨ <code>foo.DoThis()</code> çš„å€¼å°äº 5ï¼Œåˆ™ <code>&#x27;a&#x27;</code> å°†æ˜¯
è¿”å›ï¼›å¦åˆ™å°†è¿”å›<code>b</code>ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å°†å¤šä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡ŒåŒ¹é…">å°†å¤šä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡ŒåŒ¹é…<a href="#å°†å¤šä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡ŒåŒ¹é…" class="hash-link" aria-label="Direct link to å°†å¤šä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡ŒåŒ¹é…" title="Direct link to å°†å¤šä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡ŒåŒ¹é…">â€‹</a></h3>
<p>æœ‰æ—¶å•ç‹¬åŒ¹é…å‚æ•°æ˜¯ä¸å¤Ÿçš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬
å¯èƒ½æƒ³è¯´ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»å°äºç¬¬äºŒä¸ªå‚æ•°ã€‚
<code>With()</code> å­å¥å…è®¸æˆ‘ä»¬å°†æ¨¡æ‹Ÿå‡½æ•°çš„æ‰€æœ‰å‚æ•°åŒ¹é…ä¸º
æ‰€æœ‰çš„ã€‚ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Ne</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">InRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Ne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">With</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Lt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¡¨ç¤º <code>InRange()</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸èƒ½ä¸º 0ï¼Œå¹¶ä¸”å¿…é¡»å°äº
ç¬¬äºŒä¸ªå‚æ•°ã€‚</p>
<p><code>With()</code> ä¸­çš„è¡¨è¾¾å¼å¿…é¡»æ˜¯ <code>Matcher&lt;std::tuple&lt;A1, ..., An&gt;&gt;</code>ï¼Œå…¶ä¸­ <code>A1</code>ã€...ã€<code>An</code> æ˜¯å‡½æ•°å‚æ•°çš„ç±»å‹ã€‚</p>
<p>æ‚¨è¿˜å¯ä»¥åœ¨ <code>.With()</code> ä¸­ç¼–å†™ <code>AllArgs(m)</code> è€Œä¸æ˜¯ <code>m</code>ã€‚ä¸¤ç§å½¢å¼
æ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯ <code>.With(AllArgs(Lt()))</code> æ¯” <code>.With(Lt())</code> æ›´å…·å¯è¯»æ€§ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ <code>Args&lt;k1, ..., kn&gt;(m)</code> æ¥åŒ¹é… <code>n</code> é€‰å®šçš„å‚æ•°ï¼ˆä½œä¸º
å…ƒç»„ï¼‰é’ˆå¯¹<code>m</code>ã€‚ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AllOf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Args</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Blah</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">With</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AllOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">Args</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name number" style="color:#005CC5">1</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Lt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">Args</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">1</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name number" style="color:#005CC5">2</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Lt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¡¨ç¤ºå°†ä½¿ç”¨å‚æ•°<code>x</code>ã€<code>y</code>å’Œ<code>z</code>è°ƒç”¨<code>Blah</code>ï¼Œå…¶ä¸­<code>x &lt; y &lt; z</code>ã€‚è¯·æ³¨æ„ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ— éœ€æŒ‡å®šä½ç½®åŒ¹é…å™¨ã€‚</p>
<p>ä½œä¸ºæ–¹ä¾¿å’Œç¤ºä¾‹ï¼ŒkMock æä¾›äº†ä¸€äº› 2 å…ƒç»„çš„åŒ¹é…å™¨ï¼ŒåŒ…æ‹¬ä¸Šé¢çš„â€œLt()â€åŒ¹é…å™¨ã€‚æœ‰å…³å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜…<a href="/docs/cpp/base/testing/kt/reference/matchers#MultiArgMatchers">å¤šå‚æ•°åŒ¹é…å™¨</a>ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨æƒ³å°†å‚æ•°ä¼ é€’ç»™æ‚¨è‡ªå·±çš„è°“è¯ï¼ˆä¾‹å¦‚ <code>.With(Args&lt;0, 1&gt;(Truly(&amp;MyPredicate)))</code>ï¼‰ï¼Œåˆ™è¯¥è°“è¯å¿…é¡»ç¼–å†™ä¸ºé‡‡ç”¨ <code>std::tuple </code> ä½œä¸ºå…¶å‚æ•°ï¼› kMock ä¼šå°†â€œnâ€ä¸ªé€‰å®šå‚æ•°ä½œä¸º<em>ä¸€ä¸ª</em>å•ä¸ªå…ƒç»„ä¼ é€’ç»™è°“è¯ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä½¿ç”¨åŒ¹é…å™¨ä½œä¸ºè°“è¯">ä½¿ç”¨åŒ¹é…å™¨ä½œä¸ºè°“è¯<a href="#ä½¿ç”¨åŒ¹é…å™¨ä½œä¸ºè°“è¯" class="hash-link" aria-label="Direct link to ä½¿ç”¨åŒ¹é…å™¨ä½œä¸ºè°“è¯" title="Direct link to ä½¿ç”¨åŒ¹é…å™¨ä½œä¸ºè°“è¯">â€‹</a></h3>
<p>æ‚¨æ˜¯å¦æ³¨æ„åˆ°åŒ¹é…å™¨åªæ˜¯ä¸€ä¸ªå¥‡ç‰¹çš„è°“è¯ï¼Œå®ƒä¹ŸçŸ¥é“å¦‚ä½•
æè¿°è‡ªå·±ï¼Ÿè®¸å¤šç°æœ‰ç®—æ³•å°†è°“è¯ä½œä¸ºå‚æ•°ï¼ˆä¾‹å¦‚
é‚£äº›åœ¨ STL çš„ <code>&lt;algorithm&gt;</code> å¤´ä¸­å®šä¹‰çš„ï¼‰ï¼Œå¦‚æœ kMock
ä¸å…è®¸åŒ¹é…è€…å‚ä¸ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåŒ¹é…å™¨ï¼Œå…¶ä¸­éœ€è¦ä¸€å…ƒè°“è¯å‡½å­
å°†å…¶åŒ…è£…åœ¨ <code>Matches()</code> å‡½æ•°ä¸­ã€‚ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;algorithm&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&lt;vector&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Matches</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Ge</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> v</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// How many elements in v are &gt;= 10?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> count </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">count_if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">begin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Ge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç”±äºæ‚¨å¯ä»¥ä½¿ç”¨ kMock è½»æ¾åœ°ä»ç®€å•çš„åŒ¹é…å™¨æ„å»ºå¤æ‚çš„åŒ¹é…å™¨ï¼Œå› æ­¤ä¸ºæ‚¨æä¾›äº†ä¸€ç§æ–¹ä¾¿åœ°æ„é€ å¤åˆè°“è¯çš„æ–¹æ³•ï¼ˆæ‰§è¡Œç›¸åŒçš„æ“ä½œ
ä½¿ç”¨ STL çš„ <code>&lt;function&gt;</code> æ ‡å¤´éå¸¸ç—›è‹¦ï¼‰ã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ªä»»ä½•æ»¡è¶³ <code>&gt;=</code> 0ã€<code>&lt;=</code> 100 å’Œ <code>!=</code> 50 çš„è°“è¯ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AllOf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Ge</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Le</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Matches</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Ne</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">Matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AllOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Ge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Le</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Ne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">50</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åœ¨-ktest-æ–­è¨€ä¸­ä½¿ç”¨åŒ¹é…å™¨">åœ¨ ktest æ–­ è¨€ä¸­ä½¿ç”¨åŒ¹é…å™¨<a href="#åœ¨-ktest-æ–­è¨€ä¸­ä½¿ç”¨åŒ¹é…å™¨" class="hash-link" aria-label="Direct link to åœ¨ ktest æ–­è¨€ä¸­ä½¿ç”¨åŒ¹é…å™¨" title="Direct link to åœ¨ ktest æ–­è¨€ä¸­ä½¿ç”¨åŒ¹é…å™¨">â€‹</a></h3>
<p>è¯·å‚é˜…æ–­è¨€ä¸­çš„ <a href="/docs/cpp/base/testing/kt/reference/assertions#EXPECT_THAT"><code>EXPECT_THAT</code></a>
å‚è€ƒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä½¿ç”¨è°“è¯ä½œä¸ºåŒ¹é…å™¨">ä½¿ç”¨è°“è¯ä½œä¸ºåŒ¹é…å™¨<a href="#ä½¿ç”¨è°“è¯ä½œä¸ºåŒ¹é…å™¨" class="hash-link" aria-label="Direct link to ä½¿ç”¨è°“è¯ä½œä¸ºåŒ¹é…å™¨" title="Direct link to ä½¿ç”¨è°“è¯ä½œä¸ºåŒ¹é…å™¨">â€‹</a></h3>
<p>kMock æä¾›äº†ä¸€ç»„å†…ç½®åŒ¹é…å™¨ï¼Œç”¨äºå°†å‚æ•°ä¸é¢„æœŸåŒ¹é…
å€¼ - æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="/docs/cpp/base/testing/kt/reference/matchers">åŒ¹é…å™¨å‚è€ƒ</a>ã€‚
å¦‚æœæ‚¨å‘ç°ç¼ºå°‘å†…ç½®é›†åˆï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»»æ„ä¸€å…ƒ
è°“è¯å‡½æ•°æˆ–å‡½å­ä½œä¸ºåŒ¹é…å™¨ - åªè¦è°“è¯æ¥å—
æ‚¨æƒ³è¦çš„ç±»å‹çš„å€¼ã€‚æ‚¨å¯ä»¥é€šè¿‡å°†è°“è¯åŒ…è£…åœ¨
<code>Truly()</code> å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Truly</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsEven</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Bar() must be called with an even number.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Truly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">IsEven</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œè°“è¯å‡½æ•°/ä»¿å‡½æ•°ä¸å¿…è¿”å›<code>bool</code>ã€‚å®ƒ
åªè¦è¿”å›å€¼å¯ä»¥ç”¨ä½œ in è¯­å¥ä¸­çš„æ¡ä»¶å³å¯
<code>å¦‚æœï¼ˆæ¡ä»¶ï¼‰...</code>ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åŒ¹é…ä¸å¯å¤åˆ¶çš„å‚æ•°">åŒ¹é…ä¸å¯å¤åˆ¶çš„å‚æ•°<a href="#åŒ¹é…ä¸å¯å¤åˆ¶çš„å‚æ•°" class="hash-link" aria-label="Direct link to åŒ¹é…ä¸å¯å¤åˆ¶çš„å‚æ•°" title="Direct link to åŒ¹é…ä¸å¯å¤åˆ¶çš„å‚æ•°">â€‹</a></h3>
<p>å½“ä½ æ‰§è¡Œâ€œEXPECT_CALL(mock_obj, Foo(bar))â€æ—¶ï¼ŒkMock ä¼šä¿å­˜ä¸€ä»½å‰¯æœ¬
<code>é…’å§</code>ã€‚å½“ç¨åè°ƒç”¨ <code>Foo()</code> æ—¶ï¼ŒkMock å°†å‚æ•°ä¸ <code>Foo()</code> è¿›è¡Œæ¯”è¾ƒ
<code>bar</code> çš„ä¿å­˜å‰¯æœ¬ã€‚è¿™æ ·ï¼Œæ‚¨å°±ä¸å¿…æ‹…å¿ƒ<code>bar</code>è¢«
æ‰§è¡Œ<code>EXPECT_CALL()</code>åä¿®æ”¹æˆ–é”€æ¯ã€‚åŒæ ·çš„é“ç†
å½“æ‚¨ä½¿ç”¨<code>Eq(bar)</code>ã€<code>Le(bar)</code>ç­‰åŒ¹é…å™¨æ—¶ã€‚</p>
<p>ä½†æ˜¯å¦‚æœâ€œbarâ€æ— æ³•å¤åˆ¶ï¼ˆå³æ²¡æœ‰å¤åˆ¶æ„é€ å‡½æ•°ï¼‰æ€ä¹ˆåŠï¼Ÿä½ å¯ä»¥
å®šä¹‰æ‚¨è‡ªå·±çš„åŒ¹é…å™¨å‡½æ•°æˆ–å›è°ƒå¹¶å°†å…¶ä¸<code>Truly()</code>ä¸€èµ·ä½¿ç”¨ï¼Œä½œä¸º
å‰é¢çš„å‡ ä¸ªé£Ÿè°±å·²ç»æ˜¾ç¤ºã€‚æˆ–è€…ï¼Œä½ ä¹Ÿè®¸èƒ½å¤Ÿæ‘†è„±å®ƒ
å¦‚æœä½ èƒ½ä¿è¯åœ¨<code>EXPECT_CALL()</code>ä¹‹å<code>bar</code>ä¸ä¼šæ”¹å˜
è¢«æ‰§è¡Œã€‚åªéœ€å‘Šè¯‰ kMock å®ƒåº”è¯¥ä¿å­˜å¯¹<code>bar</code>çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯
å®ƒçš„å‰¯æœ¬ã€‚æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Eq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Lt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Expects that Foo()&#x27;s argument == bar.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Eq</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Expects that Foo()&#x27;s argument &lt; bar.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Lt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·è®°ä½ï¼šå¦‚æœæ‚¨è¿™æ ·åšï¼Œè¯·ä¸è¦åœ¨<code>EXPECT_CALL()</code>ä¹‹åæ›´æ”¹<code>bar</code>ï¼Œæˆ–è€…
ç»“æœæœªå®šä¹‰ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="éªŒè¯å¯¹è±¡çš„æˆå‘˜">éªŒè¯å¯¹è±¡çš„æˆå‘˜<a href="#éªŒè¯å¯¹è±¡çš„æˆå‘˜" class="hash-link" aria-label="Direct link to éªŒè¯å¯¹è±¡çš„æˆå‘˜" title="Direct link to éªŒè¯å¯¹è±¡çš„æˆå‘˜">â€‹</a></h3>
<p>æ¨¡æ‹Ÿå‡½æ•°é€šå¸¸ä¼šå°†å¯¹è±¡çš„å¼•ç”¨ä½œä¸ºå‚æ•°ã€‚åŒ¹é…æ—¶
å‚æ•°ï¼Œæ‚¨å¯èƒ½ä¸æƒ³å°†æ•´ä¸ªå¯¹è±¡ä¸å›ºå®šçš„è¿›è¡Œæ¯”è¾ƒ
å¯¹è±¡ï¼Œå› ä¸ºè¿™å¯èƒ½æ˜¯è¿‡åº¦è§„èŒƒçš„ã€‚ç›¸åï¼Œæ‚¨å¯èƒ½éœ€è¦éªŒè¯
æŸä¸ªæˆå‘˜å˜é‡æˆ–å¯¹è±¡çš„æŸä¸ª getter æ–¹æ³•çš„ç»“æœã€‚
æ‚¨å¯ä»¥ä½¿ç”¨<code>Field()</code>å’Œ<code>Property()</code>æ¥å®Œæˆæ­¤æ“ä½œã€‚æ›´å…·ä½“åœ°è¯´ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">Field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ˜¯åŒ¹é…ä¸€ä¸ª<code>Foo</code>å¯¹è±¡çš„åŒ¹é…å™¨ï¼Œè¯¥å¯¹è±¡çš„<code>bar</code>æˆå‘˜å˜é‡æ»¡è¶³åŒ¹é…å™¨<code>m</code>ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">Property</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">baz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ˜¯åŒ¹é…<code>Foo</code>å¯¹è±¡çš„åŒ¹é…å™¨ï¼Œè¯¥å¯¹è±¡çš„<code>baz()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå€¼
æ»¡è¶³åŒ¹é…å™¨<code>m</code>ã€‚</p>
<p>For example:</p>
<table><thead><tr><th style="text-align:left">è¡¨è¾¾å¼</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left"><code>Field(&amp;Foo::number, Ge(3))</code></td><td style="text-align:left">å½“ <code>x.number &gt;= 3</code>åŒ¹é… <code>x</code></td></tr><tr><td style="text-align:left"><code>Property(&amp;Foo::name,  StartsWith(&quot;John &quot;))</code></td><td style="text-align:left">åŒ¹é… <code>x</code>ï¼Œå…¶ä¸­ <code>x.name()</code> ä»¥ <code>&quot;John &quot;</code> å¼€å¤´ã€‚</td></tr></tbody></table>
<p>è¯·æ³¨æ„ï¼Œåœ¨<code>Property(&amp;Foo::baz, ...)</code>ä¸­ï¼Œæ–¹æ³•<code>baz()</code>ä¸èƒ½å¸¦ä»»ä½•å‚æ•°
å¹¶å£°æ˜ä¸º<code>const</code>ã€‚ä¸è¦å¯¹ä»¥ä¸‹æˆå‘˜å‡½æ•°ä½¿ç”¨<code>Property()</code>
ä½ ä¸æ‹¥æœ‰ï¼Œå› ä¸ºè·å–å‡½æ•°çš„åœ°å€æ˜¯è„†å¼±çš„å¹¶ä¸”é€šå¸¸
ä¸æ˜¯å‡½æ•°åˆåŒçš„ä¸€éƒ¨åˆ†ã€‚</p>
<p><code>Field()</code> å’Œ <code>Property()</code> ä¹Ÿå¯ä»¥åŒ¹é…æŒ‡å‘å¯¹è±¡çš„æ™®é€šæŒ‡é’ˆã€‚ä¸ºäº†
å®ä¾‹ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Field</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Ge</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">Field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Ge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŒ¹é…æ™®é€šæŒ‡é’ˆ<code>p</code>ï¼Œå…¶ä¸­<code>p-&gt;number &gt;= 3</code>ã€‚å¦‚æœ<code>p</code>ä¸º<code>NULL</code>ï¼Œåˆ™åŒ¹é…
æ— è®ºå†…éƒ¨åŒ¹é…å™¨å¦‚ä½•ï¼Œæ€»ä¼šå¤±è´¥ã€‚</p>
<p>å¦‚æœæ‚¨æƒ³åŒæ—¶éªŒè¯å¤šä¸ªæˆå‘˜æ€ä¹ˆåŠï¼Ÿè®°ä½
æœ‰ <a href="#CombiningMatchers"><code>AllOf()</code> å’Œ <code>AllOfArray()</code></a>ã€‚</p>
<p>æœ€å <code>Field()</code> å’Œ <code>Property()</code> æä¾›äº†é‡‡ç”¨å­—æ®µæˆ–
å±æ€§åç§°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°å°†å…¶åŒ…å«åœ¨é”™è¯¯æ¶ˆæ¯ä¸­ã€‚è¿™
åˆ›å»ºç»„åˆåŒ¹é…å™¨æ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AllOf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Field</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Matcher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SafeMatcherCast</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Matcher</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Foo</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Foo</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">AllOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;some_field&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">some_field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">some_field</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token function" style="color:#8250DF">Field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;other_field&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">other_field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">other_field</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token function" style="color:#8250DF">Field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;last_field&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">Foo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">last_field</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">last_field</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="éªŒè¯æŒ‡é’ˆå‚æ•°æŒ‡å‘çš„å€¼">éªŒè¯æŒ‡é’ˆå‚æ•°æŒ‡å‘çš„å€¼<a href="#éªŒè¯æŒ‡é’ˆå‚æ•°æŒ‡å‘çš„å€¼" class="hash-link" aria-label="Direct link to éªŒè¯æŒ‡é’ˆå‚æ•°æŒ‡å‘çš„å€¼" title="Direct link to éªŒè¯æŒ‡é’ˆå‚æ•°æŒ‡å‘çš„å€¼">â€‹</a></h3>
<p>C++ å‡½æ•°é€šå¸¸é‡‡ç”¨æŒ‡é’ˆä½œä¸ºå‚æ•°ã€‚æ‚¨å¯ä»¥ä½¿ç”¨åƒè¿™æ ·çš„åŒ¹é…å™¨
<code>IsNull()</code>ã€<code>NotNull()</code>  å’Œå…¶ä»–æ¯”è¾ƒåŒ¹é…å™¨æ¥åŒ¹é…æŒ‡é’ˆï¼Œä½†æ˜¯
å¦‚æœä½ æƒ³ç¡®ä¿æŒ‡é’ˆ<em>æŒ‡å‘</em>çš„å€¼ï¼Œè€Œä¸æ˜¯
æŒ‡é’ˆæœ¬èº«ï¼Œå…·æœ‰ä¸€å®šçš„å±æ€§å—ï¼Ÿå¥½å§ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>Pointee(m)</code>
åŒ¹é…å™¨ã€‚</p>
<p>å½“ä¸”ä»…å½“<code>m</code>ä¸æŒ‡é’ˆçš„å€¼åŒ¹é…æ—¶ï¼Œ<code>Pointee(m)</code>æ‰åŒ¹é…æŒ‡é’ˆ
æŒ‡å‘.ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Ge</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Pointee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Pointee</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Ge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æœŸæœ›ä½¿ç”¨æŒ‡å‘æ›´å¤§å€¼çš„æŒ‡é’ˆæ¥è°ƒç”¨<code>foo.Bar()</code>
å¤§äºæˆ–ç­‰äº3ã€‚</p>
<p><code>Pointee()</code>çš„ä¸€ä¸ªå¥½å¤„æ˜¯å®ƒå°†<code>NULL</code>æŒ‡é’ˆè§†ä¸ºåŒ¹é…é¡¹
å¤±è´¥ï¼Œæ‰€ä»¥ä½ å¯ä»¥å†™ <code>Pointee(m)</code> è€Œä¸æ˜¯</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AllOf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">NotNull</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Pointee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">AllOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Pointee</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸ç”¨æ‹…å¿ƒ<code>NULL</code>æŒ‡é’ˆä¼šä½¿æ‚¨çš„æµ‹è¯•å´©æºƒã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬æ˜¯å¦å‘Šè¯‰è¿‡æ‚¨<code>Pointee()</code>é€‚ç”¨äºåŸå§‹æŒ‡é’ˆ ** å’Œ **
æ™ºèƒ½æŒ‡é’ˆï¼ˆ<code>std::unique_ptr</code>ã€<code>std::shared_ptr</code>ç­‰ï¼‰ï¼Ÿ</p>
<p>å¦‚æœä½ æœ‰ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆæ€ä¹ˆåŠï¼Ÿä½ çŒœå¯¹äº† - ä½ å¯ä»¥ä½¿ç”¨åµŒå¥—
<code>Pointee()</code> å¯ä»¥æ›´æ·±å…¥åœ°æ¢ç©¶å€¼çš„å†…éƒ¨ã€‚ä¾‹å¦‚ï¼Œ
<code>Pointee(Pointee(Lt(3)))</code> åŒ¹é…ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªæŒ‡é’ˆçš„æŒ‡é’ˆ
å°äº 3 çš„æ•°å­—ï¼ˆçœŸæ˜¯æ‹—å£â€¦â€¦ï¼‰ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="CustomMatcherClass">å®šä¹‰è‡ªå®šä¹‰åŒ¹é…å™¨ç±»<a href="#CustomMatcherClass" class="hash-link" aria-label="Direct link to å®šä¹‰è‡ªå®šä¹‰åŒ¹é…å™¨ç±»" title="Direct link to å®šä¹‰è‡ªå®šä¹‰åŒ¹é…å™¨ç±»">â€‹</a></h3>
<p>å¤§å¤šæ•°åŒ¹é…å™¨å¯ä»¥ä½¿ç”¨ <a href="#NewMatchers">MATCHER* å®</a> ç®€å•åœ°å®šä¹‰ï¼Œ
å®ƒä»¬ç®€æ´çµæ´»ï¼Œå¹¶èƒ½äº§ç”Ÿè‰¯å¥½çš„é”™è¯¯æ¶ˆæ¯ã€‚ç„¶è€Œï¼Œè¿™äº›
å®å¯¹äºå®ƒä»¬åˆ›å»ºçš„æ¥å£ä¸æ˜¯å¾ˆæ˜ç¡®ï¼Œè€Œä¸”å¹¶ä¸æ€»æ˜¯
é€‚åˆï¼Œç‰¹åˆ«æ˜¯å¯¹äºå°†è¢«å¹¿æ³›é‡ç”¨çš„åŒ¹é…å™¨ã€‚</p>
<p>å¯¹äºæ›´é«˜çº§çš„æƒ…å†µï¼Œæ‚¨å¯èƒ½éœ€è¦å®šä¹‰è‡ªå·±çš„åŒ¹é…å™¨ç±»ã€‚å®šåˆ¶
åŒ¹é…å™¨å…è®¸æ‚¨æµ‹è¯•è¯¥å¯¹è±¡çš„ç‰¹å®šä¸å˜å±æ€§ã€‚è®©æˆ‘ä»¬
çœ‹çœ‹å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªæ¨¡æ‹Ÿå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª<code>Foo</code>ç±»å‹çš„å¯¹è±¡ï¼Œå…¶ä¸­æœ‰
ä¸€ä¸ª<code>int bar()</code>æ–¹æ³•å’Œä¸€ä¸ª<code>int baz()</code>æ–¹æ³•ã€‚ä½ æƒ³è¦é™åˆ¶
å‚æ•°çš„â€œbar()â€å€¼åŠ ä¸Šå…¶â€œbaz()â€å€¼æ˜¯ç»™å®šçš„æ•°å­—ã€‚ ï¼ˆè¿™æ˜¯ä¸€ä¸ª
ä¸å˜ã€‚ï¼‰ä»¥ä¸‹æ˜¯æˆ‘ä»¬å¦‚ä½•ç¼–å†™å’Œä½¿ç”¨åŒ¹é…å™¨ç±»æ¥æ‰§è¡Œæ­¤æ“ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">BarPlusBazEqMatcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> is_ktest_matcher </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">explicit</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">BarPlusBazEqMatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> expected_sum</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">expected_sum_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expected_sum</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MatchAndExplain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Foo</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/* listener */</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">baz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> expected_sum_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;bar() + baz() equals &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> expected_sum_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeNegationTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;bar() + baz() does not equal &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> expected_sum_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">private</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> expected_sum_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Matcher</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Foo</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">BarPlusBazEq</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> expected_sum</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">BarPlusBazEqMatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expected_sum</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Foo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">BarPlusBazEq</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é…å¥—å®¹å™¨">é…å¥—å®¹å™¨<a href="#é…å¥—å®¹å™¨" class="hash-link" aria-label="Direct link to é…å¥—å®¹å™¨" title="Direct link to é…å¥—å®¹å™¨">â€‹</a></h3>
<p>æœ‰æ—¶ï¼ŒSTL å®¹å™¨ï¼ˆä¾‹å¦‚åˆ—è¡¨ã€å‘é‡ã€åœ°å›¾...ï¼‰ä¼šä¼ é€’ç»™æ¨¡æ‹Ÿ
å‡½æ•°ï¼Œæ‚¨å¯èƒ½æƒ³éªŒè¯å®ƒã€‚ç”±äºå¤§å¤šæ•° STL å®¹å™¨éƒ½æ”¯æŒ
<code>==</code> è¿ç®—ç¬¦ï¼Œä½ å¯ä»¥å†™ <code>Eq(expected_container)</code> æˆ–ç®€å•åœ°å†™
<code>expected_container</code> ä¸å®¹å™¨å®Œå…¨åŒ¹é…ã€‚</p>
<p>ä½†æœ‰æ—¶ï¼Œæ‚¨å¯èƒ½å¸Œæœ›æ›´åŠ çµæ´»ï¼ˆä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ª
å…ƒç´ å¿…é¡»å®Œå…¨åŒ¹é…ï¼Œä½†ç¬¬äºŒä¸ªå…ƒç´ å¯ä»¥æ˜¯ä»»æ„æ­£æ•°
å·ç­‰ï¼‰ã€‚æ­¤å¤–ï¼Œæµ‹è¯•ä¸­ä½¿ç”¨çš„å®¹å™¨é€šå¸¸å…·æœ‰å°‘é‡
å…ƒç´ ï¼Œå¹¶ä¸”å¿…é¡»å®šä¹‰é¢„æœŸçš„å®¹å™¨ï¼Œè¿™æœ‰ç‚¹éº»çƒ¦
éº»çƒ¦ã€‚</p>
<p>æ‚¨å¯ä»¥åœ¨æ­¤ç±»ä¸­ä½¿ç”¨ <code>ElementsAre()</code> æˆ– <code>UnorderedElementsAre()</code> åŒ¹é…å™¨
æ¡ˆä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ElementsAre</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ElementsAre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Gt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šé¢çš„åŒ¹é…å™¨è¯´å®¹å™¨å¿…é¡»æœ‰4ä¸ªå…ƒç´ ï¼Œå…¶ä¸­å¿…é¡»æ˜¯1ï¼Œåˆ†åˆ«å¤§äº 0ã€ä»»æ„å€¼å’Œ 5ã€‚</p>
<p>å¦‚æœä½ æ”¹ä¸ºå†™ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">UnorderedElementsAre</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">UnorderedElementsAre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Gt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™æ„å‘³ç€å®¹å™¨å¿…é¡»æœ‰ 4 ä¸ªå…ƒç´ ï¼Œå…¶ä¸­ï¼ˆåœ¨æŸäº›æ’åˆ—ä¸‹ï¼‰å¿…é¡»åˆ†åˆ«ä¸º 1ã€å¤§äº 0ã€ä»»æ„å€¼å’Œ 5ã€‚</p>
<p>ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œæ‚¨å¯ä»¥å°†å‚æ•°æ”¾å…¥ C æ ·å¼æ•°ç»„ä¸­å¹¶ä½¿ç”¨
æ”¹ä¸º <code>ElementsAreArray()</code> æˆ– <code>UnorderedElementsAreArray()</code>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ElementsAreArray</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// ElementsAreArray accepts an array of element values.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> expected_vector1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ElementsAreArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expected_vector1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Or, an array of element matchers.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Matcher</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> expected_vector2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Gt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ElementsAreArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expected_vector2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœéœ€è¦åŠ¨æ€åˆ›å»ºæ•°ç»„ï¼ˆå› æ­¤æ•°ç»„å¤§å°ç¼–è¯‘å™¨æ— æ³•æ¨æ–­ï¼‰ï¼Œä½ å¯ä»¥ç»™ <code>ElementsAreArray()</code> ä¸€ä¸ª
ç”¨äºæŒ‡å®šæ•°ç»„å¤§å°çš„é™„åŠ å‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ElementsAreArray</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> expected_vector3 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> fill expected_vector3 with values </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ElementsAreArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expected_vector3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ¯”è¾ƒåœ°å›¾æˆ–å…¶ä»–å…³è”å®¹å™¨æ—¶ä½¿ç”¨â€œPairâ€ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ElementsAre</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Pair</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> m </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ElementsAre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Pair</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Pair</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Pair</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å»ºè®®:</strong></p>
<ul>
<li><code>ElementsAre*()</code> å¯ç”¨äºåŒ¹é… <em>ä»»ä½•</em> å®ç° STL è¿­ä»£å™¨æ¨¡å¼çš„å®¹å™¨ï¼ˆå³å®ƒå…·æœ‰ <code>const_iterator</code> ç±»å‹å¹¶æ”¯æŒ <code>begin()/end()</code>ï¼‰ï¼Œè€Œä¸ä»…ä»…æ˜¯ ä¸­å®šä¹‰çš„å®¹å™¨STLã€‚å®ƒç”šè‡³å¯ä»¥ä¸å°šæœªç¼–å†™çš„å®¹å™¨ç±»å‹ä¸€èµ·ä½¿ç”¨ - åªè¦å®ƒä»¬éµå¾ªä¸Šè¿°æ¨¡å¼ã€‚</li>
<li>æ‚¨å¯ä»¥ä½¿ç”¨åµŒå¥—çš„ <code>ElementsAre*()</code> æ¥åŒ¹é…åµŒå¥—ï¼ˆå¤šç»´ï¼‰å®¹å™¨ã€‚</li>
<li>å¦‚æœå®¹å™¨æ˜¯é€šè¿‡æŒ‡é’ˆè€Œä¸æ˜¯å¼•ç”¨ä¼ é€’çš„ï¼Œåªéœ€ç¼–å†™<code>Pointee(ElementsAre*(...))</code>ã€‚</li>
<li>å¯¹äº <code>ElementsAre*()</code> æ¥è¯´ï¼Œå…ƒç´ çš„é¡ºåº<em>é‡è¦</em>ã€‚å¦‚æœæ‚¨å°† å…¶ä¸å…ƒç´ é¡ºåºæœªå®šä¹‰çš„å®¹å™¨ï¼ˆä¾‹å¦‚<code>hash_map</code>ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™åº”è¯¥åœ¨<code>ElementsAre</code>å‘¨å›´ä½¿ç”¨<code>WhenSorted</code>ã€‚</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å…±äº«åŒ¹é…å™¨">å…±äº«åŒ¹é…å™¨<a href="#å…±äº«åŒ¹é…å™¨" class="hash-link" aria-label="Direct link to å…±äº«åŒ¹é…å™¨" title="Direct link to å…±äº«åŒ¹é…å™¨">â€‹</a></h3>
<p>åœ¨åº•å±‚ï¼ŒkMock åŒ¹é…å™¨å¯¹è±¡ç”±ä¸€ä¸ªæŒ‡å‘å¼•ç”¨è®¡æ•°çš„æŒ‡é’ˆç»„æˆ
å®æ–½å¯¹è±¡ã€‚å¤åˆ¶åŒ¹é…å™¨æ˜¯å…è®¸çš„å¹¶ä¸”éå¸¸æœ‰æ•ˆï¼Œå› ä¸ºåªæœ‰
æŒ‡é’ˆè¢«å¤åˆ¶ã€‚å½“å¼•ç”¨å®ç°çš„æœ€åä¸€ä¸ªåŒ¹é…å™¨
å¯¹è±¡æ­»äº¡æ—¶ï¼Œå®ç°å¯¹è±¡å°†è¢«åˆ é™¤ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœæ‚¨æƒ³å†æ¬¡ä½¿ç”¨ä¸€äº›å¤æ‚çš„åŒ¹é…å™¨å¹¶ä¸”
å†æ¬¡å¼ºè°ƒï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½æ„å»ºå®ƒã€‚åªéœ€å°†å…¶åˆ†é…ç»™åŒ¹é…å™¨å³å¯
å˜é‡å¹¶é‡å¤ä½¿ç”¨è¯¥å˜é‡ï¼ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AllOf</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Le</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Matcher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Matcher</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> in_range </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">AllOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Gt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Le</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> use in_range as a matcher in multiple EXPECT_CALLs </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="PureMatchers">åŒ¹é…å™¨å¿…é¡»æ²¡æœ‰å‰¯ä½œç”¨<a href="#PureMatchers" class="hash-link" aria-label="Direct link to åŒ¹é…å™¨å¿…é¡»æ²¡æœ‰å‰¯ä½œç”¨" title="Direct link to åŒ¹é…å™¨å¿…é¡»æ²¡æœ‰å‰¯ä½œç”¨">â€‹</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>è­¦å‘Š</div><div class="admonitionContent_BuS1"><p>kMock ä¸ä¿è¯åŒ¹é…å™¨ä½•æ—¶æˆ–å¤šå°‘æ¬¡
è°ƒç”¨ã€‚å› æ­¤ï¼Œæ‰€æœ‰åŒ¹é…å™¨éƒ½å¿…é¡»æ˜¯â€œçº¯åŠŸèƒ½æ€§çš„â€ï¼šå®ƒä»¬ä¸èƒ½å…·æœ‰
ä»»ä½•å‰¯ä½œç”¨ï¼Œå¹¶ä¸”æ¯”èµ›ç»“æœä¸èƒ½ä¾èµ–äºé™¤
åŒ¹é…å™¨çš„å‚æ•°å’Œè¢«åŒ¹é…çš„å€¼ã€‚</p></div></div>
<p>æ— è®ºåŒ¹é…å™¨å¦‚ä½•å®šä¹‰ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœå®ƒæ˜¯æ ‡å‡†åŒ¹é…å™¨ä¹‹ä¸€ï¼Œæˆ–è‡ªå®šä¹‰åŒ¹é…å™¨ï¼‰ã€‚ç‰¹åˆ«æ˜¯ï¼Œä¸€ä¸ª
matcher æ°¸è¿œä¸èƒ½è°ƒç”¨æ¨¡æ‹Ÿå‡½æ•°ï¼Œå› ä¸ºè¿™ä¼šå½±å“æ¨¡æ‹Ÿå¯¹è±¡å’Œ kMockã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="setting-expectations">è®¾å®šæœŸæœ›<a href="#setting-expectations" class="hash-link" aria-label="Direct link to è®¾å®šæœŸæœ›" title="Direct link to è®¾å®šæœŸæœ›">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="UseOnCall">çŸ¥é“ä»€ä¹ˆæ—¶å€™å¯ä»¥æœŸå¾…<a href="#UseOnCall" class="hash-link" aria-label="Direct link to çŸ¥é“ä»€ä¹ˆæ—¶å€™å¯ä»¥æœŸå¾…" title="Direct link to çŸ¥é“ä»€ä¹ˆæ—¶å€™å¯ä»¥æœŸå¾…">â€‹</a></h3>
<p><strong><code>ON_CALL</code></strong> å¯èƒ½æ˜¯ kMock ä¸­<em>æœªè¢«å……åˆ†åˆ©ç”¨çš„æ„é€ </em>ã€‚</p>
<p>å®šä¹‰æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸ºåŸºæœ¬ä¸Šæœ‰ä¸¤ç§æ„é€ ï¼š</p>
<p><code>ON_CALL</code>å’Œ<code>EXPECT_CALL</code>ã€‚åŒºåˆ«ï¼Ÿ <code>ON_CALL</code>å®šä¹‰äº†è°ƒç”¨æ¨¡æ‹Ÿæ–¹æ³•æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œ
ä½†å¹¶ä¸æ„å‘³ç€å¯¹è¢«è°ƒç”¨çš„æ–¹æ³•æœ‰ä»»ä½•æœŸæœ›ã€‚ <code>EXPECT_CALL</code>ä¸ä»…å®šä¹‰äº†è¡Œä¸ºï¼Œè¿˜è®¾ç½®äº†ä¸€ä¸ªæœŸæœ›ï¼Œ
å³<em>å°†ä½¿ç”¨ç»™å®šçš„å‚æ•°è°ƒç”¨è¯¥æ–¹æ³•ç»™å®šçš„æ¬¡æ•°</em>ï¼ˆå¹¶ä¸”<em>æŒ‰ç»™å®šçš„é¡ºåº</em>å½“æ‚¨æŒ‡å®šä¹Ÿè®¢è´­ï¼‰ã€‚</p>
<p>æ—¢ç„¶<code>EXPECT_CALL</code>åšäº†æ›´å¤šçš„äº‹æƒ…ï¼Œé‚£ä¹ˆå®ƒä¸æ˜¯æ¯”<code>ON_CALL</code>æ›´å¥½å—ï¼Ÿäº‹å®å¹¶ä¸æ˜¯è¿™æ ·ã€‚æ¯ä¸ª<code>EXPECT_CALL</code>éƒ½ä¼šå¯¹è¢«æµ‹ä»£ç çš„è¡Œä¸ºæ·»åŠ çº¦æŸã€‚æ‹¥æœ‰è¿‡å¤šçš„çº¦æŸæ˜¯<em>baaad</em> - ç”šè‡³æ¯”æ²¡æœ‰è¶³å¤Ÿçš„çº¦æŸæ›´ç³Ÿç³•ã€‚</p>
<p>è¿™å¯èƒ½æ˜¯è¿åç›´è§‰çš„ã€‚éªŒè¯æ›´å¤šçš„æµ‹è¯•æ€ä¹ˆå¯èƒ½æ¯”éªŒè¯è¾ƒå°‘çš„æµ‹è¯•ï¼ŸéªŒè¯ä¸æ˜¯æµ‹è¯•çš„å…¨éƒ¨ç›®çš„å—ï¼Ÿ</p>
<p>ç­”æ¡ˆåœ¨äºæµ‹è¯•åº”è¯¥éªŒè¯â€œä»€ä¹ˆâ€ã€‚ **è‰¯å¥½çš„æµ‹è¯•éªŒè¯äº†
ä»£ç çš„å¥‘çº¦ã€‚**å¦‚æœæµ‹è¯•è¿‡åº¦æŒ‡å®šï¼Œåˆ™ä¸ä¼šç•™ä¸‹è¶³å¤Ÿçš„å†…å®¹
å®æ–½çš„è‡ªç”±åº¦ã€‚å› æ­¤ï¼Œæ— éœ€æ”¹å˜å®ç°
è¿åå¥‘çº¦ï¼ˆä¾‹å¦‚é‡æ„å’Œä¼˜åŒ–ï¼‰ï¼Œè¿™åº”è¯¥æ˜¯
åšå¾—å¾ˆå¥½ï¼Œå¯ä»¥æ‰“ç ´è¿™æ ·çš„æµ‹è¯•ã€‚ç„¶åä½ å°±å¾—èŠ±æ—¶é—´å»ä¿®å¤
ä»–ä»¬ï¼Œåªä¼šåœ¨ä¸‹æ¬¡å®æ–½æ›´æ”¹æ—¶çœ‹åˆ°å®ƒä»¬å†æ¬¡æŸåã€‚</p>
<p>è¯·è®°ä½ï¼Œæ— éœ€åœ¨ä¸€é¡¹æµ‹è¯•ä¸­éªŒè¯å¤šä¸ªå±æ€§ã€‚
äº‹å®ä¸Šï¼Œ**åœ¨ä¸€æ¬¡æµ‹è¯•ä¸­ä»…éªŒè¯ä¸€ä»¶äº‹æ˜¯ä¸€ç§å¾ˆå¥½çš„é£æ ¼ã€‚**å¦‚æœæ‚¨è¿™æ ·åš
ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªé”™è¯¯å¯èƒ½åªä¼šç ´åä¸€ä¸¤ä¸ªæµ‹è¯•ï¼Œè€Œä¸æ˜¯å‡ åä¸ªï¼ˆå…¶ä¸­
æ‚¨æ„¿æ„è°ƒè¯•çš„æƒ…å†µå—ï¼Ÿï¼‰ã€‚å¦‚æœæ‚¨ä¹Ÿæœ‰è¿›è¡Œæµ‹è¯•çš„ä¹ æƒ¯
æè¿°æ€§åç§°å‘Šè¯‰ä»–ä»¬éªŒè¯çš„å†…å®¹ï¼Œæ‚¨é€šå¸¸å¯ä»¥è½»æ¾çŒœå‡ºæ˜¯ä»€ä¹ˆ
ä»…ä»æµ‹è¯•æ—¥å¿—æœ¬èº«æ¥çœ‹å°±æ˜¯é”™è¯¯çš„ã€‚</p>
<p>å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨<code>ON_CALL</code>ï¼Œå¹¶ä¸”ä»…åœ¨æ‚¨çœŸæ­£æƒ³è¦æ—¶æ‰ä½¿ç”¨<code>EXPECT_CALL</code>
ä»¥éªŒè¯æ˜¯å¦å·²è¿›è¡Œå‘¼å«ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½æœ‰ä¸€å †<code>ON_CALL</code>
åœ¨æ‚¨çš„æµ‹è¯•è£…ç½®ä¸­è®¾ç½®æ‰€æœ‰æµ‹è¯•å…±äº«çš„é€šç”¨æ¨¡æ‹Ÿè¡Œä¸º
åŒä¸€ç»„ï¼Œå¹¶åœ¨ä¸åŒçš„<code>TEST_F</code>ä¸­å†™å…¥ï¼ˆå‡ ä¹ï¼‰ä¸åŒçš„<code>EXPECT_CALL</code>
éªŒè¯ä»£ç è¡Œä¸ºçš„ä¸åŒæ–¹é¢ã€‚ä¸é£æ ¼ç›¸æ¯”
å…¶ä¸­æ¯ä¸ª<code>TEST</code>éƒ½æœ‰è®¸å¤š<code>EXPECT_CALL</code>ï¼Œè¿™ä¼šå¯¼è‡´æµ‹è¯•æ›´å¤š
èƒ½å¤Ÿé€‚åº”å®æ–½å˜åŒ–ï¼ˆå› æ­¤ä¸å¤ªå¯èƒ½éœ€è¦
ç»´æŠ¤ï¼‰å¹¶ä½¿æµ‹è¯•çš„æ„å›¾æ›´åŠ æ˜æ˜¾ï¼ˆå› æ­¤å®ƒä»¬æ›´å®¹æ˜“
å½“æ‚¨ç¡®å®éœ€è¦ç»´æŠ¤å®ƒä»¬æ—¶è¿›è¡Œç»´æŠ¤  ï¼‰ã€‚</p>
<p>å¦‚æœæ‚¨å¯¹æ‰“å°çš„â€œæ— è¶£çš„æ¨¡æ‹Ÿå‡½æ•°è°ƒç”¨â€æ¶ˆæ¯æ„Ÿåˆ°å›°æ‰°
å½“è°ƒç”¨æ²¡æœ‰ EXPECT_CALL çš„æ¨¡æ‹Ÿæ–¹æ³•æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ NiceMock
ç›¸åï¼Œè¦æŠ‘åˆ¶æ¨¡æ‹Ÿå¯¹è±¡çš„æ‰€æœ‰æ­¤ç±»æ¶ˆæ¯ï¼Œæˆ–è€…æŠ‘åˆ¶
é€šè¿‡æ·»åŠ <code>EXPECT_CALL(...).Times(AnyNumber())</code>æ¥æ˜¾ç¤ºç‰¹å®šæ–¹æ³•çš„æ¶ˆæ¯ã€‚åš
ä¸è¦é€šè¿‡ç›²ç›®æ·»åŠ <code>EXPECT_CALL(...)</code>æ¥æŠ‘åˆ¶å®ƒï¼Œå¦åˆ™æ‚¨å°†è¿›è¡Œæµ‹è¯•
ç»´æŠ¤èµ·æ¥å¾ˆç—›è‹¦ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¿½ç•¥æ— è¶£çš„è°ƒç”¨">å¿½ç•¥æ— è¶£çš„è°ƒç”¨<a href="#å¿½ç•¥æ— è¶£çš„è°ƒç”¨" class="hash-link" aria-label="Direct link to å¿½ç•¥æ— è¶£çš„è°ƒç”¨" title="Direct link to å¿½ç•¥æ— è¶£çš„è°ƒç”¨">â€‹</a></h3>
<p>å¦‚æœæ‚¨å¯¹æ¨¡æ‹Ÿæ–¹æ³•çš„è°ƒç”¨æ–¹å¼ä¸æ„Ÿå…´è¶£ï¼Œè¯·ä¸è¦è¯´
å…³äºå®ƒçš„ä»»ä½•äº‹æƒ…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè¯¥æ–¹æ³•è¢«è°ƒç”¨ï¼ŒkMock å°†
æ‰§è¡Œå…¶é»˜è®¤æ“ä½œä»¥å…è®¸æµ‹è¯•ç¨‹åºç»§ç»­ã€‚å¦‚æœä½ ä¸æ˜¯
å¯¹ kMock é‡‡å–çš„é»˜è®¤æ“ä½œæ„Ÿåˆ°æ»¡æ„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¦†ç›–å®ƒ
<code>DefaultValue&lt;T&gt;::Set()</code>ï¼ˆ<a href="#DefaultValue">æ­¤å¤„</a> æè¿°ï¼‰æˆ– <code>ON_CALL()</code>ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œä¸€æ—¦æ‚¨è¡¨è¾¾äº†å¯¹ç‰¹å®šæ¨¡æ‹Ÿæ–¹æ³•çš„å…´è¶£ï¼ˆé€šè¿‡
<code>EXPECT_CALL()</code>)ï¼Œå¯¹å…¶çš„æ‰€æœ‰è°ƒç”¨éƒ½å¿…é¡»ç¬¦åˆæŸäº›æœŸæœ›ã€‚å¦‚æœè¿™ä¸ª
å‡½æ•°è¢«è°ƒç”¨ä½†å‚æ•°ä¸ä»»ä½•â€œEXPECT_CALL()â€è¯­å¥ä¸åŒ¹é…ï¼Œ
è¿™å°†æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¦æ­¢æ„å¤–call">ç¦æ­¢æ„å¤–<code>call</code><a href="#ç¦æ­¢æ„å¤–call" class="hash-link" aria-label="Direct link to ç¦æ­¢æ„å¤–call" title="Direct link to ç¦æ­¢æ„å¤–call">â€‹</a></h3>
<p>å¦‚æœæ ¹æœ¬ä¸åº”è¯¥è°ƒç”¨æ¨¡æ‹Ÿæ–¹æ³•ï¼Œè¯·æ˜ç¡®è¯´æ˜ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœå…è®¸å¯¹è¯¥æ–¹æ³•çš„æŸäº›è°ƒç”¨ï¼Œä½†å…¶ä½™çš„åˆ™ä¸å…è®¸ï¼Œåˆ™åªéœ€åˆ—å‡ºæ‰€æœ‰
é¢„æœŸæ¥ç”µï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AnyNumber</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Gt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AnyNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¯¹<code>foo.Bar()</code>çš„è°ƒç”¨ä¸ä»»ä½•<code>EXPECT_CALL()</code>è¯­å¥éƒ½ä¸åŒ¹é…
å°†ä¼šå‡ºç°é”™è¯¯ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="uninteresting-vs-unexpected">äº†è§£æ— è¶£ä¸æ„å¤–çš„<code>call</code><a href="#uninteresting-vs-unexpected" class="hash-link" aria-label="Direct link to uninteresting-vs-unexpected" title="Direct link to uninteresting-vs-unexpected">â€‹</a></h3>
<p><em>æ— è¶£</em>è°ƒç”¨å’Œ<em>æ„å¤–</em>è°ƒç”¨åœ¨ kMock ä¸­æ˜¯ä¸åŒçš„æ¦‚å¿µã€‚
<em>éå¸¸</em>ä¸åŒã€‚</p>
<p>å¦‚æœ<em>ç”šè‡³æ²¡æœ‰ä¸€ä¸ª</em>ï¼Œé‚£ä¹ˆè°ƒç”¨ <code>x.Y(...)</code> å°±æ˜¯<strong>æ— è¶£</strong>
<code>EXPECT_CALL(x, Y(...))</code> è®¾ç½®ã€‚æ¢å¥è¯è¯´ï¼Œæµ‹è¯•ä¸æ„Ÿå…´è¶£
æ ¹æœ¬æ²¡æœ‰ <code>x.Y()</code> æ–¹æ³•ï¼Œå¾ˆæ˜æ˜¾æµ‹è¯•å¹¶ä¸åœ¨ä¹è¯´ä»€ä¹ˆ
å…³äºå®ƒã€‚</p>
<p>å¦‚æœæœ‰ <em>ä¸€äº›</em> <code>EXPECT_CALL(x, Y(...)) å·²è®¾ç½®ï¼Œä½†æ²¡æœ‰ä¸€ä¸ªä¸è°ƒç”¨åŒ¹é…ã€‚æ¢å¥è¯è¯´ï¼Œæµ‹è¯•æ˜¯ å¯¹ </code>x.Y()<code>æ–¹æ³•æ„Ÿå…´è¶£ï¼ˆå› æ­¤å®ƒæ˜ç¡®è®¾ç½®äº†ä¸€äº›</code>EXPECT_CALL` æ¥éªŒè¯å®ƒæ˜¯å¦‚ä½•è°ƒç”¨çš„ï¼‰ï¼›ä½†æ˜¯ï¼ŒéªŒè¯å¤±è´¥ï¼Œå› ä¸º
test é¢„è®¡ä¸ä¼šå‘ç”Ÿæ­¤ç‰¹å®šè°ƒç”¨ã€‚</p>
<p>**æ„å¤–çš„è°ƒç”¨å§‹ç»ˆæ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œ**å› ä¸ºè¢«æµ‹è¯•çš„ä»£ç æ²¡æœ‰è¡Œä¸º
æµ‹è¯•æœŸæœ›å®ƒçš„è¡Œä¸ºæ–¹å¼ã€‚</p>
<p>**é»˜è®¤æƒ…å†µä¸‹ï¼Œæ— è¶£çš„è°ƒç”¨ä¸æ˜¯é”™è¯¯ï¼Œ**å› ä¸ºå®ƒè¿åäº†
æµ‹è¯•æŒ‡å®šçš„çº¦æŸã€‚ ï¼ˆkMock çš„ç†å¿µæ˜¯ï¼Œä»€ä¹ˆéƒ½ä¸è¯´
æ„å‘³ç€æ²¡æœ‰é™åˆ¶ã€‚ï¼‰ä½†æ˜¯ï¼Œå®ƒä¼šå¯¼è‡´è­¦å‘Šï¼Œå› ä¸ºå®ƒ<em>å¯èƒ½</em>
æŒ‡å‡ºä¸€ä¸ªé—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œæµ‹è¯•ä½œè€…å¯èƒ½å¿˜è®°æŒ‡å®šä¸€ä¸ª
çº¦æŸï¼‰ã€‚</p>
<p>åœ¨ kMock ä¸­ï¼Œ<code>NiceMock</code> å’Œ <code>StrictMock</code> å¯ç”¨äºä½¿æ¨¡æ‹Ÿç±»â€œniceâ€æˆ–
â€œä¸¥æ ¼çš„â€ã€‚è¿™å¯¹æ— è¶£çš„å‘¼å«å’Œæ„å¤–çš„å‘¼å«æœ‰ä½•å½±å“ï¼Ÿ</p>
<p><strong>niceçš„æ¨¡æ‹Ÿ</strong>æŠ‘åˆ¶æ— è¶£çš„è°ƒç”¨<em>è­¦å‘Š</em>ã€‚å®ƒæ¯”ä¸é‚£ä¹ˆå¥è°ˆ
é»˜è®¤æ¨¡æ‹Ÿï¼Œä½†å…¶ä»–æ–¹é¢æ˜¯ç›¸åŒçš„ã€‚å¦‚æœæµ‹è¯•å› é»˜è®¤è€Œå¤±è´¥
æ¨¡æ‹Ÿï¼Œä½¿ç”¨æ¼‚äº®çš„æ¨¡æ‹Ÿä»£æ›¿ä¹Ÿä¼šå¤±è´¥ã€‚åä¹‹äº¦ç„¶ã€‚åˆ«æŒ‡æœ›
è¿›è¡Œæ¨¡æ‹Ÿå¯ä»¥å¾ˆå¥½åœ°æ”¹å˜æµ‹è¯•ç»“æœã€‚</p>
<p><strong>ä¸¥æ ¼çš„æ¨¡æ‹Ÿ</strong>ä¼šå°†æ— è¶£çš„è°ƒç”¨è­¦å‘Šå˜æˆé”™è¯¯ã€‚æ‰€ä»¥åˆ¶ä½œä¸€ä¸ª
æ¨¡æ‹Ÿä¸¥æ ¼å¯èƒ½ä¼šæ”¹å˜æµ‹è¯•çš„ç»“æœã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NiceMock</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">MockDomainRegistry</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> mock_registry</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_registry</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDomainOwner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;google.com&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Larry Page&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Use mock_registry in code under test.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">mock_registry </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œå”¯ä¸€çš„â€œEXPECT_CALLâ€è¡¨ç¤ºå¯¹â€œGetDomainOwner()â€çš„æ‰€æœ‰è°ƒç”¨éƒ½å¿…é¡»å…·æœ‰
â€œgoogle.comâ€ä½œä¸ºå‚æ•°ã€‚å¦‚æœè°ƒç”¨<code>GetDomainOwner(&quot;yahoo.com&quot;)</code>ï¼Œå®ƒ
å°†æ˜¯ä¸€ä¸ªæ„å¤–çš„è°ƒç”¨ï¼Œå› æ­¤ä¼šå‡ºç°é”™è¯¯ã€‚ <em>æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ¨¡æ‹Ÿå¹¶ä¸
æ›´æ”¹æ„å¤–å‘¼å«çš„ä¸¥é‡ç¨‹åº¦ã€‚</em></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å‘Šè¯‰ kMock å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼è°ƒç”¨ <code>GetDomainOwner()</code>
è®ºç‚¹ä¹Ÿæ˜¯å¦‚æ­¤ï¼Ÿæ ‡å‡†æŠ€æœ¯æ˜¯æ·»åŠ â€œcatch allâ€â€œEXPECT_CALLâ€ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_registry</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDomainOwner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AnyNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// catches all other calls to this method.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_registry</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetDomainOwner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;google.com&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Larry Page&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·è®°ä½ï¼Œâ€œ_â€æ˜¯åŒ¹é…ä»»ä½•å†…å®¹çš„é€šé…ç¬¦åŒ¹é…å™¨ã€‚æœ‰äº†è¿™ä¸ªï¼Œå¦‚æœ
è°ƒç”¨ <code>GetDomainOwner(&quot;google.com&quot;)</code> ï¼Œå®ƒå°†æ‰§è¡Œç¬¬äºŒä¸ªæ“ä½œ
<code>EXPECT_CALL</code> è¯´ï¼›å¦‚æœç”¨ä¸åŒçš„å‚æ•°è°ƒç”¨å®ƒï¼Œå®ƒä¼šåšä»€ä¹ˆ
ç¬¬ä¸€ä¸ªâ€œEXPECT_CALLâ€è¯´ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œä¸¤ä¸ªâ€œEXPECT_CALLâ€çš„é¡ºåºå¾ˆé‡è¦ï¼Œå› ä¸ºä½œä¸ºè¾ƒæ–°çš„
<code>EXPECT_CALL</code> ä¼˜å…ˆäºæ—§çš„ã€‚</p>
<p>æœ‰å…³æ— è¶£çš„è°ƒç”¨ã€æ¼‚äº®çš„æ¨¡æ‹Ÿå’Œä¸¥æ ¼çš„æ¨¡æ‹Ÿçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»
<a href="#NiceStrictNaggy">â€œå‹å–„ã€ä¸¥æ ¼å’Œå” å¨â€</a>ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ParameterlessExpectations">å¿½ç•¥æ— è¶£çš„å‚æ•°<a href="#ParameterlessExpectations" class="hash-link" aria-label="Direct link to å¿½ç•¥æ— è¶£çš„å‚æ•°" title="Direct link to å¿½ç•¥æ— è¶£çš„å‚æ•°">â€‹</a></h3>
<p>å¦‚æœä½ çš„æµ‹è¯•ä¸å…³å¿ƒå‚æ•°ï¼ˆå®ƒåªå…³å¿ƒæ•°å­—
æˆ–è°ƒç”¨é¡ºåºï¼‰ï¼Œæ‚¨é€šå¸¸å¯ä»¥ç®€å•åœ°çœç•¥å‚æ•°åˆ—è¡¨ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Expect foo.Bar( ... ) twice with any arguments.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Delegate to the given method whenever the factory is invoked.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo_factory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MakeFoo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">BuildFooForTest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤åŠŸèƒ½ä»…åœ¨æ–¹æ³•æœªé‡è½½æ—¶å¯ç”¨ï¼›é˜²æ­¢
æ„å¤–è¡Œä¸ºå°è¯•è®¾ç½®æœŸæœ›æ˜¯ä¸€ä¸ªç¼–è¯‘é”™è¯¯
ç‰¹å®šé‡è½½ä¸æ˜ç¡®çš„æ–¹æ³•ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³æ­¤é—®é¢˜
æä¾›æ¯”æ¨¡æ‹Ÿç±»æ›´ç®€å•çš„æ¨¡æ‹Ÿæ¥å£ï¼ˆ#SimplerInterfacesï¼‰
æä¾›ã€‚</p>
<p>å½“å‚æ•°å¾ˆæœ‰è¶£ä½†åŒ¹é…é€»è¾‘æ—¶ï¼Œæ­¤æ¨¡å¼ä¹Ÿå¾ˆæœ‰ç”¨
ç›¸å½“å¤æ‚ã€‚æ‚¨å¯ä»¥ä¸æŒ‡å®šå‚æ•°åˆ—è¡¨å¹¶ä½¿ç”¨
SaveArg æ“ä½œ<a href="#SaveArgVerify">ä¿å­˜å€¼ä»¥ä¾›ä»¥åéªŒè¯</a>ã€‚å¦‚æœ
ä½ è¿™æ ·åšï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åŒºåˆ†è°ƒç”¨è¯¥æ–¹æ³•çš„é”™è¯¯æ•°é‡
ä½¿ç”¨é”™è¯¯çš„å‚æ•°è°ƒç”¨å®ƒçš„æ¬¡æ•°ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="OrderedCalls">æœŸå¾…æœ‰åºè°ƒç”¨<a href="#OrderedCalls" class="hash-link" aria-label="Direct link to æœŸå¾…æœ‰åºè°ƒç”¨" title="Direct link to æœŸå¾…æœ‰åºè°ƒç”¨">â€‹</a></h3>
<p>å°½ç®¡ kMock æ—¶ç¨åå®šä¹‰çš„<code>EXPECT_CALL()</code>è¯­å¥ä¼˜å…ˆ
å°è¯•å°†å‡½æ•°è°ƒç”¨ä¸æœŸæœ›ç›¸åŒ¹é…ï¼Œé»˜è®¤æƒ…å†µä¸‹è°ƒç”¨æ²¡æœ‰
æŒ‰ç…§ç¼–å†™<code>EXPECT_CALL()</code>è¯­å¥çš„é¡ºåºå‘ç”Ÿã€‚ä¾‹å¦‚ï¼Œå¦‚æœ
å‚æ•°ä¸ç¬¬äºŒä¸ª<code>EXPECT_CALL()</code>ä¸­çš„åŒ¹é…å™¨åŒ¹é…ï¼Œä½†ä¸
ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªï¼Œç„¶åå°†ä½¿ç”¨ç¬¬äºŒä¸ªæœŸæœ›ã€‚</p>
<p>å¦‚æœæ‚¨å¸Œæœ›æ‰€æœ‰è°ƒç”¨éƒ½æŒ‰ç…§æœŸæœ›çš„é¡ºåºå‘ç”Ÿï¼Œè¯·è¾“å…¥
å®šä¹‰ç±»å‹å˜é‡çš„å—ä¸­çš„â€œEXPECT_CALL()â€è¯­å¥
<code>æŒ‰é¡ºåº</code>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">InSequence</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    InSequence s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æœŸæœ›è°ƒç”¨<code>foo.DoThis(5)</code>ï¼Œç„¶åè°ƒç”¨ä¸¤æ¬¡
<code>bar.DoThat()</code> å‚æ•°å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼Œåé¢ä¾æ¬¡æ˜¯
å¯¹ <code>foo.DoThis(6)</code> çš„è°ƒç”¨ã€‚å¦‚æœå‘ç”Ÿæ— åºè°ƒç”¨ï¼ŒkMock å°†æŠ¥å‘Š
é”™è¯¯ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="PartialOrder">æœŸå¾…éƒ¨åˆ†æœ‰åºçš„è°ƒç”¨<a href="#PartialOrder" class="hash-link" aria-label="Direct link to æœŸå¾…éƒ¨åˆ†æœ‰åºçš„è°ƒç”¨" title="Direct link to æœŸå¾…éƒ¨åˆ†æœ‰åºçš„è°ƒç”¨">â€‹</a></h3>
<p>æœ‰æ—¶è¦æ±‚ä¸€åˆ‡æŒ‰é¢„å®šé¡ºåºå‘ç”Ÿå¯èƒ½ä¼šå¯¼è‡´
è„†æ€§æµ‹è¯•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½å…³å¿ƒ<code>A</code>å‡ºç°åœ¨<code>B</code>å’Œ<code>B</code>ä¹‹å‰
<code>C</code>ï¼Œä½†å¯¹<code>B</code>å’Œ<code>C</code>çš„ç›¸å¯¹é¡ºåºä¸æ„Ÿå…´è¶£ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ
æµ‹è¯•åº”è¯¥åæ˜ æˆ‘ä»¬çš„çœŸå®æ„å›¾ï¼Œè€Œä¸æ˜¯è¿‡åº¦é™åˆ¶ã€‚</p>
<p>kMock å…è®¸æ‚¨åœ¨æ¨¡å‹ä¸Šæ–½åŠ ä»»æ„ DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰
æ¥ç”µã€‚è¡¨è¾¾ DAG çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨
<code>EXPECT_CALL</code> çš„ <a href="/docs/cpp/base/testing/kt/reference/mocking#EXPECT_CALL.After"><code>After</code> å­å¥</a>ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡â€œInSequence()â€å­å¥ï¼ˆä¸â€œInSequenceâ€ä¸åŒï¼‰
class)ï¼Œæˆ‘ä»¬ä» jMock 2 å€Ÿæ¥çš„ã€‚å®ƒä¸å¦‚ <code>After()</code> çµæ´»ï¼Œä½†æ˜¯
å½“æ‚¨æœ‰å¾ˆé•¿çš„è¿ç»­è°ƒç”¨é“¾æ—¶ä¼šæ›´æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒæ²¡æœ‰
è¦æ±‚ä½ ä¸ºé“¾ä¸­çš„æœŸæœ›æƒ³å‡ºä¸åŒçš„åç§°ã€‚
å®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p>
<p>å¦‚æœ  æˆ‘ä»¬å°†â€œEXPECT_CALL()â€è¯­å¥è§†ä¸ºå›¾ä¸­çš„èŠ‚ç‚¹ï¼Œå¹¶ä»
èŠ‚ç‚¹Aåˆ°èŠ‚ç‚¹Bï¼Œåªè¦Aå¿…é¡»å‡ºç°åœ¨Bä¹‹å‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªDAGã€‚æˆ‘ä»¬ä½¿ç”¨
æœ¯è¯­â€œåºåˆ—â€è¡¨ç¤ºè¯¥ DAG ä¸­çš„æœ‰å‘è·¯å¾„ã€‚ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åˆ†è§£
DAG è½¬åŒ–ä¸ºåºåˆ—ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“æ¯ä¸ªâ€œEXPECT_CALL()â€æ˜¯å“ªäº›åºåˆ—
å±äºä¸ºäº†èƒ½å¤Ÿé‡å»ºåŸå§‹çš„DAGã€‚</p>
<p>å› æ­¤ï¼Œè¦æŒ‡å®šæœŸæœ›çš„ååºï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹ï¼š
é¦–å…ˆå®šä¹‰ä¸€äº›â€œSequenceâ€å¯¹è±¡ï¼Œç„¶åä¸ºæ¯ä¸ªâ€œEXPECT_CALL()â€è¯´
å®ƒå±äºå“ªä¸ªâ€œSequenceâ€å¯¹è±¡ã€‚</p>
<p>ç›¸åŒé¡ºåºçš„æœŸæœ›å¿…é¡»æŒ‰ç…§å®ƒä»¬çš„ä¹¦å†™é¡ºåºå‡ºç°ã€‚ä¸ºäº†
ä¾‹å­ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Sequence</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Sequence s1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">InSequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">B</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">InSequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">C</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">InSequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">D</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">InSequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŒ‡å®šä»¥ä¸‹ DAGï¼ˆå…¶ä¸­â€œs1â€æ˜¯â€œA -&gt; Bâ€ï¼Œâ€œs2â€æ˜¯â€œA -&gt; C -&gt; Dâ€ï¼‰ï¼š</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">       +---&gt; B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  A ---|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       +---&gt; C ---&gt; D</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™æ„å‘³ç€ A å¿…é¡»å‡ºç°åœ¨ B å’Œ C ä¹‹å‰ï¼Œå¹¶ä¸” C å¿…é¡»å‡ºç°åœ¨ D ä¹‹å‰ã€‚
é™¤æ­¤ä¹‹å¤–ï¼Œæ²¡æœ‰å…¶ä»–é¡ºåºé™åˆ¶ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ§åˆ¶æœŸæœ›ä½•æ—¶æ¶ˆå¤±">æ§åˆ¶æœŸæœ›ä½•æ—¶æ¶ˆå¤±<a href="#æ§åˆ¶æœŸæœ›ä½•æ—¶æ¶ˆå¤±" class="hash-link" aria-label="Direct link to æ§åˆ¶æœŸæœ›ä½•æ—¶æ¶ˆå¤±" title="Direct link to æ§åˆ¶æœŸæœ›ä½•æ—¶æ¶ˆå¤±">â€‹</a></h3>
<p>å½“è°ƒç”¨æ¨¡æ‹Ÿæ–¹æ³•æ—¶ï¼ŒkMock åªè€ƒè™‘ä»ç„¶å­˜åœ¨çš„æœŸæœ›
ç§¯æçš„ã€‚æœŸæœ›åœ¨åˆ›å»ºæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œç„¶åå˜ä¸ºéæ´»åŠ¨çŠ¶æ€ï¼ˆåˆå
<em>é€€ä¼‘</em>ï¼‰å½“å‘ç”Ÿç¨åå¿…é¡»å‘ç”Ÿçš„å‘¼å«æ—¶ã€‚ä¾‹å¦‚ï¼Œåœ¨</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Sequence</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Sequence s1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WARNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;File too large.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// #1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AnyNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">InSequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> s2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WARNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Data set is empty.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// #2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">InSequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WARNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;User not found.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// #3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">InSequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸€æ—¦ #2 æˆ– #3 åŒ¹é…ï¼Œ#1 å°†é€€å‡ºã€‚å¦‚æœåœ¨æ­¤ä¹‹åè®°å½•è­¦å‘Š<code>&quot;File too large.&quot;</code>ï¼Œåˆ™è¿™å°†æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>è¯·æ³¨æ„ï¼ŒæœŸæœ›åœ¨é¥±å’Œæ—¶ä¸ä¼šè‡ªåŠ¨æ¶ˆå¤±ã€‚ä¸ºäº†
ä¾‹å­ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WARNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                     </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// #1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WARNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;File too large.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">     </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// #2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¡¨ç¤ºå°†ä¼šå‡ºç°ä¸€ä¸ªè­¦å‘Šï¼Œå…¶ä¸­åŒ…å«æ¶ˆæ¯â€œâ€œFile tooâ€
large.&quot;`ã€‚å¦‚æœç¬¬äºŒä¸ªè­¦å‘Šä¹ŸåŒ…å«æ­¤æ¶ˆæ¯ï¼Œ#2 å°†å†æ¬¡åŒ¹é…
å¹¶å¯¼è‡´è¿åä¸Šé™çš„é”™è¯¯ã€‚</p>
<p>å¦‚æœè¿™ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œä½ å¯ä»¥è¦æ±‚æœŸæœ›å°½å¿«é€€ä¼‘
å˜å¾—é¥±å’Œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WARNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                     </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// #1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WARNING</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;File too large.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// #2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">RetiresOnSaturation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œ #2 åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥å¦‚æœæ‚¨æœ‰ä¸¤ä¸ªè­¦å‘Šæ¶ˆæ¯<code>&quot;File too large.&quot;</code>ï¼Œç¬¬ä¸€ä¸ªå°†åŒ¹é… #2ï¼Œç¬¬äºŒä¸ªå°†åŒ¹é… #1 -
ä¸ä¼šæœ‰é”™è¯¯ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-actions">ä½¿ç”¨ Actions<a href="#using-actions" class="hash-link" aria-label="Direct link to ä½¿ç”¨ Actions" title="Direct link to ä½¿ç”¨ Actions">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å¼•ç”¨">ä»æ¨¡æ‹Ÿæ–¹æ³•  è¿”å›å¼•ç”¨<a href="#ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å¼•ç”¨" class="hash-link" aria-label="Direct link to ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å¼•ç”¨" title="Direct link to ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å¼•ç”¨">â€‹</a></h3>
<p>å¦‚æœæ¨¡æ‹Ÿå‡½æ•°çš„è¿”å›ç±»å‹æ˜¯å¼•ç”¨ï¼Œåˆ™éœ€è¦ä½¿ç”¨â€œReturnRef()â€
è€Œä¸æ˜¯ <code>Return()</code> è¿”å›ç»“æœï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ReturnRef</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Bar</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetBar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Bar bar</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnRef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å®æ—¶å€¼">ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å®æ—¶å€¼<a href="#ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å®æ—¶å€¼" class="hash-link" aria-label="Direct link to ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å®æ—¶å€¼" title="Direct link to ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å®æ—¶å€¼">â€‹</a></h3>
<p><code>Return(x)</code>æ“ä½œåœ¨åˆ›å»ºæ“ä½œæ—¶ä¿å­˜<code>x</code>çš„å‰¯æœ¬ï¼Œå¹¶ä¸”
æ¯å½“æ‰§è¡Œæ—¶æ€»æ˜¯è¿”å›ç›¸åŒçš„å€¼ã€‚æœ‰æ—¶æ‚¨å¯èƒ½æƒ³è¦
ç›¸åï¼Œè¿”å› <code>x</code> çš„ <em>live</em> å€¼ï¼ˆå³ï¼Œå½“
æ“ä½œå·²<em>æ‰§è¡Œ</em>ã€‚ï¼‰ã€‚ä¸ºæ­¤ä½¿ç”¨ <code>ReturnRef()</code> æˆ– <code>ReturnPointee()</code>
ç›®çš„ã€‚</p>
<p>å¦‚æœæ¨¡æ‹Ÿå‡½æ•°çš„è¿”å›ç±»å‹æ˜¯å¼•ç”¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨
<code>ReturnRef(x)</code>ï¼Œå¦‚å‰é¢çš„èœè°±æ‰€ç¤ºï¼ˆâ€œä»æ¨¡æ‹Ÿè¿”å›å¼•ç”¨
æ–¹æ³•â€ï¼‰ã€‚ä½†æ˜¯ï¼ŒkMock ä¸å…è®¸æ‚¨åœ¨æ¨¡æ‹Ÿå‡½æ•°ä¸­ä½¿ç”¨ <code>ReturnRef()</code>
å…¶è¿”å›ç±»å‹ä¸æ˜¯å¼•ç”¨ï¼Œå› ä¸ºè¿™æ ·åšé€šå¸¸è¡¨æ˜ç”¨æˆ·
é”™è¯¯ã€‚é‚£ä¹ˆï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>å°½ç®¡æ‚¨å¯èƒ½ä¼šå—åˆ°è¯±æƒ‘ï¼Œä½†è¯·å‹¿ä½¿ç”¨â€œstd::ref()â€ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetValue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">ref</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Wrong!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">42</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">GetValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸å¹¸çš„æ˜¯ï¼Œå®ƒåœ¨è¿™é‡Œä¸èµ·ä½œç”¨ã€‚ä¸Šé¢çš„ä»£ç å°†å¤±è´¥å¹¶å‡ºç°é”™è¯¯ï¼š</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Value of: foo.GetValue()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Actual: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Expected: 42</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŸå› æ˜¯ <code>Return(*value*)</code> å°† <code>value</code> è½¬æ¢ä¸ºå®é™…çš„è¿”å›ç±»å‹
å½“åŠ¨ä½œè¢«<em>åˆ›å»º</em>æ—¶ï¼Œè€Œä¸æ˜¯å½“å®ƒè¢«åˆ›å»ºæ—¶ï¼Œæ¨¡æ‹Ÿå‡½æ•°çš„
<em>å·²æ‰§è¡Œ</em>ã€‚ ï¼ˆé€‰æ‹©æ­¤è¡Œä¸ºæ˜¯ä¸ºäº†åœ¨â€œvalueâ€ä¸º
å¼•ç”¨ä¸€äº›ä¸´æ—¶å¯¹è±¡çš„ä»£ç†å¯¹è±¡ã€‚ï¼‰å› æ­¤ï¼Œ
å½“ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œ<code>std::ref(x)</code> ä¼šè½¬æ¢ä¸º <code>int</code> å€¼ï¼ˆè€Œä¸æ˜¯ <code>const int&amp;</code>ï¼‰
æœŸæœ›å·²è®¾å®šï¼Œâ€œReturn(std::ref(x))â€å°†å§‹ç»ˆè¿”å› 0ã€‚</p>
<p><code>ReturnPointee(pointer)</code>å°±æ˜¯ä¸“é—¨ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œæä¾›çš„ã€‚å®ƒ
è¿”å›æ“ä½œæ‰§è¡Œæ—¶â€œpointerâ€æŒ‡å‘çš„å€¼ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ReturnPointee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnPointee</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Note the &amp; here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">42</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">GetValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This will succeed now.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç»„åˆactions">ç»„åˆactions<a href="#ç»„åˆactions" class="hash-link" aria-label="Direct link to ç»„åˆactions" title="Direct link to ç»„åˆactions">â€‹</a></h3>
<p>æƒ³è¦åœ¨è°ƒç”¨å‡½æ•°æ—¶åšä¸æ­¢ä¸€ä»¶äº‹å—ï¼Ÿæ²¡å…³ç³»ã€‚ <code>DoAll()</code>
å…è®¸æ‚¨æ¯æ¬¡æ‰§è¡Œä¸€ç³»åˆ—æ“ä½œã€‚ä»…è¿”å›å€¼
å°†ä½¿ç”¨åºåˆ—ä¸­çš„æœ€åä¸€ä¸ªæ“ä½œã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">DoAll</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">DoAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action_1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      action_2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      action_n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="SaveArgVerify">éªŒè¯å¤æ‚çš„å‚æ•°<a href="#SaveArgVerify" class="hash-link" aria-label="Direct link to éªŒè¯å¤æ‚çš„å‚æ•°" title="Direct link to éªŒè¯å¤æ‚çš„å‚æ•°">â€‹</a></h3>
<p>å¦‚æœæ‚¨æƒ³éªŒè¯æ˜¯å¦ä½¿ç”¨ç‰¹å®šå‚æ•°è°ƒç”¨äº†æ–¹æ³•ï¼Œä½†
åŒ¹é…æ ‡å‡†å¾ˆå¤æ‚ï¼Œå¾ˆéš¾åŒºåˆ†
åŸºæ•°å¤±è´¥ï¼ˆè°ƒç”¨æ–¹æ³•çš„æ¬¡æ•°é”™è¯¯ï¼‰å’Œå‚æ•°
åŒ¹é…å¤±è´¥ã€‚åŒæ ·ï¼Œå¦‚æœæ‚¨åŒ¹é…å¤šä¸ªå‚æ•°ï¼Œåˆ™å¯èƒ½ä¸ä¼š
å¾ˆå®¹æ˜“åŒºåˆ†å“ªä¸ªå‚æ•°æœªèƒ½åŒ¹é…ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Not ideal: this could fail because of a problem with arg1 or arg2, or maybe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// just the method wasn&#x27;t called.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SendValues</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ElementsAre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">EqualsProto</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨å¯ä»¥ä¿å­˜å‚æ•°å¹¶å•ç‹¬æµ‹è¯•å®ƒä»¬ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SendValues</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">DoAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SaveArg</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">1</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">actual_array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">SaveArg</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">2</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">actual_proto</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> run the test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actual_array</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ElementsAre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actual_proto</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">EqualsProto</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mocking-side-effects">æ¨¡æ‹Ÿå‰¯ä½œç”¨<a href="#mocking-side-effects" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿå‰¯ä½œç”¨" title="Direct link to æ¨¡æ‹Ÿå‰¯ä½œç”¨">â€‹</a></h3>
<p>æœ‰æ—¶ï¼Œæ–¹æ³•ä¸æ˜¯é€šè¿‡è¿”å›å€¼è€Œæ˜¯é€šè¿‡ä¾§é¢æ¥å±•ç¤ºå…¶æ•ˆæœ
å½±å“ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½ä¼šæ›´æ”¹æŸäº›å…¨å±€çŠ¶æ€æˆ–ä¿®æ”¹è¾“å‡º
äº‰è®ºã€‚è¦æ¨¡æ‹Ÿå‰¯ä½œç”¨ï¼Œé€šå¸¸æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®šä¹‰è‡ªå·±çš„æ“ä½œ
å®ç° <code>::testing::ActionInterface</code>ã€‚</p>
<p>å¦‚æœæ‚¨éœ€è¦åšçš„åªæ˜¯æ›´æ”¹è¾“å‡ºå‚æ•°ï¼Œåˆ™å†…ç½®
<code>SetArgPointee()</code> æ“ä½œå¾ˆæ–¹ä¾¿ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SetArgPointee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockMutator</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Mutator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Mutate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> mutate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockMutator mutator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mutator</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Mutate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SetArgPointee</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">1</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå½“è°ƒç”¨ <code>mutator.Mutate()</code> æ—¶ï¼Œæˆ‘ä»¬ä¼šå°† 5 åˆ†é…ç»™
<code>int</code> å˜é‡ç”±å‚æ•° #1 æŒ‡å‘ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚</p>
<p><code>SetArgPointee()</code> æ–¹ä¾¿åœ°åˆ›å»ºæ‚¨ä¼ é€’ç»™çš„å€¼çš„å†…éƒ¨å‰¯æœ¬
å®ƒï¼Œæ¶ˆé™¤äº†ä¿æŒä»·å€¼åœ¨èŒƒå›´å†…å¹¶ä¿æŒæ´» åŠ›çš„éœ€è¦ã€‚å…¶å«ä¹‰
ç„¶è€Œï¼Œè¯¥å€¼å¿…é¡»å…·æœ‰å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ã€‚</p>
<p>å¦‚æœæ¨¡æ‹Ÿæ–¹æ³•ä¹Ÿéœ€è¦è¿”å›ä¸€ä¸ªå€¼ï¼Œæ‚¨å¯ä»¥é“¾æ¥
<code>SetArgPointee()</code> å’Œ <code>Return()</code> ä½¿ç”¨ <code>DoAll()</code>ï¼Œè®°å¾—æŠŠ
æœ€å <code>Return()</code> è¯­å¥ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">DoAll</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SetArgPointee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockMutator</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Mutator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MutateInt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockMutator mutator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mutator</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MutateInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">DoAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SetArgPointee</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½†è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨ä½¿ç”¨<code>ReturnOKWith()</code>æ–¹æ³•ï¼Œå®ƒå°†è¦†ç›–
å‡½æ•°çš„å“åº”å‚æ•°ä¸­ç”± <code>SetArgPointee()</code> æä¾›çš„å€¼
ç§°å‘¼ã€‚</p>
<p>å¦‚æœè¾“å‡ºå‚æ•°æ˜¯æ•°ç»„ï¼Œè¯·ä½¿ç”¨<code>SetArrayArgument&lt;N&gt;(first, last)</code>
è¡ŒåŠ¨ä»£æ›¿ã€‚å®ƒå°†æºèŒƒå›´<code>[first,last)</code>ä¸­çš„å…ƒç´ å¤åˆ¶åˆ°
ç¬¬ N ä¸ªï¼ˆä» 0 å¼€å§‹ï¼‰å‚æ•°æŒ‡å‘çš„æ•°ç»„ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">NotNull</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SetArrayArgument</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockArrayMutator</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">ArrayMutator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Mutate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> num_values</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockArrayMutator mutator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> values</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mutator</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Mutate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SetArrayArgument</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> values </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“å‚æ•°æ˜¯è¾“å‡ºè¿­ä»£å™¨æ—¶ï¼Œè¿™ä¹Ÿé€‚ç”¨ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SetArrayArgument</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockRolodex</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Rolodex</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetNames</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">back_insert_iterator</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockRolodex rolodex</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vector</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">string</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> names </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;George&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;John&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Thomas&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rolodex</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">GetNames</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SetArrayArgument</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">names</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">begin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> names</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ ¹æ®çŠ¶æ€æ›´æ”¹æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸º">æ ¹æ®çŠ¶æ€æ›´æ”¹æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸º<a href="#æ ¹æ®çŠ¶æ€æ›´æ”¹æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸º" class="hash-link" aria-label="Direct link to æ ¹æ®çŠ¶æ€æ›´æ”¹æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸º" title="Direct link to æ ¹æ®çŠ¶æ€æ›´æ”¹æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸º">â€‹</a></h3>
<p>å¦‚æœæ‚¨å¸Œæœ›è°ƒç”¨æ”¹å˜æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸ºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨
<code>::testing::InSequence</code> æŒ‡å®šä¹‹å‰å’Œä¹‹åçš„ä¸åŒè¡Œä¸º
ç§°å‘¼ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">InSequence</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     InSequence seq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsDirty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Flush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsDirty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  my_mock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">FlushIfDirty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ä½¿å¾—<code>my_mock.IsDirty()</code>åœ¨è°ƒç”¨<code>my_mock.Flush()</code>ä¹‹å‰è¿”å›<code>true</code>
ç„¶åè¿”å›<code>false</code>ã€‚</p>
<p>å¦‚æœè¡Œä¸ºå˜åŒ–æ›´å¤æ‚ï¼Œæ‚¨å¯ä»¥å°†æ•ˆæœå­˜å‚¨åœ¨å˜é‡ä¸­
å¹¶ä½¿æ¨¡æ‹Ÿæ–¹æ³•ä»è¯¥å˜é‡è·å–å…¶è¿”å›å€¼ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SaveArg</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">ACTION_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReturnPointee</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> previous_value </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GetPrevValue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnPointee</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">previous_value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> UpdateValue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SaveArg</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">previous_value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  my_mock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoSomethingToUpdateValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œ <code>my_mock.GetPrevValue()</code> å°†å§‹ç»ˆè¿”å›æœ€åä¸€ä¸ªçš„å‚æ•°
<code>UpdateValue()</code> è°ƒç”¨ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="DefaultValue">è®¾ç½®è¿”å›ç±»å‹çš„é»˜è®¤å€¼<a href="#DefaultValue" class="hash-link" aria-label="Direct link to è®¾ç½®è¿”å›ç±»å‹çš„é»˜è®¤å€¼" title="Direct link to è®¾ç½®è¿”å›ç±»å‹çš„é»˜è®¤å€¼">â€‹</a></h3>
<p>å¦‚æœæ¨¡æ‹Ÿæ–¹æ³•çš„è¿”å›ç±»å‹æ˜¯å†…ç½®çš„ C++ ç±»å‹æˆ–æŒ‡é’ˆï¼Œåˆ™é»˜è®¤æƒ…å†µä¸‹å®ƒ
è°ƒç”¨æ—¶å°†è¿”å› 0ã€‚å¦å¤–ï¼Œåœ¨ C++ 11 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œæ¨¡æ‹Ÿæ–¹æ³•çš„
è¿”å›ç±»å‹å…·æœ‰é»˜è®¤æ„é€ å‡½æ•°å°†è¿”å›é»˜è®¤æ„é€ çš„å€¼
é»˜è®¤ã€‚å¦‚æœæ­¤é»˜è®¤å€¼ä¸èµ·ä½œç”¨ï¼Œæ‚¨åªéœ€æŒ‡å®šä¸€ä¸ªæ“ä½œ
ä¸ºä½ ã€‚</p>
<p>æœ‰æ—¶ï¼Œæ‚¨å¯èƒ½æƒ³è¦æ›´æ”¹æ­¤é»˜è®¤å€¼ï¼Œæˆ–è€…æ‚¨å¯èƒ½æƒ³è¦æŒ‡å®š
kMock ä¸çŸ¥é“çš„ç±»å‹çš„é»˜è®¤å€¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨
<code>::testing::DefaultValue</code> ç±»æ¨¡æ¿ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">DefaultValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CalculateBar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Bar default_bar</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Sets the default return value for type Bar.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name" style="color:#116329">DefaultValue</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Bar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default_bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// We don&#x27;t need to specify an action here, as the default</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// return value works for us.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">CalculateBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">CalculateBar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This should return default_bar.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Unsets the default return value.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name" style="color:#116329">DefaultValue</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Bar</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">Clear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œæ›´æ”¹ç±»å‹çš„é»˜è®¤å€¼å¯èƒ½ä¼šä½¿æ‚¨çš„æµ‹è¯•å˜å¾—å›°éš¾
å»ç†è§£ã€‚æˆ‘ä»¬å»ºè®®æ‚¨è°¨æ…ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œ
æ‚¨å¯èƒ½éœ€è¦ç¡®ä¿â€œSet()â€å’Œâ€œClear()â€è°ƒç”¨å°±åœ¨
ä½¿ç”¨æ‚¨çš„æ¨¡æ‹Ÿçš„ä»£ç ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="è®¾ç½®æ¨¡æ‹Ÿæ–¹æ³•çš„é»˜è®¤æ“ä½œ">è®¾ç½®æ¨¡æ‹Ÿæ–¹æ³•çš„é»˜è®¤æ“ä½œ<a href="#è®¾ç½®æ¨¡æ‹Ÿæ–¹æ³•çš„é»˜è®¤æ“ä½œ" class="hash-link" aria-label="Direct link to è®¾ç½®æ¨¡æ‹Ÿæ–¹æ³•çš„é»˜è®¤æ“ä½œ" title="Direct link to è®¾ç½®æ¨¡æ‹Ÿæ–¹æ³•çš„é»˜è®¤æ“ä½œ">â€‹</a></h3>
<p>æ‚¨å·²ç»äº†è§£äº†å¦‚ä½•æ›´æ”¹ç»™å®šç±»å‹çš„é»˜è®¤å€¼ã€‚ç„¶è€Œï¼Œè¿™
å¯¹äºæ‚¨çš„ç›®çš„æ¥è¯´å¯èƒ½å¤ªç²—ç³™ï¼šä¹Ÿè®¸æ‚¨æœ‰ä¸¤ä¸ªæ¨¡æ‹Ÿæ–¹æ³•
ç›¸åŒçš„è¿”å›ç±»å‹ï¼Œå¹¶ä¸”æ‚¨å¸Œæœ›å®ƒä»¬å…·æœ‰ä¸åŒçš„è¡Œä¸ºã€‚ <code>ON_CALL()</code>
å®å…è®¸æ‚¨åœ¨æ–¹æ³•çº§åˆ«è‡ªå®šä¹‰æ¨¡æ‹Ÿçš„è¡Œä¸ºï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">AnyNumber</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Gt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">ON_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Gt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillByDefault</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">AnyNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This should return 1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This should return -1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Sign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This should return 0.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­£å¦‚æ‚¨å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œå½“æœ‰å¤šä¸ªâ€œON_CALL()â€è¯­å¥æ—¶ï¼Œ
é¡ºåºä¸­è¾ƒæ–°çš„ä¼˜å…ˆäºè¾ƒæ—§çš„ã€‚æ¢å¥è¯è¯´ï¼Œ
å°†ä½¿ç”¨ä¸å‡½æ•°å‚æ•°åŒ¹é…çš„<strong>æœ€åä¸€ä¸ª</strong>ã€‚è¿™ä¸ªæ­é…
order å…è®¸æ‚¨åœ¨æ¨¡æ‹Ÿå¯¹è±¡çš„æ„é€ å‡½æ•°ä¸­è®¾ç½®å¸¸è§è¡Œä¸ºæˆ–
æµ‹è¯•è£…ç½®çš„è®¾ç½®é˜¶æ®µï¼Œå¹¶åœ¨ç¨åä¸“é—¨åŒ–æ¨¡æ‹Ÿçš„è¡Œä¸ºã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code>ON_CALL</code> å’Œ <code>EXPECT_CALL</code> éƒ½æœ‰ç›¸åŒçš„â€œåé¢çš„è¯­å¥
ä¼˜å…ˆâ€è§„åˆ™ï¼Œä½†å®ƒä»¬ä¸äº¤äº’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>EXPECT_CALL</code> æœ‰å®ƒä»¬çš„
è‡ªå·±çš„ä¼˜å…ˆé¡ºåºä¸â€œON_CALLâ€ä¼˜å…ˆé¡ºåºä¸åŒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="FunctionsAsActions">ä½¿ç”¨å‡½æ•°/æ–¹æ³•/å‡½å­/Lambda ä½œä¸ºactions<a href="#FunctionsAsActions" class="hash-link" aria-label="Direct link to ä½¿ç”¨å‡½æ•°/æ–¹æ³•/å‡½å­/Lambda ä½œä¸ºactions" title="Direct link to ä½¿ç”¨å‡½æ•°/æ–¹æ³•/å‡½å­/Lambda ä½œä¸ºactions">â€‹</a></h3>
<p>å¦‚æœå†…ç½®æ“ä½œä¸é€‚åˆæ‚¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç°æœ‰çš„å¯è°ƒç”¨æ“ä½œ
(function, <code>std::function</code>, method, functor, lambda) ä½œä¸ºä¸€ä¸ªåŠ¨ä½œã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Sum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ComplexJob</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">CalculateSum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Sum3</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> z</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> y </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> z</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Helper</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ComplexJob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Helper helper</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">CalculateSum</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NewPermanentCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Sum3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ComplexJob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">helper</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">Helper</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ComplexJob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Invokes CalculateSum(5, 6).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Invokes Sum3(1, 2, 3).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ComplexJob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Invokes helper.ComplexJob(10).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ComplexJob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Invokes the inline lambda.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å”¯ä¸€çš„è¦æ±‚æ˜¯å‡½æ•°çš„ç±»å‹ç­‰å¿…é¡»<em>å…¼å®¹</em>
å¸¦æœ‰æ¨¡æ‹Ÿå‡½æ•°çš„ç­¾åï¼Œæ„å‘³ç€åè€…çš„å‚æ•°ï¼ˆå¦‚æœ
å®ƒéœ€è¦ä»»ä½•ï¼‰å¯ä»¥éšå¼è½¬æ¢ä¸ºç›¸åº”çš„å‚æ•°
å‰è€…çš„è¿”å›ç±»å‹å¯ä»¥éšå¼è½¬æ¢ä¸º
åè€…ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥è°ƒç”¨ä¸ç±»å‹<em>ä¸</em>å®Œå…¨ç›¸åŒçš„ä¸œè¥¿
æ¨¡æ‹Ÿå‡½æ•°ï¼Œåªè¦è¿™æ ·åšæ˜¯å®‰å…¨çš„ - å¾ˆå¥½ï¼Œå¯¹å§ï¼Ÿ</p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>è¯¥æ“ä½œæ‹¥æœ‰å›è°ƒçš„æ‰€æœ‰æƒï¼Œå¹¶ä¸”å½“
è¡ŒåŠ¨æœ¬èº«å°±è¢«ç ´åäº†ã€‚</li>
<li>å¦‚æœå›è°ƒçš„ç±»å‹æ´¾ç”Ÿè‡ªåŸºæœ¬å›è°ƒç±»å‹â€œCâ€ï¼Œåˆ™éœ€è¦
å°†å…¶éšå¼è½¬æ¢ä¸ºâ€œCâ€ä»¥è§£å†³é‡è½½é—®é¢˜ï¼Œä¾‹å¦‚<!-- -->
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ResultCallback</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> is_ok </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is_ok</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This works.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BlockingClosure</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> done </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> BlockingClosure</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">implicit_cast</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Closure</span><span class="token generic-function generic class-name operator" style="color:#D73A49">*</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">done</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The cast is necessary.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>###ä½¿ç”¨å¸¦æœ‰é¢å¤–ä¿¡æ¯çš„å‡½æ•°ä½œä¸ºactions</p>
<p>ä½¿ç”¨ Invoke() è°ƒç”¨çš„å‡½æ•°æˆ–å‡½å­å¿…é¡»å…·æœ‰ç›¸åŒæ•°é‡çš„
å‚æ•°ä½œä¸ºæ‚¨ä½¿ç”¨å®ƒçš„æ¨¡æ‹Ÿå‡½æ•°ã€‚æœ‰æ—¶ä½ å¯èƒ½æœ‰ä¸€ä¸ªåŠŸèƒ½
è¿™éœ€è¦æ›´å¤šå‚æ•°ï¼Œå¹¶ä¸”æ‚¨æ„¿æ„ä¼ é€’é¢å¤–çš„å‚æ•°
è‡ªå·±æ¥å¡«è¡¥è¿™ä¸ªç©ºç™½ã€‚æ‚¨å¯ä»¥åœ¨ kMock ä¸­ä½¿ç”¨å›è°ƒæ¥æ‰§è¡Œæ­¤æ“ä½œ
é¢„å…ˆç»‘å®šçš„å‚æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">char</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">char</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">SignOfSum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> sum </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sum </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> </span><span class="token char">&#x27;+&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sum </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> </span><span class="token char">&#x27;-&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token char">&#x27;0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST_F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FooTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NewPermanentCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SignOfSum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;+&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Invokes SignOfSum(5, 2).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="invoking-a-functionmethodfunctorlambdacallback-without-arguments">Invoking a Function/Method/Functor/Lambda/Callback Without Arguments<a href="#invoking-a-functionmethodfunctorlambdacallback-without-arguments" class="hash-link" aria-label="Direct link to Invoking a Function/Method/Functor/Lambda/Callback Without Arguments" title="Direct link to Invoking a Function/Method/Functor/Lambda/Callback Without Arguments">â€‹</a></h3>
<p><code>Invoke()</code> å°†æ¨¡æ‹Ÿå‡½æ•°çš„å‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œç­‰ç­‰
è°ƒç”¨ï¼Œä»¥ä¾¿è¢«è°ƒç”¨è€…å…·æœ‰è¦ä½¿ç”¨çš„è°ƒç”¨çš„å®Œæ•´ä¸Šä¸‹æ–‡ã€‚å¦‚æœ
è¢«è°ƒç”¨çš„å‡½æ•°å¯¹éƒ¨åˆ†æˆ–å…¨éƒ¨å‚æ•°ä¸æ„Ÿå…´è¶£ï¼Œå®ƒå¯ä»¥
ç®€å•åœ°å¿½ç•¥å®ƒä»¬ã€‚</p>
<p>ç„¶è€Œï¼Œä¸€ä¸ªå¸¸è§çš„æ¨¡å¼æ˜¯æµ‹è¯•ä½œè€…æƒ³è¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°è€Œä¸éœ€è¦
æ¨¡æ‹Ÿå‡½æ•°çš„å‚æ•°ã€‚å¥¹å¯ä»¥ä½¿ç”¨åŒ…è£…å‡½æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹
åœ¨è°ƒç”¨ä¸‹åˆ’çº¿ç©ºå‡½æ•°ä¹‹å‰ä¸¢å¼ƒå‚æ•°ã€‚
ä¸ç”¨è¯´ï¼Œè¿™å¯èƒ½å¾ˆä¹å‘³å¹¶ä¸”æ¨¡ç³Šäº†æµ‹è¯•çš„æ„å›¾ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆã€‚é¦–å…ˆï¼Œæ‚¨å¯ä»¥ä¼ é€’ä»»ä½•å¯è°ƒç”¨çš„
é›¶å‚æ•°ä½œä¸ºåŠ¨ä½œã€‚æˆ–è€…ï¼Œä½¿ç”¨â€œInvokeWithoutArgs()â€ï¼Œå°±åƒ
<code>Invoke()</code> ä¸åŒä¹‹å¤„åœ¨äºå®ƒä¸ä¼šå°†æ¨¡æ‹Ÿå‡½æ•°çš„å‚æ•°ä¼ é€’ç»™
è¢«è°ƒç”¨è€…ã€‚ä¸‹é¢æ˜¯æ¯ä¸ªçš„ç¤ºä¾‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">InvokeWithoutArgs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ComplexJob</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Job1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Job2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ComplexJob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Job1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">InvokeWithoutArgs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NewPermanentCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Job2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token char">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ComplexJob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Invokes Job1().</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ComplexJob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Invokes Job2(5, &#x27;a&#x27;).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>
<p>è¯¥æ“ä½œæ‹¥æœ‰å›è°ƒçš„æ‰€æœ‰æƒï¼Œå¹¶ä¸”å½“
è¡ŒåŠ¨æœ¬èº«å°±è¢«ç ´åäº†ã€‚</p>
</li>
<li>
<p>å¦‚æœå›è°ƒçš„ç±»å‹æ´¾ç”Ÿè‡ªåŸºæœ¬å›è°ƒç±»å‹â€œCâ€ï¼Œåˆ™éœ€è¦
å°†å…¶éšå¼è½¬æ¢ä¸ºâ€œCâ€ä»¥è§£å†³é‡è½½é—®é¢˜ï¼Œä¾‹å¦‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">InvokeWithoutArgs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ResultCallback</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> is_ok </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">InvokeWithoutArgs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is_ok</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// This works.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BlockingClosure</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> done </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">InvokeWithoutArgs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">implicit_cast</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Closure</span><span class="token generic-function generic class-name operator" style="color:#D73A49">*</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">done</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The cast is necessary.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="è°ƒç”¨-mock-å‡½æ•°çš„å‚æ•°">è°ƒç”¨ Mock å‡½æ•°çš„å‚æ•°<a href="#è°ƒç”¨-mock-å‡½æ•°çš„å‚æ•°" class="hash-link" aria-label="Direct link to è°ƒç”¨ Mock å‡½æ•°çš„å‚æ•°" title="Direct link to è°ƒç”¨ Mock å‡½æ•°çš„å‚æ•°">â€‹</a></h3>
<p>æœ‰æ—¶ï¼Œæ¨¡æ‹Ÿå‡½æ•°ä¼šæ¥æ”¶ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€ä¸€ä¸ªå‡½å­ï¼ˆåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼‰
è¯ï¼Œâ€œå¯è°ƒç”¨â€ï¼‰ä½œä¸ºå‚æ•°ï¼Œä¾‹å¦‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ResultCallback1</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> callback</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½ å¯èƒ½æƒ³è°ƒç”¨è¿™ä¸ªå¯è°ƒç”¨å‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Will execute callback-&gt;Run(5), where callback is the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// second argument DoThis() receives.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¿½ç•¥æ“ä½œçš„ç»“æœ">å¿½ç•¥æ“ä½œçš„ç»“æœ<a href="#å¿½ç•¥æ“ä½œçš„ç»“æœ" class="hash-link" aria-label="Direct link to å¿½ç•¥æ“ä½œçš„ç»“æœ" title="Direct link to å¿½ç•¥æ“ä½œçš„ç»“æœ">â€‹</a></h3>
<p>æœ‰æ—¶ä½ æœ‰ä¸€ä¸ªè¿”å›<em>æŸäº›ä¸œè¥¿</em>çš„æ“ä½œï¼Œä½†ä½ éœ€è¦ä¸€ä¸ªæ“ä½œ
è¿”å›<code>void</code>ï¼ˆä¹Ÿè®¸æ‚¨æƒ³åœ¨è¿”å›çš„æ¨¡æ‹Ÿå‡½æ•°ä¸­ä½¿ç”¨å®ƒ
<code>void</code>ï¼Œæˆ–è€…å¯èƒ½éœ€è¦åœ¨ <code>DoAll()</code> ä¸­ä½¿ç”¨å®ƒï¼Œå¹¶ä¸”å®ƒä¸æ˜¯æœ€åä¸€ä¸ª
åˆ—è¡¨ï¼‰ã€‚ <code>IgnoreResult()</code> å¯ä»¥è®©ä½ åšåˆ°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">DoAll</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">IgnoreResult</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> MyData</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string </span><span class="token function" style="color:#8250DF">DoSomething</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Abc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> MyData</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Xyz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Abc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// .WillOnce(Invoke(Process));</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The above line won&#x27;t compile as Process() returns int but Abc() needs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// to return void.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IgnoreResult</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Xyz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">DoAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IgnoreResult</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DoSomething</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Ignores the string DoSomething() returns.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œæ‚¨<strong>ä¸èƒ½</strong>å¯¹å·²è¿”å›çš„æ“ä½œä½¿ç”¨â€œIgnoreResult()â€
â€˜æ— æ•ˆâ€™ã€‚è¿™æ ·åšä¼šå¯¼è‡´éš¾çœ‹çš„ç¼–è¯‘å™¨é”™è¯¯ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="SelectingArgs">é€‰æ‹©æ“ä½œçš„å‚æ•°<a href="#SelectingArgs" class="hash-link" aria-label="Direct link to é€‰æ‹©æ“ä½œçš„å‚æ•°" title="Direct link to é€‰æ‹©æ“ä½œçš„å‚æ•°">â€‹</a></h3>
<p>å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå¸¦æœ‰ä¸ƒä¸ªå‚æ•°çš„æ¨¡æ‹Ÿå‡½æ•°â€œFoo()â€ï¼Œå¹¶ä¸”æ‚¨æœ‰ä¸€ä¸ª
è°ƒç”¨â€œFoo()â€æ—¶è¦è°ƒç”¨çš„è‡ªå®šä¹‰æ“ä½œã€‚é—®é¢˜æ˜¯ï¼Œ
è‡ªå®šä¹‰æ“ä½œåªéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> visible</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">pair</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> weight</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> min_weight</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> max_wight</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsVisibleInQuadrant1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> visible</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> visible </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> y </span><span class="token operator" style="color:#D73A49">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">IsVisibleInQuadrant1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Uh, won&#x27;t compile. :-(</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸ºäº†å–æ‚¦ç¼–è¯‘å™¨ä¸Šå¸ï¼Œä½ éœ€è¦å®šä¹‰ä¸€ä¸ªå…·æœ‰ç›¸åŒåŠŸèƒ½çš„â€œé€‚é…å™¨â€
ç­¾åä¸º <code>Foo()</code> å¹¶ä½¿ç”¨æ­£ç¡®çš„å‚æ•°è°ƒç”¨è‡ªå®šä¹‰æ“ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MyIsVisibleInQuadrant1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> visible</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> map</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">pair</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> weight</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> min_weight</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> max_wight</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsVisibleInQuadrant1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">visible</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MyIsVisibleInQuadrant1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Now it works.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½†è¿™ä¸æ˜¯å¾ˆå°´å°¬å—ï¼Ÿ</p>
<p>kMock æä¾›äº†ä¸€ä¸ªé€šç”¨çš„â€œåŠ¨ä½œé€‚é…å™¨â€ï¼Œå› æ­¤æ‚¨å¯ä»¥èŠ±æ—¶é—´å…³æ³¨
æ¯”ç¼–å†™è‡ªå·±çš„é€‚é…å™¨æ›´é‡è¦çš„äº‹æƒ…ã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token generic-function function" style="color:#8250DF">WithArgs</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">N1</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> N2</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> Nk</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åˆ›å»ºä¸€ä¸ªåŠ¨ä½œï¼Œåœ¨ç»™å®šçš„ä½ç½®ä¼ é€’æ¨¡æ‹Ÿå‡½æ•°çš„å‚æ•°
å¯¹å†…éƒ¨â€œactionâ€è¿›è¡Œç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰å¹¶æ‰§è¡Œå®ƒã€‚ä½¿ç”¨â€œWithArgsâ€ï¼Œæˆ‘ä»¬çš„
åŸæ¥çš„ä¾‹å­å¯ä»¥å†™æˆï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">WithArgs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">WithArgs</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name number" style="color:#005CC5">2</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name number" style="color:#005CC5">3</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">IsVisibleInQuadrant1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// No need to define your own adaptor.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸ºäº†æ›´å¥½çš„å¯è¯»æ€§ï¼ŒkMock è¿˜ä¸ºæ‚¨æä¾›ï¼š</p>
<ul>
<li><code>WithoutArgs(action)</code> å½“å†…éƒ¨ <code>action</code> æ²¡æœ‰*å‚æ•°æ—¶ï¼Œå¹¶ä¸”</li>
<li>å½“å†…éƒ¨â€œactionâ€æ‰§è¡Œæ—¶ï¼Œ<code>WithArg&lt;N&gt;(action)</code>ï¼ˆ<code>Arg</code>ä¹‹åæ²¡æœ‰<code>s</code>ï¼‰
<em>ä¸€ä¸ª</em>å‚æ•°ã€‚</li>
</ul>
<p>æ‚¨å¯èƒ½å·²ç»æ„è¯†åˆ°ï¼Œâ€œInvokeWithoutArgs(...)â€åªæ˜¯è¯­æ³•ç³–
<code>WithoutArgs(Invoke(...))</code>ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ›´å¤šæç¤ºï¼š</p>
<ul>
<li><code>WithArgs</code> å’Œæœ‹å‹ä¸­ä½¿ç”¨çš„å†…éƒ¨åŠ¨ä½œä¸å¿…æ˜¯
<code>Invoke()</code>â€”â€”å®ƒå¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ã€‚</li>
<li>å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥åœ¨å‚æ•°åˆ—è¡¨ä¸­é‡å¤ä¸€ä¸ªå‚æ•°ï¼Œä¾‹å¦‚
<code>WithArgs&lt;2, 3, 3, 5&gt;(...)</code>ã€‚</li>
<li>æ‚¨å¯ä»¥æ›´æ”¹å‚æ•°çš„é¡ºåºï¼Œä¾‹å¦‚<code>WithArgs&lt;3, 2, 1&gt;(...)</code>ã€‚</li>
<li>æ‰€é€‰å‚æ•°çš„ç±»å‹<em>ä¸å¿…</em>å¿…é¡»ä¸
å†…åœ¨çš„åŠ¨ä½œå®Œå…¨ä¸€æ ·ã€‚åªè¦å®ƒä»¬å¯ä»¥éšå¼åœ°å­˜åœ¨ï¼Œå®ƒå°±æœ‰æ•ˆ
è½¬æ¢ä¸ºå†…éƒ¨æ“ä½œçš„ç›¸åº”å‚æ•°ã€‚ä¾‹å¦‚ï¼Œ
å¦‚æœæ¨¡æ‹Ÿå‡½æ•°çš„ç¬¬å››ä¸ªå‚æ•°æ˜¯â€œintâ€å¹¶ä¸”â€œmy_actionâ€é‡‡ç”¨
<code>double</code>ã€<code>WithArg&lt;4&gt;(my_action)</code> éƒ½å¯ä»¥ã€‚</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¿½ç•¥æ“ä½œå‡½æ•°ä¸­çš„å‚æ•°">å¿½ç•¥æ“ä½œå‡½æ•°ä¸­çš„å‚æ•°<a href="#å¿½ç•¥æ“ä½œå‡½æ•°ä¸­çš„å‚æ•°" class="hash-link" aria-label="Direct link to å¿½ç•¥æ“ä½œå‡½æ•°ä¸­çš„å‚æ•°" title="Direct link to å¿½ç•¥æ“ä½œå‡½  æ•°ä¸­çš„å‚æ•°">â€‹</a></h3>
<p><a href="#SelectingArgs">é€‰æ‹©æ“ä½œçš„å‚æ•°</a> é…æ–¹å‘æˆ‘ä»¬å±•ç¤ºäº†ä¸€ç§æ–¹æ³•
ä½¿æ¨¡æ‹Ÿå‡½æ•°å’Œå…·æœ‰ä¸å…¼å®¹å‚æ•°åˆ—è¡¨çš„æ“ä½œé€‚åˆ
ä¸€èµ·ã€‚ç¼ºç‚¹æ˜¯ï¼Œå°†æ“ä½œåŒ…è£…åœ¨ <code>WithArgs&lt;...&gt;()</code> ä¸­ä¼šå¾—åˆ°
å¯¹äºç¼–å†™æµ‹è¯•çš„äººæ¥è¯´å¾ˆä¹å‘³ã€‚</p>
<p>å¦‚æœæ‚¨æ­£åœ¨å®šä¹‰è¦ä½¿ç”¨çš„å‡½æ•°ï¼ˆæˆ–æ–¹æ³•ã€å‡½å­ã€lambdaã€å›è°ƒï¼‰
ä½¿ç”¨ <code>Invoke*()</code>ï¼Œå¹¶ä¸”æ‚¨å¯¹å…¶æŸäº›å‚æ•°ä¸æ„Ÿå…´è¶£ï¼Œ
<code>WithArgs</code> çš„æ›¿ä»£æ–¹æ³•æ˜¯å°†æ— ç”¨çš„å‚æ•°å£°æ˜ä¸º <code>Unused</code>ã€‚
è¿™ä½¿å¾—å®šä¹‰åœ¨ä»¥ä¸‹ç±»å‹çš„æƒ…å†µä¸‹ä¸é‚£ä¹ˆæ··ä¹±å’Œä¸é‚£ä¹ˆè„†å¼±ï¼š
æ— è¶£çš„äº‰è®ºå‘ç”Ÿäº†å˜åŒ–ã€‚å®ƒè¿˜å¯ä»¥å¢åŠ è¡ŒåŠ¨çš„æœºä¼š
åŠŸèƒ½å¯ä»¥é‡å¤ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œç»™å®š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">double</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> label</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">double</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>instead of</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DistanceToOriginWithLabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> label</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> y</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DistanceToOriginWithIndex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> y</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DistanceToOriginWithLabel</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DistanceToOriginWithIndex</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½ å¯ä»¥å†™</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Invoke</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Unused</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DistanceToOrigin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Unused</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> y</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DistanceToOrigin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DistanceToOrigin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sharing-actions">Sharing Actions<a href="#sharing-actions" class="hash-link" aria-label="Direct link to Sharing Actions" title="Direct link to Sharing Actions">â€‹</a></h3>
<p>å°±åƒåŒ¹é…å™¨ä¸€æ ·ï¼ŒkMock åŠ¨ä½œå¯¹è±¡ç”±ä¸€ä¸ªæŒ‡å‘å¼•ç”¨è®¡æ•°çš„æŒ‡é’ˆç»„æˆ
å®æ–½å¯¹è±¡ã€‚å› æ­¤å¤åˆ¶æ“ä½œä¹Ÿæ˜¯å…è®¸çš„å¹¶ä¸”éå¸¸
é«˜æ•ˆçš„ã€‚å½“å¼•ç”¨å®ç°å¯¹è±¡çš„æœ€åä¸€ä¸ªæ“ä½œç»ˆæ­¢æ—¶ï¼Œ
å®ç°å¯¹è±¡å°†è¢«åˆ é™¤ã€‚</p>
<p>å¦‚æœæ‚¨æœ‰ä¸€äº›å¤æ‚çš„æ“ä½œæƒ³è¦åå¤ä½¿ç”¨ï¼Œæ‚¨å¯ä»¥
ä¸å¿…æ¯æ¬¡éƒ½ä»å¤´å¼€å§‹æ„å»ºã€‚å¦‚æœè¯¥æ“ä½œæ²¡æœ‰
å†…éƒ¨çŠ¶æ€ï¼ˆå³ï¼Œæ— è®ºå¤šå°‘æ¬¡å®ƒæ€»æ˜¯åšåŒæ ·çš„äº‹æƒ…
å®ƒå·²è¢«è°ƒç”¨ï¼‰ï¼Œæ‚¨å¯ä»¥å°†å…¶åˆ†é…ç»™æ“ä½œå˜é‡å¹¶ä½¿ç”¨å®ƒ
åå¤å˜åŒ–ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Action</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">DoAll</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">SetArgPointee</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Action</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> set_flag </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">SetArgPointee</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                      </span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> use set_flag in </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">and</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½†æ˜¯ï¼Œå¦‚æœè¯¥æ“ä½œæœ‰è‡ªå·±çš„çŠ¶æ€ï¼Œé‚£ä¹ˆå¦‚æœæ‚¨å…±äº«è¯¥æ“ä½œï¼Œæ‚¨å¯èƒ½ä¼šæ„Ÿåˆ°æƒŠè®¶
åŠ¨ä½œå¯¹è±¡ã€‚å‡è®¾æ‚¨æœ‰ä¸€ä¸ªæ“ä½œå·¥å‚â€œIncrementCounter(init)â€ï¼Œå…¶ä¸­
åˆ›å»ºä¸€ä¸ªé€’å¢å¹¶è¿”å›ä¸€ä¸ªè®¡æ•°å™¨çš„æ“ä½œï¼Œå…¶åˆå§‹å€¼ä¸º
<code>init</code>ï¼Œä½¿ç”¨ä»åŒä¸€è¡¨è¾¾å¼åˆ›å»ºçš„ä¸¤ä¸ªæ“ä½œå¹¶ä½¿ç”¨å…±äº«
åŠ¨ä½œä¼šè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºã€‚ä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IncrementCounter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IncrementCounter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns 1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns 2.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns 1 - Blah() uses a different</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// counter than Bar()&#x27;s.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç›¸å¯¹</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Action</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Action</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> increment </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IncrementCounter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">increment</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">increment</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns 1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns 2.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns 3 - the counter is shared.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æµ‹è¯•å¼‚æ­¥è¡Œä¸º">æµ‹è¯•å¼‚æ­¥è¡Œä¸º<a href="#æµ‹è¯•å¼‚æ­¥è¡Œä¸º" class="hash-link" aria-label="Direct link to æµ‹è¯•å¼‚æ­¥è¡Œä¸º" title="Direct link to æµ‹è¯•å¼‚æ­¥è¡Œä¸º">â€‹</a></h3>
<p>kMock ç»å¸¸é‡åˆ°çš„é—®é¢˜ä¹‹ä¸€æ˜¯å®ƒå¾ˆéš¾æµ‹è¯•
å¼‚æ­¥è¡Œä¸ºã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªä½ æƒ³è¦çš„<code>EventQueue</code>ç±»
æµ‹è¯•ï¼Œå¹¶ä¸”æ‚¨åˆ›å»ºäº†ä¸€ä¸ªå•ç‹¬çš„â€œEventDispatcherâ€æ¥å£ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥
è½»æ¾æ¨¡æ‹Ÿå®ƒã€‚ç„¶è€Œï¼Œè¯¥ç±»çš„å®ç°æ¿€å‘äº†æ‰€æœ‰
åå°çº¿ç¨‹ä¸Šçš„äº‹ä»¶ï¼Œè¿™ä½¿å¾—æµ‹è¯•è®¡æ—¶å˜å¾—å›°éš¾ã€‚ä½ å¯ä»¥åªæ˜¯
æ’å…¥ <code>sleep()</code> è¯­å¥å¹¶å¸Œæœ›å¾—åˆ°æœ€å¥½çš„ç»“æœï¼Œä½†è¿™ä¼šè®©ä½ çš„æµ‹è¯•
è¡Œä¸ºä¸ç¡®å®šã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ kMock æ“ä½œå’Œ
<code>Notification</code> å¯¹è±¡å¼ºåˆ¶å¼‚æ­¥æµ‹è¯•åŒæ­¥è¿è¡Œã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockEventDispatcher</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">EventDispatcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DispatchEvent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">EventQueueTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> EnqueueEventTest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockEventDispatcher mock_event_dispatcher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EventQueue </span><span class="token function" style="color:#8250DF">event_queue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">mock_event_dispatcher</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> int32 kEventId </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">321</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  absl</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Notification done</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_event_dispatcher</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DispatchEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kEventId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">done</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> done</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Notify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  event_queue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">EnqueueEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kEventId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  done</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WaitForNotification</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†æ­£å¸¸çš„ kMock æœŸæœ›ï¼Œä½†éšåæ·»åŠ äº†ä¸€ä¸ª
é€šçŸ¥â€œNotificationâ€å¯¹è±¡çš„é™„åŠ æ“ä½œã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥è°ƒç”¨
<code>Notification::WaitForNotification()</code> åœ¨ä¸»çº¿ç¨‹ä¸­ç­‰å¾…
å¼‚æ­¥è°ƒç”¨å®Œæˆã€‚ä¹‹åï¼Œæˆ‘ä»¬çš„æµ‹è¯•å¥—ä»¶å°±å®Œæˆäº†ï¼Œæˆ‘ä»¬å¯ä»¥
å®‰å…¨é€€å‡ºã€‚</p>
<p><code>{: .callout .note}</code>
æ³¨æ„ï¼šè¿™ä¸ªä¾‹å­æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼šå³ï¼Œå¦‚æœæœŸæœ›æ²¡æœ‰å¾—åˆ°æ»¡è¶³ï¼Œ
æˆ‘ä»¬çš„æµ‹è¯•å°†æ°¸è¿œè¿è¡Œã€‚å®ƒæœ€ç»ˆä¼šè¶…æ—¶å¹¶å¤±è´¥ï¼Œä½†å®ƒä¼š
éœ€è¦æ›´é•¿çš„æ—¶é—´å¹¶ä¸”è°ƒè¯•èµ·æ¥ç¨å¾®å›°éš¾ä¸€äº›ã€‚ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥
ä½¿ç”¨â€œWaitForNotificationWithTimeout(ms)â€è€Œä¸æ˜¯â€œWaitForNotification()â€ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="misc-recipes-on-using-kmock">æœ‰å…³ä½¿ç”¨ kMock çš„æ‚é¡¹<a href="#misc-recipes-on-using-kmock" class="hash-link" aria-label="Direct link to æœ‰å…³ä½¿ç”¨ kMock çš„æ‚é¡¹" title="Direct link to æœ‰å…³ä½¿ç”¨ kMock çš„æ‚é¡¹">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä½¿ç”¨ä»…ç§»åŠ¨ç±»å‹çš„æ¨¡æ‹Ÿæ–¹æ³•">ä½¿ç”¨ä»…ç§»åŠ¨ç±»å‹çš„æ¨¡æ‹Ÿæ–¹æ³•<a href="#ä½¿ç”¨ä»…ç§»åŠ¨ç±»å‹çš„æ¨¡æ‹Ÿæ–¹æ³•" class="hash-link" aria-label="Direct link to ä½¿ç”¨ä»…ç§»åŠ¨ç±»å‹çš„æ¨¡æ‹Ÿæ–¹æ³•" title="Direct link to ä½¿ç”¨ä»…ç§»åŠ¨ç±»å‹çš„æ¨¡æ‹Ÿæ–¹æ³•">â€‹</a></h3>
<p>C++11 å¼•å…¥äº†<em>ä»…ç§»åŠ¨ç±»å‹</em>ã€‚ä»…ç§»åŠ¨ç±»å‹çš„å€¼å¯ä»¥ä»
ä¸€ä¸ªå¯¹è±¡å¯ä»¥å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ— æ³•å¤åˆ¶ã€‚ <code>std::unique_ptr&lt;T&gt;</code> å¯èƒ½æ˜¯
æœ€å¸¸ç”¨çš„  ä»…ç§»åŠ¨ç±»å‹ã€‚</p>
<p>æ¨¡æ‹Ÿé‡‡ç”¨å’Œ/æˆ–è¿”å›ä»…ç§»åŠ¨ç±»å‹çš„æ–¹æ³•ä¼šå¸¦æ¥ä¸€äº›å½±å“
æŒ‘æˆ˜ï¼Œä½†æ²¡æœ‰ä»€ä¹ˆæ˜¯ä¸å¯å…‹æœçš„ã€‚è¿™ä¸ªé£Ÿè°±å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚
è¯·æ³¨æ„ï¼Œä»…å¼•å…¥å¯¹ä»…ç§»åŠ¨æ–¹æ³•å‚æ•°çš„æ”¯æŒ
2017 å¹´ 4 æœˆ kMockï¼›åœ¨è¾ƒæ—§çš„ä»£ç ä¸­ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°æ›´å¤æ‚
<a href="#LegacyMoveOnly">è§£å†³æ–¹æ³•</a> ç¼ºä¹æ­¤åŠŸèƒ½ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªè™šæ„çš„é¡¹ç›®ï¼Œå…è®¸ä¸€ä¸ªäººå‘å¸–å’Œåˆ†äº«
ç§°ä¸ºâ€œå—¡å—¡å£°â€çš„ç‰‡æ®µã€‚æ‚¨çš„ä»£ç ä½¿ç”¨è¿™äº›ç±»å‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">enum</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">AccessLevel</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> kInternal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kPublic </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Buzz</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">explicit</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Buzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AccessLevel access</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Buzzer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">Buzzer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Buzz</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">StringPiece text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Buzz</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> buzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int64_t</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>â€œBuzzâ€å¯¹è±¡è¡¨ç¤ºæ­£åœ¨å‘å¸ƒçš„ç‰‡æ®µã€‚ä¸€ä¸ªç±»å®ç°äº†
â€œBuzzerâ€ç•Œé¢èƒ½å¤Ÿåˆ›å»ºå’Œå…±äº«â€œBuzzâ€ã€‚ä¸­çš„æ–¹æ³•
<code>Buzzer</code> å¯èƒ½ä¼šè¿”å›ä¸€ä¸ª <code>unique_ptr&lt;Buzz&gt;</code> æˆ–æ¥å—ä¸€ä¸ª <code>unique_ptr&lt;Buzz&gt;</code>ã€‚ç°åœ¨æˆ‘ä»¬
éœ€è¦åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­æ¨¡æ‹Ÿâ€œBuzzerâ€ã€‚</p>
<p>è¦æ¨¡æ‹Ÿæ¥å—æˆ–è¿”å›ä»…ç§»åŠ¨ç±»å‹çš„æ–¹æ³•ï¼Œæ‚¨åªéœ€ä½¿ç”¨
åƒå¾€å¸¸ä¸€æ ·ç†Ÿæ‚‰çš„â€œMOCK_METHODâ€è¯­æ³•ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockBuzzer</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Buzzer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Buzz</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MakeBuzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">StringPiece text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ShareBuzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Buzz</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> buzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int64_t</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»å®šä¹‰äº†æ¨¡æ‹Ÿç±»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•ä¸­ä½¿ç”¨å®ƒã€‚åœ¨
ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬å·²ç»å®šä¹‰äº†ä¸€ä¸ª <code>MockBuzzer</code> å¯¹è±¡
åä¸ºâ€œmock_buzzer_â€ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  MockBuzzer mock_buzzer_</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è®¾ç½®å¯¹<code>MakeBuzz()</code>æ–¹æ³•çš„æœŸæœ›ï¼Œè¯¥æ–¹æ³•
è¿”å›ä¸€ä¸ª<code>unique_ptr&lt;Buzz&gt;</code>ã€‚</p>
<p>åƒå¾€å¸¸ä¸€æ ·ï¼Œå¦‚æœæ‚¨è®¾ç½®äº†ä¸€ä¸ªæœŸæœ›ä½†æ²¡æœ‰æ‰§è¡Œä»»ä½•æ“ä½œï¼ˆå³â€œ.WillOnce()â€æˆ–
<code>.WillRepeatedly()</code> å­å¥ï¼‰ï¼Œå½“è¯¥æœŸæœ›è§¦å‘æ—¶ï¼Œé»˜è®¤æ“ä½œ
å°†é‡‡ç”¨è¯¥æ–¹æ³•ã€‚ç”±äº <code>unique_ptr&lt;&gt;</code> æœ‰ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°
è¿”å›ä¸€ä¸ªç©ºçš„<code>unique_ptr</code>ï¼Œå¦‚æœä½ ä¸æŒ‡å®šä¸€ä¸ªï¼Œä½ ä¼šå¾—åˆ°è¿™ä¸ª
è¡ŒåŠ¨ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Use the default action.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;hello&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Triggers the previous EXPECT_CALL.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_EQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mock_buzzer_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;hello&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæ‚¨å¯¹é»˜è®¤æ“ä½œä¸æ»¡æ„ï¼Œå¯ä»¥ç…§å¸¸è¿›è¡Œè°ƒæ•´ï¼›å‚è€ƒ
<a href="#UseOnCall">è®¾ç½®é»˜è®¤æ“ä½œ</a>ã€‚</p>
<p>å¦‚æœæ‚¨åªéœ€è¦è¿”å›é¢„å®šä¹‰çš„ä»…ç§»åŠ¨å€¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨
<code>Return(ByMove(...))</code> æ“ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// When this fires, the unique_ptr&lt;&gt; specified by ByMove(...) will</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// be returned.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;world&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ByMove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">MakeUnique</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Buzz</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AccessLevel</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">kInternal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_NE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mock_buzzer_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;world&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œâ€œByMove()â€åœ¨è¿™é‡Œè‡³å…³é‡è¦ - å¦‚æœåˆ é™¤å®ƒï¼Œä»£ç å°†æ— æ³•ç¼–è¯‘ã€‚</p>
<p>æµ‹éªŒæ—¶é—´ï¼å¦‚æœæ‰§è¡Œâ€œReturn(ByMove(...))â€æ“ä½œï¼Œæ‚¨è®¤ä¸ºä¼šå‘ç”Ÿä»€ä¹ˆ
æ‰§è¡Œå¤šæ¬¡ï¼ˆä¾‹å¦‚ï¼Œæ‚¨å†™â€œ...
.WillRepeatedly(Return(ByMove(...)));`)?æƒ³æƒ³å§ï¼Œç¬¬ä¸€æ¬¡ä¹‹å
æ“ä½œè¿è¡Œæ—¶ï¼Œæºå€¼å°†è¢«æ¶ˆè€—ï¼ˆå› ä¸ºå®ƒæ˜¯ä»…ç§»åŠ¨çš„
å€¼ï¼‰ï¼Œæ‰€ä»¥ä¸‹ä¸€æ¬¡ï¼Œæ²¡æœ‰ä»»ä½•å¯ä»¥ç§»åŠ¨çš„å€¼â€”â€”ä½ ä¼šå¾—åˆ°ä¸€ä¸ª
è¿è¡Œæ—¶é”™è¯¯â€œReturn(ByMove(...))â€åªèƒ½è¿è¡Œä¸€æ¬¡ã€‚</p>
<p>å¦‚æœæ‚¨éœ€è¦æ¨¡æ‹Ÿæ–¹æ³•åšçš„ä¸ä»…ä»…æ˜¯ç§»åŠ¨é¢„å®šä¹‰å€¼ï¼Œ
è¯·è®°ä½ï¼Œæ‚¨å§‹ç»ˆå¯ä»¥ä½¿ç”¨ lambda æˆ–å¯è°ƒç”¨å¯¹è±¡ï¼Œè¿™å¯ä»¥åšåˆ°
å‡ ä¹ä»»ä½•ä½ æƒ³è¦çš„ä¸œè¥¿ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">StringPiece text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token generic-function function" style="color:#8250DF">MakeUnique</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Buzz</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AccessLevel</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">kInternal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_NE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mock_buzzer_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_NE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mock_buzzer_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">MakeBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;x&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ¯æ¬¡â€œEXPECT_CALLâ€è§¦å‘æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„<code>unique_ptr&lt;Buzz&gt;</code>
ç„¶åå›æ¥äº†ã€‚æ‚¨ä¸èƒ½ä½¿ç”¨â€œReturn(ByMove(...))â€æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚</p>
<p>è¿™åŒ…æ‹¬è¿”å›ä»…ç§»åŠ¨å€¼ï¼›ä½†æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æ–¹æ³•
æ¥å—ä»…ç§»åŠ¨å‚æ•°ï¼Ÿç­”æ¡ˆæ˜¯å®ƒä»¬å·¥ä½œæ­£å¸¸ï¼Œå°½ç®¡
å½“ä»»ä½•æ–¹æ³•çš„å‚æ•°æ˜¯ä»…ç§»åŠ¨æ—¶ï¼ŒæŸäº›æ“ä½œå°†æ— æ³•ç¼–è¯‘ã€‚ä½ 
å§‹ç»ˆå¯ä»¥ä½¿ç”¨ <code>Return</code> æˆ– <a href="#FunctionsAsActions">lambda æˆ–å‡½å­</a>ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Unused</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_TRUE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">MakeUnique</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Buzz</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AccessLevel</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">kInternal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Buzz</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> buzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Unused</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> buzz </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_FALSE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è®¸å¤šå†…ç½®æ“ä½œï¼ˆ<code>WithArgs</code>ï¼Œ<code>WithoutArgs</code>ï¼Œ<code>DeleteArg</code>ï¼Œ<code>SaveArg</code>ï¼Œ...ï¼‰
åŸåˆ™ä¸Šå¯ä»¥æ”¯æŒä»…ç§»åŠ¨å‚æ•°ï¼Œä½†å¯¹æ­¤çš„æ”¯æŒå¹¶ä¸
å°šæœªå®æ–½ã€‚å¦‚æœè¿™é˜»ç¢äº†æ‚¨ï¼Œè¯·æäº¤é”™è¯¯ã€‚</p>
<p>ä¸€äº›æ“ä½œï¼ˆä¾‹å¦‚<code>DoAll</code>ï¼‰åœ¨å†…éƒ¨å¤åˆ¶å®ƒä»¬çš„å‚æ•°ï¼Œæ‰€ä»¥å®ƒä»¬æ°¸è¿œä¸èƒ½
ä½¿ç”¨ä¸å¯å¤åˆ¶çš„å¯¹è±¡ï¼›ä½ å¿…é¡»ä½¿ç”¨å‡½å­æ¥ä»£æ›¿ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="LegacyMoveOnly">ä»…ç§»åŠ¨ç±»å‹çš„æ—§è§£å†³æ–¹æ³•<a href="#LegacyMoveOnly" class="hash-link" aria-label="Direct link to ä»…ç§»åŠ¨ç±»å‹çš„æ—§è§£å†³æ–¹æ³•" title="Direct link to ä»…ç§»åŠ¨ç±»å‹çš„æ—§è§£å†³æ–¹æ³•">â€‹</a></h4>
<p>kMock äº 4 æœˆä»½æ‰å¼•å…¥å¯¹ä»…ç§»åŠ¨å‡½æ•°å‚æ•°çš„æ”¯æŒ
2017 å¹´çš„ç‰ˆæœ¬ã€‚åœ¨è¾ƒæ—§çš„ä»£ç ä¸­ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹è§£å†³æ–¹æ³•ï¼š
æ­¤åŠŸèƒ½ï¼ˆä¸å†éœ€è¦ - æˆ‘ä»¬å°†å…¶åŒ…æ‹¬åœ¨å†…åªæ˜¯ä¸ºäº†
å‚è€ƒï¼‰ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockBuzzer</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Buzzer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoShareBuzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Buzz</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> buzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Time timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Buzz</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> buzz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Time timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buzz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯€çªæ˜¯å°†â€œShareBuzz()â€æ–¹æ³•å§”æ‰˜ç»™æ¨¡æ‹Ÿæ–¹æ³•ï¼ˆè®©æˆ‘ä»¬è°ƒç”¨
å®ƒä¸é‡‡ç”¨ä»…ç§»åŠ¨å‚æ•°çš„â€œDoShareBuzz()â€)ã€‚ç„¶åï¼Œä»£æ›¿
è®¾ç½®å¯¹â€œShareBuzz()â€çš„æœŸæœ›ï¼Œæ‚¨å¯ä»¥åœ¨â€œDoShareBuzz()â€æ¨¡æ‹Ÿä¸Šè®¾ç½®å®ƒä»¬
æ–¹æ³•ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  MockBuzzer mock_buzzer_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_buzzer_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// When one calls ShareBuzz() on the MockBuzzer like this, the call is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// forwarded to DoShareBuzz(), which is mocked.  Therefore this statement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// will trigger the above EXPECT_CALL.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mock_buzzer_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ShareBuzz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">MakeUnique</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">Buzz</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AccessLevel</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">kInternal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä½¿ç¼–è¯‘æ›´å¿«">ä½¿ç¼–è¯‘æ›´å¿«<a href="#ä½¿ç¼–è¯‘æ›´å¿«" class="hash-link" aria-label="Direct link to ä½¿ç¼–è¯‘æ›´å¿«" title="Direct link to ä½¿ç¼–è¯‘æ›´å¿«">â€‹</a></h3>
<p>ä¸ç®¡ä½ ç›¸ä¿¡ä¸å¦ï¼Œâ€œç»å¤§å¤šæ•°â€æ—¶é—´éƒ½èŠ±åœ¨ç¼–è¯‘æ¨¡æ‹Ÿä¸Š
ç±»æ­£åœ¨ç”Ÿæˆå…¶æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬æ‰§è¡Œ
é‡è¦çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚éªŒè¯æœŸæœ›ï¼‰ã€‚æ›´ä½•å†µè¿˜å˜²è®½
å…·æœ‰ä¸åŒç­¾åçš„æ–¹æ³•å…·æœ‰ä¸åŒçš„ç±»å‹ï¼Œå› æ­¤å®ƒä»¬çš„
æ„é€ å‡½æ•°/ææ„å‡½æ•°éœ€è¦ç”±ç¼–è¯‘å™¨å•ç‹¬ç”Ÿæˆã€‚ä½œä¸ºä¸€ä¸ª
ç»“æœï¼Œå¦‚æœæ‚¨æ¨¡æ‹Ÿè®¸å¤šä¸åŒç±»å‹çš„æ–¹æ³•ï¼Œè¯·ç¼–è¯‘æ‚¨çš„æ¨¡æ‹Ÿç±»
ä¼šå˜å¾—éå¸¸æ…¢ã€‚</p>
<p>å¦‚æœæ‚¨é‡åˆ°ç¼–è¯‘ç¼“æ…¢çš„æƒ…å†µï¼Œæ‚¨å¯ä»¥ç§»åŠ¨æ‚¨çš„å®šä¹‰
æ¨¡æ‹Ÿç±»çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ä»ç±»ä½“ä¸­å‡ºæ¥å¹¶è¿›å…¥â€œ.ccâ€
æ–‡ä»¶ã€‚è¿™æ ·ï¼Œå³ä½¿ä½ åœ¨ N ä¸ªæ–‡ä»¶ä¸­ <code>#include</code> ä½ çš„æ¨¡æ‹Ÿç±»ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼š
åªéœ€è¦ç”Ÿæˆå®ƒçš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ä¸€æ¬¡ï¼Œä»è€Œäº§ç”Ÿå¾ˆå¤š
æ›´å¿«çš„ç¼–è¯‘ã€‚</p>
<p>è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæƒ³æ³•ã€‚è¿™æ˜¯æ¨¡æ‹Ÿçš„å®šä¹‰
åº”ç”¨æ­¤é£Ÿè°±ä¹‹å‰çš„è¯¾ç¨‹ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// File mock_foo.h.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Since we don&#x27;t declare the constructor or the destructor,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// the compiler will generate them in every translation unit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// where this mock class is used.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> more mock methods </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ›´æ”¹åï¼Œå®ƒçœ‹èµ·æ¥åƒï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// File mock_foo.h.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The constructor and destructor are declared, but not defined, here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MockFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">MockFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> more mock methods </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å’Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// File mock_foo.cc.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&quot;path/to/mock_foo.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The definitions may appear trivial, but the functions actually do a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// lot of things through the constructors/destructors of the member</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// variables used to implement the mock methods.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">MockFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">MockFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¼ºåˆ¶éªŒè¯">å¼ºåˆ¶éªŒè¯<a href="#å¼ºåˆ¶éªŒè¯" class="hash-link" aria-label="Direct link to å¼ºåˆ¶éªŒè¯" title="Direct link to å¼ºåˆ¶éªŒè¯">â€‹</a></h3>
<p>å½“å®ƒè¢«é”€æ¯æ—¶ï¼Œæ‚¨çš„å‹å¥½æ¨¡æ‹Ÿå¯¹è±¡å°†è‡ªåŠ¨éªŒè¯
å¯¹å®ƒçš„æ‰€æœ‰æœŸæœ›éƒ½å·²å¾—åˆ°æ»¡è¶³ï¼Œå¹¶å°†ç”Ÿæˆ googletest
å¦‚æœæ²¡æœ‰åˆ™å¤±è´¥ã€‚è¿™å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºå®ƒè®©æ‚¨å°‘äº†ä¸€ä»¶äº‹æƒ…
æ‹…å¿ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤éæ‚¨ä¸ç¡®å®šæ‚¨çš„æ¨¡æ‹Ÿå¯¹è±¡æ˜¯å¦ä¼šæ˜¯
è¢«æ¯äº†ã€‚</p>
<p>ä½ çš„æ¨¡æ‹Ÿå¯¹è±¡æ€ä¹ˆå¯èƒ½æœ€ç»ˆä¸ä¼šè¢«é”€æ¯å‘¢ï¼Ÿå—¯ï¼Œå®ƒ
å¯èƒ½åœ¨å †ä¸Šåˆ›å»ºå¹¶ç”±æ‚¨æ­£åœ¨æµ‹è¯•çš„ä»£ç æ‹¥æœ‰ã€‚è®¤ä¸º
è¯¥ä»£ç ä¸­æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œå®ƒæ²¡æœ‰æ­£ç¡®åˆ é™¤æ¨¡æ‹Ÿå¯¹è±¡ - ä½ 
å½“å®é™…ä¸Šå­˜åœ¨é”™è¯¯æ—¶ï¼Œæœ€ç»ˆå¯èƒ½ä¼šé€šè¿‡æµ‹è¯•ã€‚</p>
<p>ä½¿ç”¨å †æ£€æŸ¥å™¨æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå¯ä»¥å‡è½»è¿™ç§æ‹…å¿§ï¼Œä½†å®ƒ
å®æ–½å¹¶é 100% å¯é ã€‚æ‰€ä»¥ï¼Œæœ‰æ—¶ä½ ç¡®å®æƒ³<em>å¼ºåˆ¶</em> kMock
åœ¨ï¼ˆå¸Œæœ›ï¼‰é”€æ¯æ¨¡æ‹Ÿå¯¹è±¡ä¹‹å‰å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚ä½ å¯ä»¥è¿™æ ·åš
ä½¿ç”¨â€œMock::VerifyAndClearExpectations(&amp;mock_object)â€ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MyServerTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ProcessesRequest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Mock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> foo </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> MockFoo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// ... other expectations ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// server now owns foo.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MyServer </span><span class="token function" style="color:#8250DF">server</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">ProcessRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// In case that server&#x27;s destructor will forget to delete foo,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// this will verify the expectations anyway.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name" style="color:#116329">Mock</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">VerifyAndClearExpectations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// server is destroyed when it goes out of scope here.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><strong>æç¤ºï¼š</strong> <code>Mock::VerifyAndClearExpectations()</code> å‡½æ•°è¿”å›ä¸€ä¸ª <code>bool</code>
æŒ‡ç¤ºéªŒè¯æ˜¯å¦æˆåŠŸï¼ˆâ€œtrueâ€è¡¨ç¤ºæ˜¯ï¼‰ï¼Œå› æ­¤æ‚¨å¯ä»¥
å¦‚æœæ²¡æœ‰æ„ä¹‰ï¼Œåˆ™å°†è¯¥å‡½æ•°è°ƒç”¨åŒ…è£…åœ¨â€œASSERT_TRUE()â€å†…
å½“éªŒè¯å¤±è´¥æ—¶è¿›ä¸€æ­¥ã€‚</p></div></div>
<p>åœ¨ä½¿ç”¨åéªŒè¯å¹¶æ¸…é™¤æ¨¡æ‹Ÿåï¼Œä¸è¦è®¾å®šæ–°çš„æœŸæœ›ã€‚
åœ¨æ‰§è¡Œæ¨¡æ‹Ÿçš„ä»£ç ä¹‹åè®¾ç½®æœŸæœ›å…·æœ‰æœªå®šä¹‰çš„è¡Œä¸ºã€‚
æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="/docs/cpp/base/testing/kt/kmock_for_dummies#using-mocks-in-tests">åœ¨æµ‹è¯•ä¸­ä½¿ç”¨ Mock</a>
ä¿¡æ¯ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="UsingCheckPoints">Using Checkpoints<a href="#UsingCheckPoints" class="hash-link" aria-label="Direct link to Using Checkpoints" title="Direct link to Using Checkpoints">â€‹</a></h3>
<p>æœ‰æ—¶æ‚¨å¯èƒ½æƒ³åˆ†é˜¶æ®µæµ‹è¯•æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸ºï¼Œå…¶å¤§å°
éƒ½æ˜¯å¯ä»¥ç®¡ç†çš„ï¼Œæˆ–è€…æ‚¨å¯èƒ½æƒ³è¦è®¾å®šæ›´è¯¦ç»†çš„æœŸæœ›
å“ªäº› API è°ƒç”¨ä¼šè°ƒç”¨å“ªäº›æ¨¡æ‹Ÿå‡½æ•°ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨çš„ä¸€ç§æŠ€æœ¯æ˜¯å°†æœŸæœ›æ”¾å…¥åºåˆ—ä¸­å¹¶æ’å…¥
åœ¨ç‰¹å®šä½ç½®è°ƒç”¨è™šæ‹Ÿâ€œæ£€æŸ¥ç‚¹â€å‡½æ•°ã€‚ç„¶åä½ å¯ä»¥éªŒè¯
æ¨¡æ‹Ÿå‡½æ•°è°ƒç”¨ç¡®å®åœ¨æ­£ç¡®çš„æ—¶é—´å‘ç”Ÿã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨
æ­£åœ¨æ‰§è¡Œä»£ç ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¹¶æƒ³è¦éªŒè¯ <code>Foo(1)</code> å’Œ <code>Foo(3)</code> éƒ½è°ƒç”¨ <code>mock.Bar(&quot;a&quot;)</code>ï¼Œä½†æ˜¯
<code>Foo(2)</code> ä¸ä¼šè°ƒç”¨ä»»ä½•ä¸œè¥¿ï¼Œä½ å¯ä»¥å†™ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">MockFunction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FooTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> InvokesBarCorrectly</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MyMock mock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Class MockFunction&lt;F&gt; has exactly one mock method.  It is named</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Call() and has type F.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFunction</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">string check_point_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> check</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    InSequence s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">check</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">check</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  check</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  check</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æœŸæœ›è§„èŒƒè§„å®šç¬¬ä¸€ä¸ª <code>Bar(&quot;a&quot;)</code> è°ƒç”¨å¿…é¡»å‘ç”Ÿåœ¨
æ£€æŸ¥ç‚¹â€œ1â€ï¼Œç¬¬äºŒä¸ª <code>Bar(&quot;a&quot;)</code> è°ƒç”¨å¿…é¡»åœ¨æ£€æŸ¥ç‚¹â€œ2â€ä¹‹åå‘ç”Ÿï¼Œå¹¶ä¸”
ä¸¤ä¸ªæ£€æŸ¥ç‚¹ä¹‹é—´ä¸åº”å‘ç”Ÿä»»ä½•äº‹æƒ…ã€‚æ˜¾å¼æ£€æŸ¥ç‚¹ä½¿
æ¸…æ¥šå“ªä¸ª <code>Foo()</code> è°ƒç”¨äº†å“ªä¸ª <code>Bar(&quot;a&quot;)</code>ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ¨¡æ‹Ÿææ„å‡½æ•°">æ¨¡æ‹Ÿææ„å‡½æ•°<a href="#æ¨¡æ‹Ÿææ„å‡½æ•°" class="hash-link" aria-label="Direct link to æ¨¡æ‹Ÿææ„å‡½æ•°" title="Direct link to æ¨¡æ‹Ÿææ„å‡½æ•°">â€‹</a></h3>
<p>æœ‰æ—¶ä½ æƒ³ç¡®ä¿æ¨¡æ‹Ÿå¯¹è±¡åœ¨æ­£ç¡®çš„æ—¶é—´è¢«ç ´åï¼Œ
ä¾‹å¦‚åœ¨è°ƒç”¨ <code>bar-&gt;A()</code> ä¹‹åä½†åœ¨è°ƒç”¨ <code>bar-&gt;B()</code> ä¹‹å‰ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“
æ‚¨å¯ä»¥æŒ‡å®šæ¨¡æ‹Ÿå‡½æ•°çš„ <a href="#OrderedCalls">order</a> çº¦æŸ
è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ¨¡æ‹Ÿmockå‡½æ•°çš„ææ„å‡½æ•°ã€‚</p>
<p>è¿™å¬èµ·æ¥å¾ˆç®€å•ï¼Œé™¤  äº†ä¸€ä¸ªé—®é¢˜ï¼šææ„å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šå‡½æ•°
å…·æœ‰ç‰¹æ®Šçš„è¯­æ³•å’Œç‰¹æ®Šçš„è¯­ä¹‰ï¼Œè€Œâ€œMOCK_METHODâ€å®åˆ™æ²¡æœ‰
ä¸ºä¹‹å·¥ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token plain">MockFoo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Won&#x27;t compile!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¥½æ¶ˆæ¯æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨ç®€å•çš„æ¨¡å¼æ¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚
é¦–å…ˆï¼Œå°†æ¨¡æ‹Ÿå‡½æ•° <code>Die()</code> æ·»åŠ åˆ°æ‚¨çš„æ¨¡æ‹Ÿç±»ä¸­å¹¶åœ¨
ææ„å‡½æ•°ï¼Œåƒè¿™æ ·ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Add the following two lines to the mock class.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Die</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">MockFoo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Die</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ï¼ˆå¦‚æœåç§°â€œDie()â€ä¸ç°æœ‰ç¬¦å·å†²çªï¼Œè¯·é€‰æ‹©å¦ä¸€ä¸ªåç§°ã€‚ï¼‰ç°åœ¨ï¼Œ
æˆ‘ä»¬å·²ç»å°†â€œMockFooâ€å¯¹è±¡æ­»äº¡æ—¶çš„æµ‹è¯•é—®é¢˜ç¿»è¯‘ä¸º
æµ‹è¯•ä½•æ—¶è°ƒç”¨å…¶ <code>Die()</code> æ–¹æ³•ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> foo </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> MockFoo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockBar</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> bar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> MockBar</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    InSequence s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Expects *foo to die after bar-&gt;A() and before bar-&gt;B().</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Die</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">B</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°±æ˜¯è¿™æ ·ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="UsingThreads">ä½¿ç”¨ kMock å’Œçº¿ç¨‹<a href="#UsingThreads" class="hash-link" aria-label="Direct link to ä½¿ç”¨ kMock å’Œçº¿ç¨‹" title="Direct link to ä½¿ç”¨ kMock å’Œçº¿ç¨‹">â€‹</a></h3>
<p>åœ¨<strong>å•å…ƒ</strong>æµ‹è¯•ä¸­ï¼Œæœ€å¥½èƒ½å¤Ÿåœ¨ä¸€ä¸ªå•å…ƒä¸­éš”ç¦»å¹¶æµ‹è¯•ä¸€æ®µä»£ç ã€‚
å•çº¿ç¨‹ä¸Šä¸‹æ–‡ã€‚è¿™é¿å…äº†ç«äº‰æ¡ä»¶å’Œæ­»é”ï¼Œå¹¶ä¸”ä½¿å¾—
è°ƒè¯•æ‚¨çš„æµ‹è¯•å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p>
<p>ç„¶è€Œå¤§å¤šæ•°ç¨‹åºéƒ½æ˜¯å¤šçº¿ç¨‹çš„ï¼Œæœ‰æ—¶ä¸ºäº†æµ‹è¯•æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿
ä»å¤šä¸ªçº¿ç¨‹ä¸Šæ•²å‡»å®ƒã€‚ kMock ä¹Ÿé€‚ç”¨äºæ­¤ç›®çš„ã€‚</p>
<p>è®°ä½ä½¿ç”¨æ¨¡æ‹Ÿçš„æ­¥éª¤ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿå¯¹è±¡ <code>foo</code>ã€‚</li>
<li>ä½¿ç”¨<code>ON_CALL()</code>è®¾ç½®å…¶é»˜è®¤æ“ä½œå’ŒæœŸæœ›
<code>EXPECT_CALL()</code>ã€‚</li>
<li>è¢«æµ‹ä»£ç è°ƒç”¨<code>foo</code>çš„æ–¹æ³•ã€‚</li>
<li>ï¼ˆå¯é€‰ï¼‰éªŒè¯å¹¶é‡ç½®æ¨¡æ‹Ÿã€‚</li>
<li>è‡ªå·±é”€æ¯æ¨¡æ‹Ÿï¼Œæˆ–è€…è®©è¢«æµ‹è¯•çš„ä»£ç é”€æ¯å®ƒã€‚è¿™
ææ„å‡½æ•°ä¼šè‡ªåŠ¨éªŒè¯å®ƒã€‚</li>
</ol>
<p>å¦‚æœæ‚¨éµå¾ªä»¥ä¸‹ç®€å•è§„åˆ™ï¼Œæ‚¨çš„æ¨¡æ‹Ÿå’Œçº¿ç¨‹å°±å¯ä»¥ç”Ÿå­˜
å¹¸ç¦åœ°åœ¨ä¸€èµ·ï¼š</p>
<ul>
<li>åœ¨<em>one</em>ä¸­æ‰§è¡Œæ‚¨çš„<em>æµ‹è¯•ä»£ç </em>ï¼ˆè€Œä¸æ˜¯æ­£åœ¨æµ‹è¯•çš„ä»£ç ï¼‰
çº¿ã€‚è¿™ä½¿æ‚¨çš„æµ‹è¯•æ˜“äºéµå¾ªã€‚</li>
<li>æ˜¾ç„¶ï¼Œæ‚¨å¯ä»¥åœ¨ä¸é”å®šçš„æƒ…å†µä¸‹æ‰§è¡Œæ­¥éª¤ #1ã€‚</li>
<li>æ‰§è¡Œæ­¥éª¤#2 å’Œ#5 æ—¶ï¼Œç¡®ä¿æ²¡æœ‰å…¶ä»–çº¿ç¨‹æ­£åœ¨è®¿é—®â€œfooâ€ã€‚
ä¹Ÿå¾ˆæ˜æ˜¾å§ï¼Ÿ</li>
<li>#3 å’Œ #4 å¯ä»¥åœ¨ä¸€ä¸ªçº¿ç¨‹æˆ–å¤šçº¿ç¨‹ä¸­å®Œæˆ - æ— è®ºå¦‚ä½•
ä½ æƒ³è¦çš„ã€‚ kMock è´Ÿè´£é”å®šï¼Œå› æ­¤æ‚¨æ— éœ€æ‰§è¡Œä»»ä½•æ“ä½œ -
é™¤éæ‚¨çš„æµ‹è¯•é€»è¾‘éœ€è¦ã€‚</li>
</ul>
<p>å¦‚æœæ‚¨è¿åäº†è§„åˆ™ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å¯¹æ¨¡æ‹Ÿè®¾å®šäº†æœŸæœ›ï¼Œè€Œ
å¦ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼‰ï¼Œä½ ä¼šå¾—åˆ°æœªå®šä¹‰çš„è¡Œä¸ºã€‚é‚£ä¸æ˜¯
æœ‰è¶£ï¼Œæ‰€ä»¥ä¸è¦è¿™æ ·åšã€‚</p>
<p>kMock ä¿è¯æ¨¡æ‹Ÿå‡½æ•°çš„æ“ä½œåœ¨åŒä¸€çº¿ç¨‹ä¸­å®Œæˆ
è°ƒç”¨äº†æ¨¡æ‹Ÿå‡½æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœåœ¨çº¿ç¨‹ 1 ä¸­è°ƒç”¨ <code>Foo(1)</code> å¹¶ä¸”åœ¨çº¿ç¨‹ 2 ä¸­è°ƒç”¨ <code>Foo(2)</code>ï¼ŒkMock å°†
åœ¨çº¿ç¨‹ 1 ä¸­æ‰§è¡Œâ€œaction1â€ï¼Œåœ¨çº¿ç¨‹ 2 ä¸­æ‰§è¡Œâ€œaction2â€ã€‚</p>
<p>kMock <em>ä¸</em>å¯¹ä¸åŒçº¿ç¨‹ä¸­æ‰§è¡Œçš„æ“ä½œå¼ºåŠ é¡ºåº
ï¼ˆè¿™æ ·åšå¯èƒ½ä¼šé€ æˆåƒµå±€ï¼Œå› ä¸ºè¿™äº›æ“ä½œå¯èƒ½éœ€è¦åˆä½œï¼‰ã€‚è¿™æ„å‘³ç€
ä¸Šä¾‹ä¸­â€œaction1â€å’Œâ€œaction2â€çš„æ‰§è¡Œ<em>å¯èƒ½</em>
äº¤é”™ã€‚å¦‚æœè¿™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨åº”è¯¥æ·»åŠ é€‚å½“çš„åŒæ­¥é€»è¾‘
<code>action1</code> å’Œ <code>action2</code> ä½¿æµ‹è¯•çº¿ç¨‹å®‰å…¨ã€‚</p>
<p>å¦å¤–ï¼Œè¯·è®°ä½<code>DefaultValue&lt;T&gt;</code>æ˜¯ä¸€ä¸ªå…¨å±€èµ„æºï¼Œå¯èƒ½ä¼š
å½±å“ç¨‹åºä¸­çš„â€œæ‰€æœ‰â€æ´»åŠ¨æ¨¡æ‹Ÿå¯¹è±¡ã€‚è‡ªç„¶ï¼Œä½ ä¸ä¼šæ„¿æ„
ä»å¤šä¸ªçº¿ç¨‹æˆ–è€…ä»ç„¶æœ‰æ¨¡æ‹Ÿåœ¨è¿è¡Œæ—¶å¼„ä¹±å®ƒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ§åˆ¶-kmock-æ‰“å°çš„ä¿¡æ¯é‡">æ§åˆ¶ kMock æ‰“å°çš„ä¿¡æ¯é‡<a href="#æ§åˆ¶-kmock-æ‰“å°çš„ä¿¡æ¯é‡" class="hash-link" aria-label="Direct link to æ§åˆ¶ kMock æ‰“å°çš„ä¿¡æ¯é‡" title="Direct link to æ§åˆ¶ kMock æ‰“å°çš„ä¿¡æ¯é‡">â€‹</a></h3>
<p>å½“ kMock å‘ç°å¯èƒ½å‡ºç°é”™è¯¯çš„å†…å®¹æ—¶ï¼ˆä¾‹å¦‚æ¨¡æ‹Ÿ
æ²¡æœ‰æœŸæœ›çš„å‡½æ•°è¢«è°ƒç”¨ï¼Œåˆåæ— è¶£çš„è°ƒç”¨ï¼Œå³
å…è®¸ï¼Œä½†ä¹Ÿè®¸æ‚¨å¿˜è®°æ˜ç¡®ç¦æ­¢è¯¥è°ƒç”¨ï¼‰ï¼Œå®ƒä¼šæ‰“å°ä¸€äº›
è­¦å‘Šæ¶ˆæ¯ï¼ŒåŒ…æ‹¬ å‡½æ•°çš„å‚æ•°ã€è¿”å›å€¼å’Œ
å †æ ˆè·Ÿè¸ªã€‚å¸Œæœ›è¿™ä¼šæé†’æ‚¨çœ‹ä¸€çœ‹æ˜¯å¦æœ‰
ç¡®å®æ˜¯ä¸ªé—®é¢˜ã€‚</p>
<p>æœ‰æ—¶æ‚¨ç¡®ä¿¡è‡ªå·±çš„æµ‹è¯•æ˜¯æ­£ç¡®çš„ï¼Œä½†å¯èƒ½å¹¶ä¸æ¬£èµ
å¦‚æ­¤å‹å¥½çš„ä¿¡æ¯ã€‚æœ‰æ—¶ï¼Œæ‚¨æ­£åœ¨è°ƒè¯•æµ‹è¯•æˆ–
äº†è§£æ‚¨æ­£åœ¨æµ‹è¯•çš„ä»£ç çš„è¡Œä¸ºï¼Œå¹¶å¸Œæœ›æ‚¨èƒ½å¤Ÿ
è§‚å¯Ÿå‘ç”Ÿçš„æ¯ä¸ªæ¨¡æ‹Ÿè°ƒç”¨ï¼ˆåŒ…æ‹¬å‚æ•°å€¼ã€è¿”å›å€¼
å€¼å’Œå †æ ˆè·Ÿè¸ªï¼‰ã€‚æ˜¾ç„¶ï¼Œä¸€ç§å°ºå¯¸å¹¶ä¸é€‚åˆæ‰€æœ‰æƒ…å†µã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨â€œ--kmock_verbose=LEVELâ€æ¥æ§åˆ¶ kMock å‘Šè¯‰æ‚¨çš„ä¿¡æ¯é‡
å‘½ä»¤è¡Œæ ‡å¿—ï¼Œå…¶ä¸­â€œLEVELâ€æ˜¯ä¸€ä¸ªå…·æœ‰ä¸‰ä¸ªå¯èƒ½å€¼çš„å­—ç¬¦ä¸²ï¼š</p>
<ul>
<li><code>info</code>ï¼škMock å°†æ‰“å°æ‰€æœ‰ä¿¡æ¯æ€§æ¶ˆæ¯ã€è­¦å‘Šå’Œé”™è¯¯
ï¼ˆæœ€è¯¦ç»†ï¼‰ã€‚åœ¨æ­¤è®¾ç½®ä¸‹ï¼ŒkMock è¿˜å°†è®°å½•å¯¹
<code>ON_CALL/EXPECT_CALL</code> å®ã€‚å®ƒå°†åŒ…å«å †æ ˆè·Ÿè¸ª
â€œæ— è¶£çš„ç”µè¯â€è­¦å‘Šã€‚</li>
<li><code>warning</code>ï¼škMock å°†æ‰“å°è­¦å‘Šå’Œé”™è¯¯ï¼ˆä¸å¤ªè¯¦ç»†ï¼‰ï¼›å®ƒå°†
å¿½ç•¥â€œæ— è¶£çš„è°ƒç”¨â€è­¦å‘Šä¸­çš„å †æ ˆè·Ÿè¸ªã€‚è¿™æ˜¯é»˜è®¤è®¾ç½®ã€‚</li>
<li><code>error</code>ï¼škMock å°†ä»…æ‰“å°é”™è¯¯ï¼ˆæœ€ä¸è¯¦ç»†ï¼‰ã€‚</li>
</ul>
<p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥åœ¨æµ‹è¯•ä¸­è°ƒæ•´è¯¥æ ‡å¿—çš„å€¼ï¼Œä¾‹å¦‚
æ‰€ä»¥ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">FLAGS_kmock_verbose </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;error&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæ‚¨å‘ç° kMock æ‰“å°äº†å¤ªå¤šå †æ ˆå¸§åŠå…¶ä¿¡æ¯æˆ–
è­¦å‘Šæ¶ˆæ¯ï¼Œè¯·è®°ä½æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ§åˆ¶å…¶æ•°é‡
<code>--ktest_stack_trace_depth=max_depth</code> æ ‡å¿—ã€‚</p>
<p>ç°åœ¨ï¼Œæ˜æ™ºåœ°ä½¿ç”¨æ­£ç¡®çš„æ ‡å¿—ï¼Œè®© kMock æ›´å¥½åœ°ä¸ºæ‚¨æœåŠ¡ï¼</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="åœ¨æ¨¡æ‹Ÿé€šè¯ä¸­è·å¾—è¶…çº§è§†è§‰">åœ¨æ¨¡æ‹Ÿé€šè¯ä¸­è·å¾—è¶…çº§è§†è§‰<a href="#åœ¨æ¨¡æ‹Ÿé€šè¯ä¸­è·å¾—è¶…çº§è§†è§‰" class="hash-link" aria-label="Direct link to åœ¨æ¨¡æ‹Ÿé€šè¯ä¸­è·å¾—è¶…çº§è§†è§‰" title="Direct link to åœ¨æ¨¡æ‹Ÿé€šè¯ä¸­è·å¾—è¶…çº§è§†è§‰">â€‹</a></h3>
<p>æ‚¨ä½¿ç”¨ kMock è¿›è¡Œäº†æµ‹è¯•ã€‚å®ƒå¤±è´¥äº†ï¼škMock å‘Šè¯‰ä½ æœ‰äº›æœŸæœ›æ²¡æœ‰å®ç°
ä½¿æ»¡æ„ã€‚ä½†æ˜¯ï¼Œæ‚¨ä¸ç¡®å®šä¸ºä»€ä¹ˆï¼šæ˜¯å¦æœ‰æ‹¼å†™é”™è¯¯ï¼Ÿ
åŒ¹é…è€…ï¼Ÿæ‚¨æ˜¯å¦æä¹±äº†â€œEXPECT_CALLâ€çš„é¡ºåºï¼Ÿæˆ–è€…æ˜¯ä¸‹é¢çš„ä»£ç 
æµ‹è¯•åšé”™äº†ä»€ä¹ˆï¼Ÿæ€æ ·æ‰èƒ½æ‰¾å‡ºåŸå› å‘¢ï¼Ÿ</p>
<p>å¦‚æœä½ æœ‰Xå…‰è§†åŠ›ï¼Œèƒ½çœŸæ­£çœ‹åˆ°ä¸€åˆ‡çš„ç—•è¿¹ï¼Œé‚£è¯¥å¤šå¥½å•Š
è¿›è¡Œâ€œEXPECT_CALLâ€å’Œæ¨¡æ‹Ÿæ–¹æ³•è°ƒç”¨æ—¶ï¼Ÿå¯¹äºæ¯æ¬¡é€šè¯ï¼Œæ‚¨ä¼š
å–œæ¬¢æŸ¥çœ‹å®ƒçš„å®é™…å‚æ•°å€¼ä»¥åŠ kMock è®¤ä¸ºçš„â€œEXPECT_CALLâ€
åŒ¹é…ï¼Ÿå¦‚æœæ‚¨ä»ç„¶éœ€è¦ä¸€äº›å¸®åŠ©æ¥æ‰¾å‡ºæ˜¯è°æ‹¨æ‰“äº†è¿™äº›ç”µè¯ï¼Œå¦‚ä½•
å…³äºèƒ½å¤Ÿåœ¨æ¯æ¬¡æ¨¡æ‹Ÿè°ƒç”¨æ—¶çœ‹åˆ°å®Œæ•´çš„å †æ ˆè·Ÿè¸ªï¼Ÿ</p>
<p>æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨â€œ--kmock_verbose=infoâ€è¿è¡Œæµ‹è¯•æ¥è§£é”æ­¤åŠŸèƒ½
æ——å¸œã€‚ä¾‹å¦‚ï¼Œç»™å®šæµ‹è¯•ç¨‹åºï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#005CC5">#</span><span class="token macro property directive keyword" style="color:#CF222E">include</span><span class="token macro property" style="color:#005CC5"> </span><span class="token macro property string" style="color:#C6105F">&quot;kmock/kmock.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">HasSubstr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> F</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> string</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo mock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillRepeatedly</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">HasSubstr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;d&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;good&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæ‚¨ä½¿ç”¨â€œ--kmock_verbose=infoâ€è¿è¡Œå®ƒï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> RUN       </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Foo.Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo_test.cc:14: EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock, F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_, _</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"> invoked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stack trace: </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo_test.cc:15: EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock, F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token plain">, </span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"> invoked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stack trace: </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo_test.cc:16: EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock, F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;c&quot;</span><span class="token plain">, HasSubstr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;d&quot;</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> invoked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stack trace: </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo_test.cc:14: Mock </span><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> call matches EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock, F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_, _</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Function call: F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">@0x7fff7c8dad40</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token plain">,@0x7fff7c8dad10</span><span class="token string" style="color:#C6105F">&quot;good&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stack trace: </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo_test.cc:15: Mock </span><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> call matches EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock, F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token plain">, </span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Function call: F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">@0x7fff7c8dada0</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token plain">,@0x7fff7c8dad70</span><span class="token string" style="color:#C6105F">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stack trace: </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo_test.cc:16: Failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Actual </span><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> call count doesn&#x27;t match EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock, F</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;c&quot;</span><span class="token plain">, HasSubstr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;d&quot;</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Expected: to be called once</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Actual: never called - unsatisfied and active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">  FAILED  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Foo.Bar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å‡è®¾é”™è¯¯æ˜¯ç¬¬ä¸‰ä¸ªâ€œEXPECT_CALLâ€ä¸­çš„â€œcâ€æ˜¯ä¸€ä¸ªæ‹¼å†™é”™è¯¯ï¼Œå¹¶ä¸”
å®é™…ä¸Šåº”è¯¥æ˜¯â€œaâ€ã€‚é€šè¿‡ä¸Šé¢çš„æ¶ˆæ¯ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°å®é™…çš„
<code>F(&quot;a&quot;, &quot;good&quot;)</code> è°ƒç”¨ä¸ç¬¬ä¸€ä¸ª <code>EXPECT_CALL</code> åŒ¹é…ï¼Œè€Œä¸æ˜¯ç¬¬ä¸‰ä¸ªï¼Œå› ä¸º
ä½ æƒ³ã€‚ç”±æ­¤å¯è§ï¼Œç¬¬ä¸‰ä¸ªâ€œEXPECT_CALLâ€æ˜¯
å†™é”™äº†ã€‚æ¡ˆå­è§£å†³äº†ã€‚</p>
<p>å¦‚æœæ‚¨å¯¹æ¨¡æ‹Ÿè°ƒç”¨è·Ÿè¸ªæ„Ÿå…´è¶£è€Œä¸æ˜¯å †æ ˆè·Ÿè¸ªï¼Œæ‚¨å¯ä»¥
åœ¨æµ‹è¯•ä¸­å°† <code>--kmock_verbose=info</code> ä¸ <code>--ktest_stack_trace_depth=0</code> ç»“åˆèµ·æ¥
å‘½ä»¤è¡Œã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="extending-kmock">æ‰©å±• kMock<a href="#extending-kmock" class="hash-link" aria-label="Direct link to æ‰©å±• kMock" title="Direct link to æ‰©å±• kMock">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="NewMatchers">å¿«é€Ÿç¼–å†™æ–°çš„åŒ¹é…å™¨<a href="#NewMatchers" class="hash-link" aria-label="Direct link to å¿«é€Ÿç¼–å†™æ–°çš„åŒ¹é…å™¨" title="Direct link to å¿«é€Ÿç¼–å†™æ–°çš„åŒ¹é…å™¨">â€‹</a></h3>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>è­¦å‘Šï¼škMock ä¸ä¿è¯åŒ¹é…å™¨ä½•æ—¶æˆ–å¤šå°‘æ¬¡
è°ƒç”¨ã€‚å› æ­¤ï¼Œæ‰€æœ‰åŒ¹é…å™¨å¿…é¡»æ˜¯åŠŸèƒ½çº¯çš„ã€‚çœ‹
<a href="#PureMatchers">æœ¬èŠ‚</a> äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p></div></div>
<p>â€œMATCHER*â€å®ç³»åˆ—å¯ç”¨äºè½»æ¾å®šä¹‰è‡ªå®šä¹‰åŒ¹é…å™¨ã€‚
è¯­æ³•ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> description_string_expression</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> statements</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°†å®šä¹‰ä¸€ä¸ªå…·æœ‰æ‰§è¡Œè¯­å¥çš„ç»™å®šåç§°çš„åŒ¹é…å™¨ï¼Œå…¶ä¸­
å¿…é¡»è¿”å›ä¸€ä¸ªâ€œboolâ€æ¥æŒ‡ç¤ºåŒ¹é…æ˜¯å¦æˆåŠŸã€‚åœ¨å£°æ˜ä¸­ï¼Œ
æ‚¨å¯ä»¥å¼•ç”¨â€œargâ€åŒ¹é…çš„å€¼ï¼Œå¹¶é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼•ç”¨å…¶ç±»å‹
<code>arg_type</code>ã€‚</p>
<p><em>æè¿°å­—ç¬¦ä¸²</em>æ˜¯ä¸€ä¸ªâ€œå­—ç¬¦ä¸²â€ç±»å‹çš„è¡¨è¾¾å¼ï¼Œè®°å½•äº†å†…å®¹
matcher ä¼šæ‰§è¡Œæ­¤æ“ä½œï¼Œå¹¶ç”¨äºåœ¨åŒ¹é…å¤±è´¥æ—¶ç”Ÿæˆå¤±è´¥æ¶ˆæ¯ã€‚
å®ƒå¯ä»¥ï¼ˆå¹¶ä¸”åº”è¯¥ï¼‰å¼•ç”¨ç‰¹æ®Šçš„â€œboolâ€å˜é‡â€œnegationâ€ï¼Œå¹¶ä¸”åº”è¯¥
å½“â€œnegationâ€ä¸ºâ€œfalseâ€æ—¶è¯„ä¼°åŒ¹é…å™¨çš„æè¿°ï¼Œæˆ–è€…
å½“â€œnegationâ€ä¸ºâ€œtrueâ€æ—¶åŒ¹é…å™¨çš„å¦å®šã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å…è®¸æè¿°å­—ç¬¦ä¸²ä¸ºç©ºï¼ˆ<code>&quot;&quot;</code>ï¼‰ï¼Œå…¶ä¸­
case kMock å°†ä½¿ç”¨åŒ¹é…å™¨åç§°ä¸­çš„å•è¯åºåˆ—ä½œä¸º
æè¿°ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">IsDivisibleBy7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arg </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…è®¸ä½ å†™</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Expects mock_foo.Bar(n) to be called where n is divisible by 7.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IsDivisibleBy7</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ–è€…ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Not</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Verifies that a value is divisible by 7 and the other is not.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">some_expression</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsDivisibleBy7</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">some_other_expression</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Not</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IsDivisibleBy7</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœä¸Šè¿°æ–­è¨€å¤±è´¥ï¼Œå®ƒä»¬å°†æ‰“å°å¦‚ä¸‹å†…å®¹ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  Value of: some_expression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Expected: is divisible by </span><span class="token number" style="color:#005CC5">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Actual: </span><span class="token number" style="color:#005CC5">27</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Value of: some_other_expression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Expected: not </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is divisible by </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Actual: </span><span class="token number" style="color:#005CC5">21</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶ä¸­æè¿°â€œâ€œå¯è¢« 7 æ•´é™¤â€â€å’Œâ€œâ€œä¸èƒ½ï¼ˆå¯è¢« 7 æ•´é™¤ï¼‰â€â€æ˜¯
æ ¹æ®åŒ¹é…å™¨åç§°â€œIsDivisibleBy7â€è‡ªåŠ¨è®¡ç®—ã€‚</p>
<p>æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„æè¿°ï¼ˆå°¤å…¶æ˜¯é‚£äº›
å¦å®šï¼‰å¯èƒ½æ²¡æœ‰é‚£ä¹ˆå¤§ã€‚æ‚¨å§‹ç»ˆå¯ä»¥ä½¿ç”¨â€œå­—ç¬¦ä¸²â€è¦†ç›–å®ƒä»¬
è‡ªå·±çš„è¡¨è¾¾ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">IsDivisibleBy7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        absl</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">StrCat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">negation </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;isn&#x27;t&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot; divisible by 7&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arg </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥å°†é™„åŠ ä¿¡æ¯æµå¼ä¼ è¾“åˆ°åä¸ºçš„éšè—å‚æ•°
<code>result_listener</code> è§£é‡Šæ¯”èµ›ç»“æœã€‚ä¾‹å¦‚ï¼Œæ›´å¥½çš„å®šä¹‰
<code>IsDivisibleBy7</code> çš„å€¼ä¸ºï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">IsDivisibleBy7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arg </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">result_listener </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;the remainder is &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arg </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æœ‰äº†è¿™ä¸ªå®šä¹‰ï¼Œä¸Šé¢çš„æ–­è¨€å°†ç»™å‡ºæ›´å¥½çš„ä¿¡æ¯ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  Value of: some_expression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Expected: is divisible by </span><span class="token number" style="color:#005CC5">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Actual: </span><span class="token number" style="color:#005CC5">27</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">the remainder is </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨åº”è¯¥è®© <code>MatchAndExplain()</code> æ‰“å°<em>ä»»ä½•é™„åŠ ä¿¡æ¯</em>
å¸®åŠ©ç”¨æˆ·äº†è§£æ¯”èµ›ç»“æœã€‚è¯·æ³¨æ„ï¼Œå®ƒåº”è¯¥è§£é‡Šä¸ºä»€ä¹ˆ
å¦‚æœæˆåŠŸåˆ™åŒ¹é…æˆåŠŸï¼ˆé™¤éå¾ˆæ˜æ˜¾ï¼‰ - è¿™åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¾ˆæœ‰ç”¨
åŒ¹é…å™¨åœ¨<code>Not()</code>å†…éƒ¨ä½¿ç”¨ã€‚ä¸éœ€è¦æ‰“å°å‚æ•°å€¼
æœ¬èº«ï¼Œå› ä¸º kMock å·²ç»ä¸ºæ‚¨æ‰“å°äº†å®ƒã€‚</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>æ³¨æ„ï¼šåŒ¹é…çš„å€¼çš„ç±»å‹ï¼ˆ<code>arg_type</code>ï¼‰ç”±
æ‚¨ä½¿ç”¨åŒ¹é…å™¨çš„ä¸Šä¸‹æ–‡æ˜¯ç”±ç¼–è¯‘å™¨æä¾›ç»™æ‚¨çš„ï¼Œæ‰€ä»¥
ä½ ä¸éœ€è¦æ‹…å¿ƒå£°æ˜å®ƒï¼ˆä½ ä¹Ÿä¸èƒ½ï¼‰ã€‚è¿™å…è®¸
åŒ¹é…å™¨æ˜¯å¤šæ€çš„ã€‚ä¾‹å¦‚ï¼Œ<code>IsDivisibleBy7()</code>å¯ç”¨äºåŒ¹é…
ä»»ä½•ç±»å‹ï¼Œå…¶ä¸­ <code>(arg % 7) == 0</code> çš„å€¼å¯ä»¥éšå¼è½¬æ¢ä¸º
<code>å¸ƒå°”</code>ã€‚åœ¨ä¸Šé¢çš„ Bar(IsDivisibleBy7()) ç¤ºä¾‹ä¸­ï¼Œå¦‚  æœæ–¹æ³• Bar() æ¥å—ä¸€ä¸ª
<code>int</code>ã€<code>arg_type</code> å°†æ˜¯ <code>int</code>ï¼›å¦‚æœå®ƒéœ€è¦ä¸€ä¸ªâ€œunsigned longâ€ï¼Œâ€œarg_typeâ€å°†
ä¸ºâ€œæ— ç¬¦å·é•¿â€ï¼›ç­‰ç­‰ã€‚</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="å¿«é€Ÿç¼–å†™æ–°çš„å‚æ•°åŒ–åŒ¹é…å™¨">å¿«é€Ÿç¼–å†™æ–°çš„å‚æ•°åŒ–åŒ¹é…å™¨<a href="#å¿«é€Ÿç¼–å†™æ–°çš„å‚æ•°åŒ–åŒ¹é…å™¨" class="hash-link" aria-label="Direct link to å¿«é€Ÿç¼–å†™æ–°çš„å‚æ•°åŒ–åŒ¹é…å™¨" title="Direct link to å¿«é€Ÿç¼–å†™æ–°çš„å‚æ•°åŒ–åŒ¹é…å™¨">â€‹</a></h3>
<p>æœ‰æ—¶æ‚¨éœ€è¦å®šä¹‰ä¸€ä¸ªå…·æœ‰å‚æ•°çš„åŒ¹é…å™¨ã€‚ä¸ºæ­¤ä½ å¯ä»¥
ä½¿ç”¨å®ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> description_string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> statements</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶ä¸­æè¿°å­—ç¬¦ä¸²å¯ä»¥æ˜¯ <code>&quot;&quot;</code> æˆ– <code>string</code> è¡¨è¾¾å¼
å¼•ç”¨â€œå¦å®šâ€å’Œâ€œparam_nameâ€ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HasAbsoluteValue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°†å…è®¸ä½ å†™ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Blah</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">HasAbsoluteValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™å¯èƒ½ä¼šå¯¼è‡´æ­¤æ¶ˆæ¯ï¼ˆå‡è®¾â€œnâ€ä¸º 10ï¼‰ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  Value of: Blah</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Expected: has absolute value </span><span class="token number" style="color:#005CC5">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Actual: </span><span class="token parameter variable" style="color:#E36209">-9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼ŒåŒ¹é…å™¨æè¿°åŠå…¶å‚æ•°éƒ½ä¼šè¢«æ‰“å°ï¼Œä½¿å¾—
æ¶ˆæ¯äººæ€§åŒ–ã€‚</p>
<p>åœ¨åŒ¹é…å™¨å®šä¹‰ä¸»ä½“ä¸­ï¼Œæ‚¨å¯ä»¥ç¼–å†™â€œfoo_typeâ€æ¥å¼•ç”¨ç±»å‹
åä¸ºâ€œfooâ€çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨æ­£æ–‡ä¸­
ä¸Šé¢<code>MATCHER_P(HasAbsoluteValue, value)</code>ï¼Œå¯ä»¥å†™<code>value_type</code>æ¥å¼•ç”¨
åˆ°â€œå€¼â€çš„ç±»å‹ã€‚</p>
<p>kMockè¿˜æä¾›<code>MATCHER_P2</code>ï¼Œ<code>MATCHER_P3</code>ï¼Œ...ï¼Œç›´åˆ°<code>MATCHER_P10</code>
æ”¯æŒå¤šå‚æ•°åŒ¹é…å™¨ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER_Pk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param_1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param_k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> description_string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> statements</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œè‡ªå®šä¹‰æè¿°å­—ç¬¦ä¸²é€‚ç”¨äºç‰¹å®šçš„<em>å®ä¾‹</em>
åŒ¹é…å™¨ï¼Œå…¶ä¸­å‚æ•°å·²ç»‘å®šåˆ°å®é™…å€¼ã€‚æ‰€ä»¥
é€šå¸¸æ‚¨ä¼šå¸Œæœ›å‚æ•°å€¼æˆä¸ºæè¿°çš„ä¸€éƒ¨åˆ†ã€‚æ¨¡æ‹Ÿ
è®©æ‚¨å¯ä»¥é€šè¿‡å¼•ç”¨æè¿°å­—ç¬¦ä¸²ä¸­çš„åŒ¹é…å™¨å‚æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹
è¡¨è¾¾ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PrintToString</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">MATCHER_P2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">InClosedRange</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> low</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           absl</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#8250DF">StrFormat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;%s in range [%s, %s]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> negation </span><span class="token operator" style="color:#D73A49">?</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;isn&#x27;t&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                           </span><span class="token function" style="color:#8250DF">PrintToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">low</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">PrintToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> low </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> arg </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> arg </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> hi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">InClosedRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°†ç”ŸæˆåŒ…å«ä»¥ä¸‹æ¶ˆæ¯çš„æ•…éšœï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  Expected: is </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> range </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">4</span><span class="token plain">, </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæ‚¨æŒ‡å®š <code>&quot;&quot;</code> ä½œä¸ºæè¿°ï¼Œåˆ™å¤±è´¥æ¶ˆæ¯å°†åŒ…å«
åŒ¹é…å™¨åç§°ä¸­çš„å•è¯åºåˆ—ï¼Œåè·Ÿæ‰“å°çš„å‚æ•°å€¼
ä½œä¸ºä¸€ä¸ªå…ƒç»„ã€‚ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MATCHER_P2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">InClosedRange</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> low</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_THAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">InClosedRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°†ç”ŸæˆåŒ…å«ä»¥ä¸‹æ–‡æœ¬çš„å¤±è´¥ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  Expected: </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> closed range </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">4</span><span class="token plain">, </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸ºäº†æ‰“å­—çš„ç›®çš„ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER_Pk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> description_string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½œä¸ºç®€å†™</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">p1_type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">pk_type</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FooMatcherPk</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">p1_type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pk_type</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p1_type p1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pk_type pk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“ä½ å†™ Foo(v1, ..., vk) æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ¨æ–­å‡º Foo(v1, ..., vk) çš„ç±»å‹
ä¸ºæ‚¨æä¾›å‚æ•°â€œv1â€ã€...å’Œâ€œvkâ€ã€‚å¦‚æœæ‚¨å¯¹ç»“æœä¸æ»¡æ„
ç±»å‹æ¨æ–­ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ˜¾å¼å®ä¾‹åŒ–æ¥æŒ‡å®šç±»å‹
æ¨¡æ¿ï¼Œå¦‚<code>Foo&lt;long, bool&gt;(5, false)</code>ã€‚æ­£å¦‚ä¹‹å‰æ‰€è¯´ï¼Œä½ ä¸èƒ½
ï¼ˆæˆ–éœ€è¦ï¼‰æŒ‡å®šâ€œarg_typeâ€ï¼Œå› ä¸ºå®ƒæ˜¯ç”±ä¸Šä¸‹æ–‡ç¡®å®šçš„
ä½¿ç”¨åŒ¹é…å™¨ã€‚</p>
<p>æ‚¨å¯ä»¥å°†è¡¨è¾¾å¼ <code>Foo(p1, ..., pk)</code> çš„ç»“æœåˆ†é…ç»™ç±»å‹å˜é‡
<code>FooMatcherPk&lt;p1_type, ..., pk_type&gt;</code>ã€‚è¿™åœ¨ä½œæ›²æ—¶å¾ˆæœ‰ç”¨
åŒ¹é…è€…ã€‚æ²¡æœ‰å‚æ•°æˆ–åªæœ‰ä¸€ä¸ªå‚æ•°çš„åŒ¹é…å™¨æœ‰
ç‰¹æ®Šç±»å‹ï¼šæ‚¨å¯ä»¥å°† <code>Foo()</code> åˆ†é…ç»™ <code>FooMatcher</code> ç±»å‹çš„å˜é‡ï¼Œå¹¶ä¸”
å°† <code>Foo(p)</code> åˆ†é…ç»™ <code>FooMatcherP&lt;p_type&gt;</code> ç±»å‹å˜é‡ã€‚</p>
<p>è™½ç„¶æ‚¨å¯ä»¥ä½¿ç”¨å¼•ç”¨ç±»å‹å®ä¾‹åŒ–åŒ¹é…å™¨æ¨¡æ¿ï¼Œä½†ä¼ é€’
é€šè¿‡æŒ‡é’ˆä¼ é€’å‚æ•°é€šå¸¸ä¼šä½¿ä»£ç æ›´å…·å¯è¯»æ€§ã€‚ç„¶è€Œï¼Œå¦‚æœä½ 
ä»ç„¶æƒ³é€šè¿‡å¼•ç”¨ä¼ é€’å‚æ•°ï¼Œè¯·æ³¨æ„åœ¨å¤±è´¥æ—¶
åŒ¹é…å™¨ç”Ÿæˆçš„æ¶ˆæ¯æ‚¨å°†çœ‹åˆ°å¼•ç”¨å¯¹è±¡çš„å€¼
ä½†ä¸æ˜¯å®ƒçš„åœ°å€ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ä¸åŒæ•°é‡çš„å‚æ•°é‡è½½åŒ¹é…å™¨ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">MATCHER_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Blah</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> description_string_1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">MATCHER_P2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Blah</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> description_string_2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è™½ç„¶åœ¨å®šä¹‰æ–°çš„æ—¶æ€»æ˜¯ä½¿ç”¨â€œMATCHER*â€å®å¾ˆè¯±äºº
matcherï¼Œä½ è¿˜åº”è¯¥è€ƒè™‘ç›´æ¥å®ç°matcheræ¥å£
ç›¸åï¼ˆè¯·å‚é˜…ä¸‹é¢çš„é£Ÿè°±ï¼‰ï¼Œç‰¹åˆ«æ˜¯å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨åŒ¹é…å™¨
å¾ˆå¤šã€‚è™½ç„¶è¿™äº›æ–¹æ³•éœ€è¦æ›´å¤šçš„å·¥ä½œï¼Œä½†å®ƒä»¬å¯ä»¥è®©æ‚¨æ›´å¥½åœ°æ§åˆ¶
è¢«åŒ¹é…çš„å€¼çš„ç±»å‹å’ŒåŒ¹é…å™¨å‚æ•°ï¼Œå…¶ä¸­
General ä¼šå¸¦æ¥æ›´å¥½çš„ç¼–è¯‘å™¨é”™è¯¯æ¶ˆæ¯ï¼Œä»é•¿è¿œæ¥çœ‹ä¼šå¸¦æ¥å›æŠ¥ã€‚
å®ƒä»¬è¿˜å…è®¸åŸºäºå‚æ•°ç±»å‹é‡è½½åŒ¹é…å™¨ï¼ˆä¸
ä»…åŸºäºå‚æ•°çš„æ•°é‡ï¼‰ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¼–å†™æ–°çš„å•æ€åŒ¹é…å™¨">ç¼–å†™æ–°çš„å•æ€åŒ¹é…å™¨<a href="#ç¼–å†™æ–°çš„å•æ€åŒ¹é…å™¨" class="hash-link" aria-label="Direct link to ç¼–å†™æ–°çš„å•æ€åŒ¹é…å™¨" title="Direct link to ç¼–å†™æ–°çš„å•æ€åŒ¹é…å™¨">â€‹</a></h3>
<p>å‚æ•°ç±»å‹â€œTâ€çš„åŒ¹é…å™¨å®ç°â€œTâ€çš„åŒ¹é…å™¨æ¥å£å¹¶æ‰§è¡Œ
ä¸¤ä»¶äº‹ï¼šå®ƒæµ‹è¯•ç±»å‹â€œTâ€çš„å€¼æ˜¯å¦ä¸åŒ¹é…å™¨åŒ¹é…ï¼Œå¹¶ä¸”å¯ä»¥
æè¿°å®ƒåŒ¹é…ä»€ä¹ˆæ ·çš„å€¼ã€‚åä¸€ç§èƒ½åŠ›ç”¨äº
å½“è¿åæœŸæœ›æ—¶ç”Ÿæˆå¯è¯»çš„é”™è¯¯æ¶ˆæ¯ã€‚</p>
<p><code>T</code> çš„åŒ¹é…å™¨å¿…é¡»å£°æ˜ä¸€ä¸ª typedefï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> is_ktest_matcher </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¹¶æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// Match a value and optionally explain into an ostream.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> matched </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> matcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">MatchAndExplain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> maybe_os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// where `value` is of type `T` and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// `maybe_os` is of type `std::ostream*`, where it can be null if the caller</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// is not interested in there textual explanation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">matcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">matcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DescribeNegationTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// where `os` is of type `std::ostream*`.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæ‚¨éœ€è¦è‡ªå®šä¹‰åŒ¹é…å™¨ï¼Œä½† <code>Truly()</code> ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼ˆä¾‹å¦‚ï¼Œ
æ‚¨å¯èƒ½å¯¹â€œTruly(predicate)â€çš„æè¿°æ–¹å¼ä¸æ»¡æ„ï¼Œæˆ–è€…æ‚¨
å¯èƒ½å¸Œæœ›ä½ çš„åŒ¹é…å™¨åƒ <code>Eq(value)</code> é‚£æ ·æ˜¯å¤šæ€çš„ï¼‰ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ª
åŒ¹é…å™¨åˆ†ä¸¤æ­¥åšä½ æƒ³åšçš„äº‹æƒ…ï¼šé¦–å…ˆå®ç°åŒ¹é…å™¨
æ¥å£ï¼Œç„¶åå®šä¹‰ä¸€ä¸ªå·¥å‚å‡½æ•°æ¥åˆ›å»ºåŒ¹é…å™¨å®ä¾‹ã€‚è¿™
ç¬¬äºŒæ­¥å¹¶ä¸æ˜¯ä¸¥æ ¼éœ€è¦çš„ï¼Œä½†å®ƒä½¿å¾—ä½¿ç”¨åŒ¹é…å™¨çš„è¯­æ³•
æ›´å¥½ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å®šä¹‰ä¸€ä¸ªåŒ¹é…å™¨æ¥æµ‹è¯•â€œintâ€æ˜¯å¦èƒ½è¢«7æ•´é™¤
ç„¶ååƒè¿™æ ·ä½¿ç”¨å®ƒï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Matcher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">DivisibleBy7Matcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> is_ktest_matcher </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MatchAndExplain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is divisible by 7&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeNegationTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is not divisible by 7&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Matcher</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DivisibleBy7</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DivisibleBy7Matcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">DivisibleBy7</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨å¯ä»¥é€šè¿‡å°†é™„åŠ ä¿¡æ¯æµå¼ä¼ è¾“åˆ°
<code>MatchAndExplain()</code> ä¸­çš„ <code>os</code> å‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">DivisibleBy7Matcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MatchAndExplain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> remainder </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> n </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remainder </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> os </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;the remainder is &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> remainder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> remainder </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç„¶åï¼Œâ€œEXPECT_THAT(x, DivisibleBy7());â€å¯èƒ½ä¼šç”Ÿæˆå¦‚ä¸‹æ¶ˆæ¯ï¼š</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Value of: x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Expected: is divisible by </span><span class="token number" style="color:#005CC5">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Actual: </span><span class="token number" style="color:#005CC5">23</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">the remainder is </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>{: .callout .tip}</code>
Tip: for convenience, <code>MatchAndExplain()</code> can take a <code>MatchResultListener*</code>
instead of <code>std::ostream*</code>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¼–å†™æ–°çš„å¤šæ€åŒ¹é…å™¨">ç¼–å†™æ–°çš„å¤šæ€åŒ¹é…å™¨<a href="#ç¼–å†™æ–°çš„å¤šæ€åŒ¹é…å™¨" class="hash-link" aria-label="Direct link to ç¼–å†™æ–°çš„å¤šæ€åŒ¹é…å™¨" title="Direct link to ç¼–å†™æ–°çš„å¤šæ€åŒ¹é…å™¨">â€‹</a></h3>
<p>å°†æˆ‘ä»¬ä¸Šé¢å­¦åˆ°çš„çŸ¥è¯†æ‰©å±•åˆ°<em>å¤šæ€</em>åŒ¹é…å™¨ç°åœ¨å°±ä¸€æ ·ç®€å•
åœ¨æ­£ç¡®çš„ä½ç½®æ·»åŠ æ¨¡æ¿ã€‚</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">NotNullMatcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> is_ktest_matcher </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// To implement a polymorphic matcher, we just need to make MatchAndExplain a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// template on its first argument.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// In this example, we want to use NotNull() with any pointer, so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// MatchAndExplain() accepts a pointer of any type as its first argument.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// In general, you can define MatchAndExplain() as an ordinary method or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// a method template, or even overload it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MatchAndExplain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> p </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nullptr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Describes the property of a value matching this matcher.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is not NULL&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Describes the property of a value NOT matching this matcher.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeNegationTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is NULL&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NotNullMatcher </span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">NotNullMatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The argument must be a non-NULL pointer.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é—ç•™åŒ¹é…å™¨å®æ–½">é—ç•™åŒ¹é…å™¨å®æ–½<a href="#é—ç•™åŒ¹é…å™¨å®æ–½" class="hash-link" aria-label="Direct link to é—ç•™åŒ¹é…å™¨å®æ–½" title="Direct link to é—ç•™åŒ¹é…å™¨å®æ–½">â€‹</a></h3>
<p>å®šä¹‰åŒ¹é…å™¨æ›¾ç»æœ‰ç‚¹å¤æ‚ï¼Œå…¶ä¸­éœ€è¦
å‡ ä¸ªæ”¯æŒç±»å’Œè™šå‡½æ•°ã€‚å®ç°åŒ¹é…å™¨
ä½¿ç”¨å¿…é¡»ä» <code>MatcherInterface&lt;T&gt;</code> æ´¾ç”Ÿçš„æ—§ç‰ˆ API è¾“å…¥ <code>T</code> å¹¶
è°ƒç”¨<code>MakeMatcher</code>æ¥æ„é€ å¯¹è±¡ã€‚</p>
<p>ç•Œé¢å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MatchResultListener</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Streams x to the underlying ostream; does nothing if the ostream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// is NULL.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MatchResultListener</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">operator</span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> T</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns the underlying ostream.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">stream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MatcherInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">MatcherInterface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns true if and only if the matcher matches x; also explains the match</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// result to &#x27;listener&#x27;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MatchAndExplain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MatchResultListener</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> listener</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Describes this matcher to an ostream.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Describes the negation of this matcher to an ostream.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeNegationTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¹¸è¿çš„æ˜¯ï¼Œå¤§å¤šæ•°æ—¶å€™æ‚¨å¯ä»¥è½»æ¾åœ°å®šä¹‰å¤šæ€åŒ¹é…å™¨
åœ¨ <code>MakePolymorphicMatcher()</code> çš„å¸®åŠ©ä¸‹ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•å°† <code>NotNull()</code> å®šä¹‰ä¸º
ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">MakePolymorphicMatcher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">MatchResultListener</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PolymorphicMatcher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">NotNullMatcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// To implement a polymorphic matcher, first define a COPYABLE class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// that has three members MatchAndExplain(), DescribeTo(), and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// DescribeNegationTo(), like the following.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// In this example, we want to use NotNull() with any pointer, so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// MatchAndExplain() accepts a pointer of any type as its first argument.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// In general, you can define MatchAndExplain() as an ordinary method or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// a method template, or even overload it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">T</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MatchAndExplain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       MatchResultListener</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic">/* listener */</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> p </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> </span><span class="token constant" style="color:#005CC5">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Describes the property of a value matching this matcher.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is not NULL&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Describes the property of a value NOT matching this matcher.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeNegationTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;is NULL&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// To construct a polymorphic matcher, pass an instance of the class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// to MakePolymorphicMatcher().  Note the return type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PolymorphicMatcher</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">NotNullMatcher</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakePolymorphicMatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NotNullMatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">NotNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// The argument must be a non-NULL pointer.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p><strong>æ³¨æ„ï¼š<strong>æ‚¨çš„å¤šæ€åŒ¹é…å™¨ç±»</strong>ä¸éœ€è¦</strong>éœ€è¦ç»§æ‰¿è‡ª
<code>MatcherInterface</code> æˆ–ä»»ä½•å…¶ä»–ç±»ï¼ŒåŠå…¶æ–¹æ³•<strong>ä¸éœ€ è¦</strong>
è™šæ‹Ÿçš„ã€‚</p></div></div>
<p>å°±åƒåœ¨å•æ€åŒ¹é…å™¨ä¸­ä¸€æ ·ï¼Œæ‚¨å¯ä»¥é€šè¿‡æµå¼ä¼ è¾“æ¥è§£é‡ŠåŒ¹é…ç»“æœ
<code>MatchAndExplain()</code> ä¸­çš„ <code>listener</code> å‚æ•°çš„é™„åŠ ä¿¡æ¯ã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ç¼–å†™æ–°çš„åŸºæ•°">ç¼–å†™æ–°çš„åŸºæ•°<a href="#ç¼–å†™æ–°çš„åŸºæ•°" class="hash-link" aria-label="Direct link to ç¼–å†™æ–°çš„åŸºæ•°" title="Direct link to ç¼–å†™æ–°çš„åŸºæ•°">â€‹</a></h3>
<p><code>Times()</code> ä¸­ä½¿ç”¨åŸºæ•°æ¥å‘Šè¯‰ kMock ä½ æœŸæœ›å‡ºç°å¤šå°‘æ¬¡
è°ƒç”¨å‘ç”Ÿã€‚å®ƒä¸å¿…æ˜¯ç²¾ç¡®çš„ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è¯´
<code>AtLeast(5)</code> æˆ– <code>Between(2, 4)</code>ã€‚</p>
<p>å¦‚æœåŸºæ•°çš„<a href="/docs/cpp/base/testing/kt/kmock_cheat_sheet#CardinalityList">å†…ç½®é›†</a>
ä¸é€‚åˆæ‚¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡å®æ–½ä»¥ä¸‹å†…å®¹è‡ªç”±å®šä¹‰è‡ªå·±çš„
æ¥å£ï¼ˆåœ¨å‘½åç©ºé—´â€œtestingâ€ä¸­ï¼‰ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CardinalityInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">CardinalityInterface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns true if and only if call_count calls will satisfy this cardinality.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsSatisfiedByCallCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> call_count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns true if and only if call_count calls will saturate this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// cardinality.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsSaturatedByCallCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> call_count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Describes self to an ostream.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¾‹å¦‚ï¼Œè¦æŒ‡å®šè°ƒç”¨å¿…é¡»å‘ç”Ÿå¶æ•°æ¬¡ï¼Œæ‚¨å¯ä»¥
å†™</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Cardinality</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">CardinalityInterface</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">MakeCardinality</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">EvenNumberCardinality</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">CardinalityInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsSatisfiedByCallCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> call_count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">call_count </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IsSaturatedByCallCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> call_count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">void</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DescribeTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ostream</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">os </span><span class="token operator" style="color:#D73A49">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;called even number of times&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cardinality </span><span class="token function" style="color:#8250DF">EvenNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeCardinality</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> EvenNumberCardinality</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">EvenNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="QuickNewActions">ç¼–å†™æ–°åŠ¨ä½œ<a href="#QuickNewActions" class="hash-link" aria-label="Direct link to ç¼–å†™æ–°åŠ¨ä½œ" title="Direct link to ç¼–å†™æ–°åŠ¨ä½œ">â€‹</a></h3>
<p>å¦‚æœå†…ç½®æ“ä½œä¸é€‚åˆæ‚¨ï¼Œæ‚¨å¯ä»¥è½»æ¾å®šä¹‰è‡ªå·±çš„æ“ä½œã€‚
æ‚¨æ‰€éœ€è¦çš„åªæ˜¯ä¸€ä¸ªå…·æœ‰ä¸æ¨¡æ‹Ÿå…¼å®¹çš„ç­¾åçš„è°ƒç”¨è¿ç®—ç¬¦
åŠŸèƒ½ã€‚æ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨ lambdaï¼š</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MockFunction&lt;int(int)&gt; mock;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPECT_CALL(mock, Call).WillOnce([](const int input) { return input * 7; });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPECT_EQ(14, mock.AsStdFunction()(2));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ–è€…å¸¦æœ‰è°ƒç”¨è¿ç®—ç¬¦çš„ç»“æ„ï¼ˆç”šè‡³æ˜¯æ¨¡æ¿åŒ–çš„ç»“æ„ï¼‰ï¼š</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">struct MultiplyBy {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template &lt;typename T&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  T operator()(T arg) { return arg * multiplier; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int multiplier;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Then use:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// EXPECT_CALL(...).WillOnce(MultiplyBy{7});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¯è°ƒç”¨å¯¹è±¡ä¸å¸¦å‚æ•°ä¹Ÿå¯ä»¥ï¼Œå¿½ç•¥å‚æ•°
æä¾›ç»™æ¨¡æ‹Ÿå‡½æ•°ï¼š</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MockFunction&lt;int(int)&gt; mock;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPECT_CALL(mock, Call).WillOnce([] { return 17; });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPECT_EQ(17, mock.AsStdFunction()(0));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“ä¸â€œWillOnceâ€ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¯è°ƒç”¨å¯¹è±¡å¯ä»¥å‡è®¾å®ƒæœ€å¤šä¼šè¢«è°ƒç”¨
ä¸€æ¬¡å¹¶ä¸”å…è®¸æ˜¯ä»…ç§»åŠ¨ç±»å‹ï¼š</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// An action that contains move-only types and has an &amp;&amp;-qualified operator,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// demanding in the type system that it be called at most once. This can be</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// used with WillOnce, but the compiler will reject it if handed to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// WillRepeatedly.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">struct MoveOnlyAction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std::unique_ptr&lt;int&gt; move_only_state;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std::unique_ptr&lt;int&gt; operator()() &amp;&amp; { return std::move(move_only_state); }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MockFunction&lt;std::unique_ptr&lt;int&gt;()&gt; mock;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPECT_CALL(mock, Call).WillOnce(MoveOnlyAction{std::make_unique&lt;int&gt;(17)});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPECT_THAT(mock.AsStdFunction()(), Pointee(Eq(17)));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ›´ä¸€èˆ¬åœ°è¯´ï¼Œä¸ç­¾åä¸º<code>R(Args...)</code>çš„æ¨¡æ‹Ÿå‡½æ•°ä¸€èµ·ä½¿ç”¨
å¯¹è±¡å¯ä»¥æ˜¯ä»»ä½•å¯è½¬æ¢ä¸º <code>OnceAction&lt;R(Args...)&gt;</code> æˆ–
<code>æ“ä½œ&lt;R(å‚æ•°...)&gt;</code>ã€‚ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«åœ¨äº <code>OnceAction</code> æœ‰
è¾ƒå¼±çš„è¦æ±‚ï¼ˆ<code>Action</code>éœ€è¦ä¸€ä¸ªå¯å¤åˆ¶æ„é€ çš„è¾“å…¥ï¼Œå¯ä»¥æ˜¯
é‡å¤è°ƒç”¨ï¼Œè€Œ<code>OnceAction</code>åªéœ€è¦å¯ç§»åŠ¨æ„é€ å¹¶ä¸”
æ”¯æŒâ€œ&amp;&amp;â€é™å®šçš„è°ƒç”¨è¿ç®—ç¬¦ï¼‰ï¼Œä½†åªèƒ½ä¸â€œWillOnceâ€ä¸€èµ·ä½¿ç”¨ã€‚
<code>OnceAction</code> é€šå¸¸ä»…åœ¨æ”¯æŒä»…ç§»åŠ¨ç±»å‹æˆ–
éœ€è¦ç±»å‹ç³»ç»Ÿçš„æ“ä½œä¿è¯å®ƒä»¬æœ€å¤šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<p>é€šå¸¸ä¸éœ€è¦å¼•ç”¨<code>OnceAction</code>å’Œ<code>Action</code>æ¨¡æ¿
ç›´æ¥åœ¨æ‚¨çš„æ“ä½œä¸­ï¼šå¸¦æœ‰è°ƒç”¨è¿ç®—ç¬¦çš„ç»“æ„æˆ–ç±»å°±è¶³å¤Ÿäº†ï¼Œ
å¦‚ä¸Šé¢çš„ä¾‹å­ã€‚ä½†æ›´é«˜çº§çš„å¤šæ€è¡Œä¸ºéœ€è¦äº†è§£
æ¨¡æ‹Ÿå‡½æ•°çš„ç‰¹å®šè¿”å›ç±»å‹å¯ä»¥å®šä¹‰æ¨¡æ¿åŒ–è½¬æ¢
è¿è¥å•†ä½¿ä¹‹æˆä¸ºå¯èƒ½ã€‚æœ‰å…³ç¤ºä¾‹ï¼Œè¯·å‚é˜…â€œkmock-actions.hâ€ã€‚</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="æ—§çš„åŸºäºå®çš„æ“ä½œ">æ—§çš„åŸºäºå®çš„æ“ä½œ<a href="#æ—§çš„åŸºäºå®çš„æ“ä½œ" class="hash-link" aria-label="Direct link to æ—§çš„åŸºäºå®çš„æ“ä½œ" title="Direct link to æ—§çš„åŸºäºå®çš„æ“ä½œ">â€‹</a></h4>
<p>åœ¨ C++11 ä¹‹å‰ï¼Œä¸æ”¯æŒåŸºäºå‡½å­çš„æ“ä½œï¼›è€åŠæ³•
ç¼–å†™åŠ¨ä½œæ˜¯é€šè¿‡ä¸€ç»„â€œACTION*â€å®æ¥å®Œæˆçš„ã€‚æˆ‘ä»¬å»ºè®®é¿å…ä½¿ç”¨å®ƒä»¬
åœ¨æ–°ä»£ç ä¸­ï¼›ä»–ä»¬åœ¨å®èƒŒåéšè—äº†å¾ˆå¤šé€»è¾‘ï¼Œå¯èƒ½å¯¼è‡´
æ›´éš¾ç†è§£çš„ç¼–è¯‘å™¨é”™è¯¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨è¿™é‡Œä»‹ç»å®ƒä»¬
å®Œæ•´æ€§ã€‚</p>
<p>é€šè¿‡å†™ä½œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> statements</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨å‘½åç©ºé—´èŒƒå›´å†…ï¼ˆå³ä¸åœ¨ç±»æˆ–å‡½æ•°å†…ï¼‰ï¼Œæ‚¨å°†å®šä¹‰ä¸€ä¸ª
æ‰§è¡Œè¯­å¥çš„å…·æœ‰ç»™å®šåç§°çš„æ“ä½œã€‚è¿”å›çš„å€¼
<code>statements</code> å°†ç”¨ä½œæ“ä½œçš„è¿”å›å€¼ã€‚é‡Œé¢çš„
è¯­å¥ï¼Œæ‚¨å¯ä»¥å°†æ¨¡æ‹Ÿå‡½æ•°çš„ç¬¬ K ä¸ªï¼ˆä» 0 å¼€å§‹ï¼‰å‚æ•°å¼•ç”¨ä¸º
<code>argK</code>ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">IncrementArg1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">++</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">arg1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>allows you to write</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IncrementArg1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·æ³¨æ„ï¼Œæ‚¨ä¸éœ€è¦æŒ‡å®šæ¨¡æ‹Ÿå‡½æ•°å‚æ•°çš„ç±»å‹ã€‚
ä¸è¿‡è¯·æ”¾å¿ƒï¼Œæ‚¨çš„ä»£ç æ˜¯ç±»å‹å®‰å…¨çš„ï¼šå¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œæ‚¨å°†æ”¶åˆ°ç¼–è¯‘å™¨é”™è¯¯ï¼š
<code>*arg1</code> ä¸æ”¯æŒ <code>++</code> è¿ç®—ç¬¦ï¼Œæˆ–è€…å¦‚æœ <code>++(*arg1)</code> çš„ç±»å‹ä¸æ”¯æŒ
ä¸æ¨¡æ‹Ÿå‡½æ•°çš„è¿”å›ç±»å‹å…¼å®¹ã€‚</p>
<p>å¦ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">arg2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Blah</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">arg1 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> arg0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®šä¹‰ä¸€ä¸ªåŠ¨ä½œâ€œFoo()â€ï¼Œç”¨ 5 è°ƒç”¨å‚æ•° #2ï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰ï¼Œ
è°ƒç”¨å‡½æ•°â€œBlah()â€ï¼Œå°†å‚æ•° #1 æŒ‡å‘çš„å€¼è®¾ç½®ä¸º 0ï¼Œå¹¶ä¸”
è¿”å›å‚æ•°#0ã€‚</p>
<p>ä¸ºäº†æ›´åŠ æ–¹ä¾¿å’Œçµæ´»ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é¢„å®šä¹‰çš„
<code>ACTION</code> æ­£æ–‡ä¸­çš„ç¬¦å·ï¼š</p>
<table><thead><tr><th style="text-align:left"><code>argK_type</code></th><th style="text-align:left">æ¨¡æ‹Ÿå‡½æ•°çš„ç¬¬ K ä¸ªï¼ˆä» 0 å¼€å§‹ï¼‰å‚æ•°çš„ç±»å‹</th></tr></thead><tbody><tr><td style="text-align:left"><code>args</code></td><td style="text-align:left">æ¨¡æ‹Ÿå‡½æ•°çš„æ‰€æœ‰å‚æ•°ä½œä¸ºå…ƒç»„</td></tr><tr><td style="text-align:left"><code>args_type</code></td><td style="text-align:left">æ¨¡æ‹Ÿå‡½æ•°çš„æ‰€æœ‰å‚æ•°çš„ç±»å‹ä½œä¸ºå…ƒç»„</td></tr><tr><td style="text-align:left"><code>return_type</code></td><td style="text-align:left">æ¨¡æ‹Ÿå‡½æ•°çš„è¿”å›ç±»å‹</td></tr><tr><td style="text-align:left"><code>function_type</code></td><td style="text-align:left">æ¨¡æ‹Ÿå‡½æ•°çš„ç±»å‹</td></tr></tbody></table>
<p>ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨â€œACTIONâ€ä½œä¸ºæ¨¡æ‹Ÿå‡½æ•°çš„å­˜æ ¹æ“ä½œæ—¶ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">DoSomething</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> ptr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>we have:</p>
<table><thead><tr><th>Pre-defined Symbol</th><th>Is Bound To</th></tr></thead><tbody><tr><td><code>arg0</code></td><td>the value of <code>flag</code></td></tr><tr><td><code>arg0_type</code></td><td>the type <code>bool</code></td></tr><tr><td><code>arg1</code></td><td>the value of <code>ptr</code></td></tr><tr><td><code>arg1_type</code></td><td>the type <code>int*</code></td></tr><tr><td><code>args</code></td><td>the tuple <code>(flag, ptr)</code></td></tr><tr><td><code>args_type</code></td><td>the type <code>std::tuple&lt;bool, int*&gt;</code></td></tr><tr><td><code>return_type</code></td><td>the type <code>int</code></td></tr><tr><td><code>function_type</code></td><td>the type <code>int(bool, int*)</code></td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ä¼ ç»Ÿçš„åŸºäºå®çš„å‚æ•°åŒ–æ“ä½œ">ä¼ ç»Ÿçš„åŸºäºå®çš„å‚æ•°åŒ–æ“ä½œ<a href="#ä¼ ç»Ÿçš„åŸºäºå®çš„å‚æ•°åŒ–æ“ä½œ" class="hash-link" aria-label="Direct link to ä¼ ç»Ÿçš„åŸºäºå®çš„å‚æ•°åŒ–æ“ä½œ" title="Direct link to ä¼ ç»Ÿçš„åŸºäºå®çš„å‚æ•°åŒ–æ“ä½œ">â€‹</a></h4>
<p>æœ‰æ—¶æ‚¨éœ€è¦å‚æ•°åŒ–æ‚¨å®šä¹‰çš„æ“ä½œã€‚ä¸ºæ­¤æˆ‘ä»¬æœ‰
å¦ä¸€ä¸ªå®</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> statements</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Add</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> arg0 </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å°†å…è®¸ä½ å†™</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// Returns argument #0 + 5.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ¯è¯­â€œå‚æ•°â€æ¥è¡¨ç¤ºç”¨äºè°ƒç”¨
æ¨¡æ‹Ÿå‡½æ•°ï¼Œä»¥åŠç”¨äºå®ä¾‹åŒ–çš„å€¼çš„æœ¯è¯­â€œå‚æ•°â€
è¡ŒåŠ¨ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œæ‚¨ä¹Ÿä¸éœ€è¦æä¾›å‚æ•°çš„ç±»å‹ã€‚è®¤ä¸º
å‚æ•°åä¸ºâ€œparamâ€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨kMockå®šä¹‰çš„ç¬¦å·
<code>param_type</code> æŒ‡ç¼–è¯‘å™¨æ¨æ–­çš„å‚æ•°ç±»å‹ã€‚
ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„â€œACTION_P(Add, n)â€ä¸»ä½“ä¸­ï¼Œæ‚¨å¯ä»¥ç¼–å†™â€œn_typeâ€
<code>n</code> çš„ç±»å‹ã€‚</p>
<p>kMockè¿˜æä¾›<code>ACTION_P2</code>ã€<code>ACTION_P3</code>ç­‰æ”¯æŒå¤šå‚æ•°
è¡ŒåŠ¨ã€‚ä¾‹å¦‚ï¼Œ</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION_P2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReturnDistanceTo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> dx </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> arg0 </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">double</span><span class="token plain"> dy </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> arg1 </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dx</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">dx </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> dy</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">dy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è®©ä½ å†™</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnDistanceTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">26.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ‚¨å¯ä»¥å°†â€œACTIONâ€è§†ä¸ºé€€åŒ–çš„  å‚æ•°åŒ–æ“ä½œï¼Œå…¶ä¸­
å‚æ•°ä¸º0ã€‚</p>
<p>æ‚¨è¿˜å¯ä»¥è½»æ¾å®šä¹‰åœ¨å¤šä¸ªå‚æ•°ä¸Šé‡è½½çš„æ“ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Plus</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">ACTION_P2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Plus</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="é™åˆ¶-action-ä¸­å‚æ•°æˆ–å‚æ•°çš„ç±»å‹">é™åˆ¶ ACTION ä¸­å‚æ•°æˆ–å‚æ•°çš„ç±»å‹<a href="#é™åˆ¶-action-ä¸­å‚æ•°æˆ–å‚æ•°çš„ç±»å‹" class="hash-link" aria-label="Direct link to é™åˆ¶ ACTION ä¸­å‚æ•°æˆ–å‚æ•°çš„ç±»å‹" title="Direct link to é™åˆ¶ ACTION ä¸­å‚æ•°æˆ–å‚æ•°çš„ç±»å‹">â€‹</a></h3>
<p>ä¸ºäº†æœ€å¤§ç¨‹åº¦åœ°ç®€æ´å’Œå¯é‡ç”¨æ€§ï¼Œâ€œACTION*â€å®ä¸ä¼šè¦æ±‚æ‚¨
æä¾›æ¨¡æ‹Ÿå‡½æ•°å‚æ•°å’Œæ“ä½œå‚æ•°çš„ç±»å‹ã€‚
ç›¸åï¼Œæˆ‘ä»¬è®©ç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬æ¨æ–­ç±»å‹ã€‚</p>
<p>ç„¶è€Œï¼Œæœ‰æ—¶æˆ‘ä»¬å¯èƒ½å¸Œæœ›æ›´æ˜ç¡®åœ°äº†è§£ç±»å‹ã€‚æœ‰
æœ‰å‡ ä¸ªæŠ€å·§å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Makes sure arg0 can be converted to int.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> arg0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> use n instead of arg0 here </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">ACTION_P</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Bar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Makes sure the type of arg1 is const char*.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">StaticAssertTypeEq</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">const</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">char</span><span class="token generic-function generic class-name operator" style="color:#D73A49">*</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> arg1_type</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Makes sure param can be converted to bool.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> flag </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> param</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶ä¸­ <code>StaticAssertTypeEq</code> æ˜¯ googletest ä¸­çš„ç¼–è¯‘æ—¶æ–­è¨€
éªŒè¯ä¸¤ä¸ªç±»å‹æ˜¯å¦ç›¸åŒã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="writing-new-action-templates-quickly">Writing New Action Templates Quickly<a href="#writing-new-action-templates-quickly" class="hash-link" aria-label="Direct link to Writing New Action Templates Quickly" title="Direct link to Writing New Action Templates Quickly">â€‹</a></h3>
<p>æœ‰æ—¶ä½ æƒ³ç»™ä¸€ä¸ªåŠ¨ä½œæ˜ç¡®çš„æ¨¡æ¿å‚æ•°ï¼Œä½†ä¸èƒ½
ä»å…¶å€¼å‚æ•°æ¨æ–­ã€‚ <code>ACTION_TEMPLATE()</code> æ”¯æŒè¿™ä¸€ç‚¹å¹¶ä¸”å¯ä»¥
è¢«è§†ä¸ºâ€œACTION()â€å’Œâ€œACTION_P*()â€çš„æ‰©å±•ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">ACTION_TEMPLATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ActionName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#8250DF">HAS_m_TEMPLATE_PARAMS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kind1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kind_m</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name_m</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#8250DF">AND_n_VALUE_PARAMS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p_n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> statements</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®šä¹‰ä¸€ä¸ªæ“ä½œæ¨¡æ¿ï¼Œå®ƒé‡‡ç”¨ <em>m</em> ä¸ªæ˜¾å¼æ¨¡æ¿å‚æ•°å’Œ <em>n</em> ä¸ª
å€¼å‚æ•°ï¼Œå…¶ä¸­ <em>m</em> ä½äº [1, 10] ä¸­ï¼Œ<em>n</em> ä½äº [0, 10] ä¸­ã€‚ <code>name_i</code> æ˜¯
ç¬¬ <em>i</em> ä¸ªæ¨¡æ¿å‚æ•°çš„åç§°ï¼Œâ€œkind_iâ€æŒ‡å®šå®ƒæ˜¯å¦æ˜¯
<code>typename</code>ï¼Œä¸€ä¸ªæ•´å‹å¸¸é‡ï¼Œæˆ–è€…ä¸€ä¸ªæ¨¡æ¿ã€‚ <code>p_i</code> æ˜¯ç¬¬ <em>i</em> ä¸ªçš„åç§°
å€¼å‚æ•°ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">// DuplicateArg&lt;k, T&gt;(output) converts the k-th argument of the mock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">// function to type T and copies it to *output.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#8250DF">ACTION_TEMPLATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DuplicateArg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Note the comma between int and k:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#8250DF">HAS_2_TEMPLATE_PARAMS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#8250DF">AND_1_VALUE_PARAMS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">output </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">T</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">get</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">k</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¦åˆ›å»ºæ“ä½œæ¨¡æ¿çš„å®ä¾‹ï¼Œè¯·ç¼–å†™ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token generic-function function" style="color:#8250DF">ActionName</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">t1</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> t_m</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v_n</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶ä¸­â€œtâ€æ˜¯æ¨¡æ¿å‚æ•°ï¼Œâ€œvâ€æ˜¯å€¼å‚æ•°ã€‚
å€¼å‚æ•°ç±»å‹ç”±ç¼–è¯‘å™¨æ¨æ–­ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token generic-function function" style="color:#8250DF">DuplicateArg</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">1</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">unsigned</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">char</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœæ‚¨æƒ³æ˜¾å¼æŒ‡å®šå€¼å‚æ•°ç±»å‹ï¼Œæ‚¨å¯ä»¥æä¾›
é™„åŠ æ¨¡æ¿å‚æ•°ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token generic-function function" style="color:#8250DF">ActionName</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name" style="color:#116329">t1</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> t_m</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> u1</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">.</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> u_k</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v_n</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>where <code>u_i</code> is the desired type of <code>v_i</code>.</p>
<p><code>ACTION_TEMPLATE</code> å’Œ <code>ACTION</code>/<code>ACTION_P*</code> å¯ä»¥åœ¨æ•°é‡ä¸Šé‡è½½
value å‚æ•°ï¼Œä½†ä¸å½±å“æ¨¡æ¿å‚æ•°çš„æ•°é‡ã€‚å¦‚æœæ²¡æœ‰
é™åˆ¶ï¼Œä»¥ä¸‹å«ä¹‰ä¸æ¸…æ¥šï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token generic-function function" style="color:#8250DF">OverloadedAction</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name keyword" style="color:#CF222E">int</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name" style="color:#116329"> </span><span class="token generic-function generic class-name keyword" style="color:#CF222E">bool</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æˆ‘ä»¬æ˜¯å¦ä½¿ç”¨å•æ¨¡æ¿å‚æ•°æ“ä½œï¼Œå…¶ä¸­â€œboolâ€æŒ‡çš„æ˜¯ç±»å‹
<code>x</code> çš„ï¼Œæˆ–è€…è¦æ±‚ç¼–è¯‘å™¨æ¨æ–­çš„ä¸¤ä¸ªæ¨¡æ¿å‚æ•°æ“ä½œ
<code>x</code> çš„ç±»å‹ï¼Ÿ</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-the-action-objects-type">Using the ACTION Object&#x27;s Type<a href="#using-the-action-objects-type" class="hash-link" aria-label="Direct link to Using the ACTION Object&#x27;s Type" title="Direct link to Using the ACTION Object&#x27;s Type">â€‹</a></h3>
<p>å¦‚æœæ‚¨æ­£åœ¨ç¼–å†™ä¸€ä¸ªè¿”å›â€œACTIONâ€å¯¹è±¡çš„å‡½æ•°ï¼Œåˆ™éœ€è¦
çŸ¥é“å®ƒçš„ç±»å‹ã€‚ç±»å‹å–å†³äºç”¨äºå®šä¹‰æ“ä½œçš„å®å’Œ
å‚æ•°ç±»å‹ã€‚è§„åˆ™ç›¸å¯¹ç®€å•ï¼š</p>
<table><thead><tr><th>Given Definition</th><th>Expression</th><th>Has Type</th></tr></thead><tbody><tr><td><code>ACTION(Foo)</code></td><td><code>Foo()</code></td><td><code>FooAction</code></td></tr><tr><td><code>ACTION_TEMPLATE(Foo, HAS_m_TEMPLATE_PARAMS(...), AND_0_VALUE_PARAMS())</code></td><td><code>Foo&lt;t1, ..., t_m&gt;()</code></td><td><code>FooAction&lt;t1, ..., t_m&gt;</code></td></tr><tr><td><code>ACTION_P(Bar, param)</code></td><td><code>Bar(int_value)</code></td><td><code>BarActionP&lt;int&gt;</code></td></tr><tr><td><code>ACTION_TEMPLATE(Bar, HAS_m_TEMPLATE_PARAMS(...), AND_1_VALUE_PARAMS(p1))</code></td><td><code>Bar&lt;t1, ..., t_m&gt;(int_value)</code></td><td><code>BarActionP&lt;t1, ..., t_m, int&gt;</code></td></tr><tr><td><code>ACTION_P2(Baz, p1, p2)</code></td><td><code>Baz(bool_value, int_value)</code></td><td><code>BazActionP2&lt;bool, int&gt;</code></td></tr><tr><td><code>ACTION_TEMPLATE(Baz, HAS_m_TEMPLATE_PARAMS(...), AND_2_VALUE_PARAMS(p1, p2))</code></td><td><code>Baz&lt;t1, ..., t_m&gt;(bool_value, int_value)</code></td><td><code>BazActionP2&lt;t1, ..., t_m, bool, int&gt;</code></td></tr><tr><td>...</td><td>...</td><td>...</td></tr></tbody></table>
<p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¿…é¡»é€‰æ‹©ä¸åŒçš„åç¼€ï¼ˆâ€œActionâ€ã€â€œActionPâ€ã€â€œActionP2â€ã€
ç­‰ç­‰ï¼‰å¯¹äºå…·æœ‰ä¸åŒ æ•°é‡å€¼å‚æ•°çš„æ“ä½œï¼Œæˆ–è€…æ“ä½œ
å®šä¹‰çš„æ•°é‡ä¸èƒ½è¿‡å¤šã€‚</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="NewMonoActions">ç¼–å†™æ–°çš„å•æ€åŠ¨ä½œ<a href="#NewMonoActions" class="hash-link" aria-label="Direct link to ç¼–å†™æ–°çš„å•æ€åŠ¨ä½œ" title="Direct link to ç¼–å†™æ–°çš„å•æ€åŠ¨ä½œ">â€‹</a></h3>
<p>è™½ç„¶â€œACTION*â€å®éå¸¸æ–¹ä¾¿ï¼Œä½†æœ‰æ—¶å®ƒä»¬
ä¸å½“ã€‚ä¾‹å¦‚ï¼Œå°½ç®¡å‰é¢çš„é£Ÿè°±ä¸­å±•ç¤ºäº†ä¸€äº›æŠ€å·§ï¼Œ
å®ƒä»¬ä¸å…è®¸æ‚¨ç›´æ¥æŒ‡å®šæ¨¡æ‹Ÿå‡½æ•°å‚æ•°çš„ç±»å‹å¹¶ä¸”
æ“ä½œå‚æ•°ï¼Œè¿™é€šå¸¸ä¼šå¯¼è‡´æœªä¼˜åŒ–çš„ç¼–è¯‘å™¨é”™è¯¯
å¯èƒ½ä¼šè®©ä¸ç†Ÿæ‚‰çš„ç”¨æˆ·æ„Ÿåˆ°å›°æƒ‘çš„æ¶ˆæ¯ã€‚ä»–ä»¬ä¹Ÿä¸å…è®¸è¶…è½½
åŸºäºå‚æ•°ç±»å‹çš„æ“ä½œï¼Œæ— éœ€è·³è¿‡ä¸€äº›ç¯èŠ‚ã€‚</p>
<p><code>ACTION*</code> å®çš„æ›¿ä»£æ–¹æ³•æ˜¯å®ç°
<code>::testing::ActionInterface&lt;F&gt;</code>ï¼Œå…¶ä¸­ <code>F</code> æ˜¯æ¨¡æ‹Ÿå‡½æ•°çš„ç±»å‹
å°†ä½¿ç”¨è¯¥æ“ä½œã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">F</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ActionInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">~</span><span class="token function" style="color:#8250DF">ActionInterface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Performs the action.  Result is the return type of function type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// F, and ArgumentTuple is the tuple of arguments of F.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// For example, if F is int(bool, const string&amp;), then Result would</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// be int, and ArgumentTuple would be std::tuple&lt;bool, const string&amp;&gt;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">virtual</span><span class="token plain"> Result </span><span class="token function" style="color:#8250DF">Perform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> ArgumentTuple</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">Action</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">ActionInterface</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">MakeAction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IncrementMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">IncrementArgumentAction</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">ActionInterface</span><span class="token base-clause operator" style="color:#D73A49">&lt;</span><span class="token base-clause class-name" style="color:#116329">IncrementMethod</span><span class="token base-clause operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Perform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">tuple</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">override</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">int</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> p </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">get</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">0</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Grabs the first argument.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">p</span><span class="token operator" style="color:#D73A49">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Action</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">IncrementMethod</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">IncrementArgument</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakeAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> IncrementArgumentAction</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Baz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">IncrementArgument</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">Baz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Should return 5 and change n to 6.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="NewPolyActions">ç¼–å†™æ–°çš„å¤šæ€åŠ¨ä½œ<a href="#NewPolyActions" class="hash-link" aria-label="Direct link to ç¼–å†™æ–°çš„å¤šæ€åŠ¨ä½œ" title="Direct link to ç¼–å†™æ–°çš„å¤šæ€åŠ¨ä½œ">â€‹</a></h3>
<p>å‰é¢çš„é£Ÿè°±å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•å®šä¹‰è‡ªå·±çš„æ“ä½œã€‚è¿™ä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œ
åªä¸è¿‡æ‚¨éœ€è¦çŸ¥é“è¯¥æ“ä½œå°†åœ¨å…¶ä¸­æ‰§è¡Œçš„å‡½æ•°çš„ç±»å‹
è¢«ä½¿ç”¨ã€‚æœ‰æ—¶è¿™å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³ä½¿ç”¨
å…·æœ‰<em>ä¸åŒ</em>ç±»å‹çš„å‡½æ•°ä¸­çš„æ“ä½œï¼ˆä¾‹å¦‚â€œReturn()â€å’Œ
<code>SetArgPointee()</code>)ã€‚</p>
<p>å¦‚æœä¸€ä¸ªåŠ¨ä½œå¯ä»¥åœ¨å¤šç§ç±»å‹çš„æ¨¡æ‹Ÿå‡½æ•°ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬è¯´å®ƒæ˜¯
<em>å¤šæ€</em>ã€‚ <code>MakePolymorphicAction()</code> å‡½æ•°æ¨¡æ¿å¯ä»¥å¾ˆå®¹æ˜“åœ°
å®šä¹‰è¿™æ ·ä¸€ä¸ªåŠ¨ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">namespace</span><span class="token plain"> testing </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Impl</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PolymorphicAction</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">Impl</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakePolymorphicAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> Impl</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> impl</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// namespace testing</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½œä¸ºç¤ºä¾‹ï¼Œ è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¿”å›ç¬¬äºŒä¸ªå‚æ•°çš„æ“ä½œ
æ¨¡æ‹Ÿå‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚ç¬¬ä¸€æ­¥æ˜¯å®šä¹‰ä¸€ä¸ªå®ç°
ç­çº§ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ReturnSecondArgumentAction</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">template</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">typename</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ArgumentTuple</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Result </span><span class="token function" style="color:#8250DF">Perform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> ArgumentTuple</span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// To get the i-th (0-based) argument, use std::get(args).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#8250DF">get</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&lt;</span><span class="token generic-function generic class-name number" style="color:#005CC5">1</span><span class="token generic-function generic class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯¥å®ç°ç±»<em>ä¸éœ€è¦</em>éœ€è¦ä»ä»»ä½•ç‰¹å®šç±»ç»§æ‰¿ã€‚
é‡è¦çš„æ˜¯å®ƒå¿…é¡»æœ‰ä¸€ä¸ª<code>Perform()</code>æ–¹æ³•æ¨¡æ¿ã€‚è¿™ä¸ªæ–¹æ³•
æ¨¡æ¿å°†æ¨¡æ‹Ÿå‡½æ•°çš„å‚æ•°ä½œä¸º <strong>single</strong> ä¸­çš„å…ƒç»„
å‚æ•°ï¼Œå¹¶è¿”å›æ“ä½œçš„ç»“æœã€‚å®ƒå¯ä»¥æ˜¯ <code>const</code> ä¹Ÿå¯ä»¥ä¸æ˜¯ï¼Œ
ä½†å¿…é¡»åªèƒ½ä½¿ç”¨ä¸€ä¸ªæ¨¡æ¿å‚æ•°æ¥è°ƒç”¨ï¼Œè¿™å°±æ˜¯ç»“æœ
ç±»å‹ã€‚æ¢å¥è¯è¯´ï¼Œæ‚¨å¿…é¡»èƒ½å¤Ÿè°ƒç”¨<code>Perform&lt;R&gt;(args)</code>ï¼Œå…¶ä¸­<code>R</code>æ˜¯
æ¨¡æ‹Ÿå‡½æ•°çš„è¿”å›ç±»å‹ï¼Œ<code>args</code>æ˜¯å…ƒç»„ä¸­çš„å‚æ•°ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ MakePolymorphicAction() æ¥è½¬æ¢å®ç°çš„å®ä¾‹
ç±»åˆ°æˆ‘ä»¬éœ€è¦çš„å¤šæ€åŠ¨ä½œä¸­ã€‚æ‹¥æœ‰ä¸€ä¸ªä¼šå¾ˆæ–¹ä¾¿
å¯¹æ­¤çš„åŒ…è£…ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">MakePolymorphicAction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">PolymorphicAction</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PolymorphicAction</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">ReturnSecondArgumentAction</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ReturnSecondArgument</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">MakePolymorphicAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnSecondArgumentAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç°åœ¨ï¼Œæ‚¨å¯ä»¥åƒä½¿ç”¨å†…ç½®æ“ä½œä¸€æ ·ä½¿ç”¨æ­¤å¤šæ€æ“ä½œï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">using</span><span class="token plain"> </span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">testing</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MockFoo</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token base-clause keyword" style="color:#CF222E">public</span><span class="token base-clause"> </span><span class="token base-clause class-name" style="color:#116329">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">public</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">bool</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">MOCK_METHOD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">int</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">char</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> str2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">override</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFoo foo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThis</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnSecondArgument</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoThat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">ReturnSecondArgument</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Will return 5.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">DoThat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Hi&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Bye&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Will return &quot;Hi&quot;.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="teaching-kmock-how-to-print-your-values">Teaching kMock How to Print Your Values<a href="#teaching-kmock-how-to-print-your-values" class="hash-link" aria-label="Direct link to Teaching kMock How to Print Your Values" title="Direct link to Teaching kMock How to Print Your Values">â€‹</a></h3>
<p>å½“å‘ç”Ÿæ— è¶£æˆ–æ„å¤–çš„è°ƒç”¨æ—¶ï¼ŒkMock ä¼šæ‰“å°å‚æ•°
å€¼å’Œå †æ ˆè·Ÿè¸ªæ¥å¸®åŠ©æ‚¨è°ƒè¯•ã€‚æ–­è¨€å®å¦‚
<code>EXPECT_THAT</code> å’Œ <code>EXPECT_EQ</code> ä¹Ÿä¼šåœ¨
æ–­è¨€å¤±è´¥ã€‚ kMock å’Œ googletest ä½¿ç”¨ googletest çš„ç”¨æˆ·å¯æ‰©å±•æ¥åšåˆ°è¿™ä¸€ç‚¹
ä»·å€¼æ‰“å°æœºã€‚</p>
<p>è¯¥æ‰“å°æœºçŸ¥é“å¦‚ä½•æ‰“å°å†…ç½® C++ ç±»å‹ã€æœ¬æœºæ•°ç»„ã€STL
å®¹å™¨ä»¥åŠä»»ä½•æ”¯æŒ <code>&lt;&lt;</code> è¿ç®—ç¬¦çš„ç±»å‹ã€‚å¯¹äºå…¶ä»–ç±»å‹ï¼Œå®ƒ
æ‰“å°å€¼ä¸­çš„åŸå§‹å­—èŠ‚ï¼Œå¹¶å¸Œæœ›ç”¨æˆ·èƒ½å¤Ÿå¼„æ¸…æ¥šã€‚
<a href="/docs/cpp/base/testing/kt/advanced#teaching-kumotest-how-to-print-your-values">KumoTest é«˜çº§æŒ‡å—</a>
è§£é‡Šå¦‚ä½•æ‰©å±•æ‰“å°æœºä»¥æ›´å¥½åœ°æ‰“å°æ‚¨çš„å†…å®¹
ç‰¹å®šç±»å‹è€Œä¸æ˜¯è½¬å‚¨å­—èŠ‚ã€‚</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="useful-mocks-created-using-kmock">ä½¿ç”¨ kMock åˆ›å»ºæœ‰ç”¨çš„æ¨¡æ‹Ÿ<a href="#useful-mocks-created-using-kmock" class="hash-link" aria-label="Direct link to ä½¿ç”¨ kMock åˆ›å»ºæœ‰ç”¨çš„æ¨¡æ‹Ÿ" title="Direct link to ä½¿ç”¨ kMock åˆ›å»ºæœ‰ç”¨çš„æ¨¡æ‹Ÿ">â€‹</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="MockFunction">Mock std::function<a href="#MockFunction" class="hash-link" aria-label="Direct link to Mock std::function" title="Direct link to Mock std::function">â€‹</a></h3>
<p><code>std::function</code> æ˜¯ C++11 ä¸­å¼•å…¥çš„é€šç”¨å‡½æ•°ç±»å‹ã€‚å®ƒæ˜¯ä¸€ä¸ª
å°†å›è°ƒä¼ é€’ç»™æ–°æ¥å£çš„é¦–é€‰æ–¹å¼ã€‚å‡½æ•°æ˜¯å¯å¤åˆ¶çš„ï¼Œ
å¹¶ä¸”é€šå¸¸ä¸é€šè¿‡æŒ‡é’ˆä¼ é€’ï¼Œè¿™ä½¿å¾—å®ƒä»¬å¾ˆéš¾æ¨¡æ‹Ÿã€‚
ä½†ä¸è¦æ‹…å¿ƒ - <code>MockFunction</code> å¯ä»¥å¸®åŠ©ä½ ã€‚</p>
<p><code>MockFunction&lt;R(T1, ..., Tn)&gt;</code> æœ‰ä¸€ä¸ªæ¨¡æ‹Ÿæ–¹æ³• <code>Call()</code> ï¼Œå…¶ç­¾åä¸ºï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  R </span><span class="token function" style="color:#8250DF">Call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Tn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®ƒè¿˜æœ‰ä¸€ä¸ª <code>AsStdFunction()</code> æ–¹æ³•ï¼Œå®ƒåˆ›å»ºä¸€ä¸ª <code>std::function</code> ä»£ç†
è½¬æ¥è‡³å‘¼å«ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">function</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token function" style="color:#8250DF">R</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Tn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">AsStdFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¦ä½¿ç”¨<code>MockFunction</code>ï¼Œé¦–å…ˆåˆ›å»º<code>MockFunction</code>å¯¹è±¡å¹¶è®¾ç½®
å¯¹å…¶â€œCallâ€æ–¹æ³•çš„æœŸæœ›ã€‚ç„¶åä¼ é€’ä»è·å–çš„ä»£ç†
å°†â€œAsStdFunction()â€æ·»åŠ åˆ°æ‚¨æ­£åœ¨æµ‹è¯•çš„ä»£ç ä¸­ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#8250DF">TEST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FooTest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RunsCallbackWithBarArgument</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// 1. Create a mock object.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MockFunction</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> mock_function</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// 2. Set expectations on Call() method.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">EXPECT_CALL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_function</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">Call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;bar&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">WillOnce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">Return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// 3. Exercise code that uses std::function.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#8250DF">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock_function</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">AsStdFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// Foo&#x27;s signature can be either of:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// void Foo(const std::function&lt;int(string)&gt;&amp; fun);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// void Foo(std::function&lt;int(string)&gt; fun);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">// 4. All expectations will be verified when mock_function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic">//     goes out of scope and is destroyed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯·è®°ä½ï¼Œä½¿ç”¨ AsStdFunction() åˆ›å»ºçš„å‡½æ•°å¯¹è±¡åªæ˜¯
è´§è¿ä»£ç†ã€‚å¦‚æœæ‚¨åˆ›å»ºå¤šä¸ªï¼Œå®ƒä»¬å°†å…±äº«åŒä¸€ç»„
æœŸæœ›ã€‚</p>
<p>è™½ç„¶ <code>std::function</code> æ”¯æŒæ— é™æ•°é‡çš„å‚æ•°ï¼Œä½† <code>MockFunction</code>
å®æ–½ä»…é™äºåä¸ªã€‚å¦‚æœä½ è¾¾åˆ°äº†è¿™ä¸ªæé™......å¥½å§ï¼Œä½ çš„
å›è°ƒæœ‰æ¯”å¯æ¨¡æ‹Ÿæ›´å¤§çš„é—®é¢˜ã€‚ :-)</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cpp/base/testing/kt/kmock_for_dummies"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">kMock å…¥é—¨ç‰ˆ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cpp/base/testing/kt/kmock_cheat_sheet"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">kmock å¤‡å¿˜å½•</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-mock-classes" class="table-of-contents__link toc-highlight">åˆ›å»ºæ¨¡æ‹Ÿç±»</a><ul><li><a href="#dealing-with-unprotected-commas" class="table-of-contents__link toc-highlight">å¤„ç†ä¸å—ä¿æŠ¤çš„é€—å·</a></li><li><a href="#mocking-private-or-protected-methods" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿç§æœ‰æˆ–å—ä¿æŠ¤çš„æ–¹æ³•</a></li><li><a href="#mocking-overloaded-methods" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿé‡è½½æ–¹æ³•</a></li><li><a href="#mocking-class-templates" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿç±»æ¨¡æ¿</a></li><li><a href="#MockingNonVirtualMethods" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿéè™šæ‹Ÿæ–¹æ³•</a></li><li><a href="#mocking-free-functions" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿå‡½æ•°</a></li><li><a href="#NiceStrictNaggy" class="table-of-contents__link toc-highlight">å–„è‰¯ã€ä¸¥æ ¼å’Œæ— è¶£çš„è°ƒç”¨</a></li><li><a href="#SimplerInterfaces" class="table-of-contents__link toc-highlight">ç®€åŒ–ç•Œé¢è€Œä¸ç ´åç°æœ‰ä»£ç </a></li><li><a href="#alternative-to-mocking-concrete-classes" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿå…·ä½“ç±»çš„æ›¿ä»£æ–¹æ¡ˆ</a></li><li><a href="#DelegatingToFake" class="table-of-contents__link toc-highlight">å°†å‘¼å«å§”æ‰˜ç»™fake</a></li><li><a href="#å°†è°ƒç”¨å§”æ‰˜ç»™çœŸå®å¯¹è±¡" class="table-of-contents__link toc-highlight">å°†è°ƒç”¨å§”æ‰˜ç»™çœŸå®å¯¹è±¡</a></li><li><a href="#delegating-calls-to-a-parent-class" class="table-of-contents__link toc-highlight">å°†è°ƒç”¨å§”æ‰˜ç»™çˆ¶ç±»</a></li></ul></li><li><a href="#using-matchers" class="table-of-contents__link toc-highlight">ä½¿ç”¨åŒ¹é…å™¨</a><ul><li><a href="#matching-argument-values-exactly" class="table-of-contents__link toc-highlight">ç²¾ç¡®åŒ¹é…å‚æ•°å€¼</a></li><li><a href="#using-simple-matchers" class="table-of-contents__link toc-highlight">ä½¿ç”¨ç®€å•åŒ¹é…å™¨</a></li><li><a href="#CombiningMatchers" class="table-of-contents__link toc-highlight">ç»„åˆåŒ¹é…å™¨</a></li><li><a href="#SafeMatcherCast" class="table-of-contents__link toc-highlight">é€‰è§’åŒ¹é…å™¨</a></li><li><a href="#SelectOverload" class="table-of-contents__link toc-highlight">åœ¨é‡è½½å‡½æ•°ä¹‹é—´è¿›è¡Œé€‰æ‹©</a></li><li><a href="#æ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œ" class="table-of-contents__link toc-highlight">æ ¹æ®å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œ</a></li><li><a href="#å°†å¤šä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡ŒåŒ¹é…" class="table-of-contents__link toc-highlight">å°†å¤šä¸ªå‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡ŒåŒ¹é…</a></li><li><a href="#ä½¿ç”¨åŒ¹é…å™¨ä½œä¸ºè°“è¯" class="table-of-contents__link toc-highlight">ä½¿ç”¨åŒ¹é…å™¨ä½œä¸ºè°“è¯</a></li><li><a href="#åœ¨-ktest-æ–­è¨€ä¸­ä½¿ç”¨åŒ¹é…å™¨" class="table-of-contents__link toc-highlight">åœ¨ ktest æ–­è¨€ä¸­ä½¿ç”¨åŒ¹é…å™¨</a></li><li><a href="#ä½¿ç”¨è°“è¯ä½œä¸ºåŒ¹é…å™¨" class="table-of-contents__link toc-highlight">ä½¿ç”¨è°“è¯ä½œä¸ºåŒ¹é…å™¨</a></li><li><a href="#åŒ¹é…ä¸å¯å¤åˆ¶çš„å‚æ•°" class="table-of-contents__link toc-highlight">åŒ¹é…ä¸å¯å¤åˆ¶çš„å‚æ•°</a></li><li><a href="#éªŒè¯å¯¹è±¡çš„æˆå‘˜" class="table-of-contents__link toc-highlight">éªŒè¯å¯¹è±¡çš„æˆå‘˜</a></li><li><a href="#éªŒè¯æŒ‡é’ˆå‚æ•°æŒ‡å‘çš„å€¼" class="table-of-contents__link toc-highlight">éªŒè¯æŒ‡é’ˆå‚æ•°æŒ‡å‘çš„å€¼</a></li><li><a href="#CustomMatcherClass" class="table-of-contents__link toc-highlight">å®šä¹‰è‡ªå®šä¹‰åŒ¹é…å™¨ç±»</a></li><li><a href="#é…å¥—å®¹å™¨" class="table-of-contents__link toc-highlight">é…å¥—å®¹å™¨</a></li><li><a href="#å…±äº«åŒ¹é…å™¨" class="table-of-contents__link toc-highlight">å…±äº«åŒ¹é…å™¨</a></li><li><a href="#PureMatchers" class="table-of-contents__link toc-highlight">åŒ¹é…å™¨å¿…é¡»æ²¡æœ‰å‰¯ä½œç”¨</a></li></ul></li><li><a href="#setting-expectations" class="table-of-contents__link toc-highlight">è®¾å®šæœŸæœ›</a><ul><li><a href="#UseOnCall" class="table-of-contents__link toc-highlight">çŸ¥é“ä»€ä¹ˆæ—¶å€™å¯ä»¥æœŸå¾…</a></li><li><a href="#å¿½ç•¥æ— è¶£çš„è°ƒç”¨" class="table-of-contents__link toc-highlight">å¿½ç•¥æ— è¶£çš„è°ƒç”¨</a></li><li><a href="#ç¦æ­¢æ„å¤–call" class="table-of-contents__link toc-highlight">ç¦æ­¢æ„å¤–<code>call</code></a></li><li><a href="#uninteresting-vs-unexpected" class="table-of-contents__link toc-highlight">äº†è§£æ— è¶£ä¸æ„å¤–çš„<code>call</code></a></li><li><a href="#ParameterlessExpectations" class="table-of-contents__link toc-highlight">å¿½ç•¥æ— è¶£çš„å‚æ•°</a></li><li><a href="#OrderedCalls" class="table-of-contents__link toc-highlight">æœŸå¾…æœ‰åºè°ƒç”¨</a></li><li><a href="#PartialOrder" class="table-of-contents__link toc-highlight">æœŸå¾…éƒ¨åˆ†æœ‰åºçš„è°ƒç”¨</a></li><li><a href="#æ§åˆ¶æœŸæœ›ä½•æ—¶æ¶ˆå¤±" class="table-of-contents__link toc-highlight">æ§åˆ¶æœŸæœ›ä½•æ—¶æ¶ˆå¤±</a></li></ul></li><li><a href="#using-actions" class="table-of-contents__link toc-highlight">ä½¿ç”¨ Actions</a><ul><li><a href="#ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å¼•ç”¨" class="table-of-contents__link toc-highlight">ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å¼•ç”¨</a></li><li><a href="#ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å®æ—¶å€¼" class="table-of-contents__link toc-highlight">ä»æ¨¡æ‹Ÿæ–¹æ³•è¿”å›å®æ—¶å€¼</a></li><li><a href="#ç»„åˆactions" class="table-of-contents__link toc-highlight">ç»„åˆactions</a></li><li><a href="#SaveArgVerify" class="table-of-contents__link toc-highlight">éªŒè¯å¤æ‚çš„å‚æ•°</a></li><li><a href="#mocking-side-effects" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿå‰¯ä½œç”¨</a></li><li><a href="#æ ¹æ®çŠ¶æ€æ›´æ”¹æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸º" class="table-of-contents__link toc-highlight">æ ¹æ®çŠ¶æ€æ›´æ”¹æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸º</a></li><li><a href="#DefaultValue" class="table-of-contents__link toc-highlight">è®¾ç½®è¿”å›ç±»å‹çš„é»˜è®¤å€¼</a></li><li><a href="#è®¾ç½®æ¨¡æ‹Ÿæ–¹æ³•çš„é»˜è®¤æ“ä½œ" class="table-of-contents__link toc-highlight">è®¾ç½®æ¨¡æ‹Ÿæ–¹æ³•çš„é»˜è®¤æ“ä½œ</a></li><li><a href="#FunctionsAsActions" class="table-of-contents__link toc-highlight">ä½¿ç”¨å‡½æ•°/æ–¹æ³•/å‡½å­/Lambda ä½œä¸ºactions</a></li><li><a href="#invoking-a-functionmethodfunctorlambdacallback-without-arguments" class="table-of-contents__link toc-highlight">Invoking a Function/Method/Functor/Lambda/Callback Without Arguments</a></li><li><a href="#è°ƒç”¨-mock-å‡½æ•°çš„å‚æ•°" class="table-of-contents__link toc-highlight">è°ƒç”¨ Mock å‡½æ•°çš„å‚æ•°</a></li><li><a href="#å¿½ç•¥æ“ä½œçš„ç»“æœ" class="table-of-contents__link toc-highlight">å¿½ç•¥æ“ä½œçš„ç»“æœ</a></li><li><a href="#SelectingArgs" class="table-of-contents__link toc-highlight">é€‰æ‹©æ“ä½œçš„å‚æ•°</a></li><li><a href="#å¿½ç•¥æ“ä½œå‡½æ•°ä¸­çš„å‚æ•°" class="table-of-contents__link toc-highlight">å¿½ç•¥æ“ä½œå‡½æ•°ä¸­çš„å‚æ•°</a></li><li><a href="#sharing-actions" class="table-of-contents__link toc-highlight">Sharing Actions</a></li><li><a href="#æµ‹è¯•å¼‚æ­¥è¡Œä¸º" class="table-of-contents__link toc-highlight">æµ‹è¯•å¼‚æ­¥è¡Œä¸º</a></li></ul></li><li><a href="#misc-recipes-on-using-kmock" class="table-of-contents__link toc-highlight">æœ‰å…³ä½¿ç”¨ kMock çš„æ‚é¡¹</a><ul><li><a href="#ä½¿ç”¨ä»…ç§»åŠ¨ç±»å‹çš„æ¨¡æ‹Ÿæ–¹æ³•" class="table-of-contents__link toc-highlight">ä½¿ç”¨ä»…ç§»åŠ¨ç±»å‹çš„æ¨¡æ‹Ÿæ–¹æ³•</a></li><li><a href="#ä½¿ç¼–è¯‘æ›´å¿«" class="table-of-contents__link toc-highlight">ä½¿ç¼–è¯‘æ›´å¿«</a></li><li><a href="#å¼ºåˆ¶éªŒè¯" class="table-of-contents__link toc-highlight">å¼ºåˆ¶éªŒè¯</a></li><li><a href="#UsingCheckPoints" class="table-of-contents__link toc-highlight">Using Checkpoints</a></li><li><a href="#æ¨¡æ‹Ÿææ„å‡½æ•°" class="table-of-contents__link toc-highlight">æ¨¡æ‹Ÿææ„å‡½æ•°</a></li><li><a href="#UsingThreads" class="table-of-contents__link toc-highlight">ä½¿ç”¨ kMock å’Œçº¿ç¨‹</a></li><li><a href="#æ§åˆ¶-kmock-æ‰“å°çš„ä¿¡æ¯é‡" class="table-of-contents__link toc-highlight">æ§åˆ¶ kMock æ‰“å°çš„ä¿¡æ¯é‡</a></li><li><a href="#åœ¨æ¨¡æ‹Ÿé€šè¯ä¸­è·å¾—è¶…çº§è§†è§‰" class="table-of-contents__link toc-highlight">åœ¨æ¨¡æ‹Ÿé€šè¯ä¸­è·å¾—è¶…çº§è§†è§‰</a></li></ul></li><li><a href="#extending-kmock" class="table-of-contents__link toc-highlight">æ‰©å±• kMock</a><ul><li><a href="#NewMatchers" class="table-of-contents__link toc-highlight">å¿«é€Ÿç¼–å†™æ–°çš„åŒ¹é…å™¨</a></li><li><a href="#å¿«é€Ÿç¼–å†™æ–°çš„å‚æ•°åŒ–åŒ¹é…å™¨" class="table-of-contents__link toc-highlight">å¿«é€Ÿç¼–å†™æ–°çš„å‚æ•°åŒ–åŒ¹é…å™¨</a></li><li><a href="#ç¼–å†™æ–°çš„å•æ€åŒ¹é…å™¨" class="table-of-contents__link toc-highlight">ç¼–å†™æ–°çš„å•æ€åŒ¹é…å™¨</a></li><li><a href="#ç¼–å†™æ–°çš„å¤šæ€åŒ¹é…å™¨" class="table-of-contents__link toc-highlight">ç¼–å†™æ–°çš„å¤šæ€åŒ¹é…å™¨</a></li><li><a href="#é—ç•™åŒ¹é…å™¨å®æ–½" class="table-of-contents__link toc-highlight">é—ç•™åŒ¹é…å™¨å®æ–½</a></li><li><a href="#ç¼–å†™æ–°çš„åŸºæ•°" class="table-of-contents__link toc-highlight">ç¼–å†™æ–°çš„åŸºæ•°</a></li><li><a href="#QuickNewActions" class="table-of-contents__link toc-highlight">ç¼–å†™æ–°åŠ¨ä½œ</a></li><li><a href="#é™åˆ¶-action-ä¸­å‚æ•°æˆ–å‚æ•°çš„ç±»å‹" class="table-of-contents__link toc-highlight">é™åˆ¶ ACTION ä¸­å‚æ•°æˆ–å‚æ•°çš„ç±»å‹</a></li><li><a href="#writing-new-action-templates-quickly" class="table-of-contents__link toc-highlight">Writing New Action Templates Quickly</a></li><li><a href="#using-the-action-objects-type" class="table-of-contents__link toc-highlight">Using the ACTION Object&#39;s Type</a></li><li><a href="#NewMonoActions" class="table-of-contents__link toc-highlight">ç¼–å†™æ–°çš„å•æ€åŠ¨ä½œ</a></li><li><a href="#NewPolyActions" class="table-of-contents__link toc-highlight">ç¼–å†™æ–°çš„ å¤šæ€åŠ¨ä½œ</a></li><li><a href="#teaching-kmock-how-to-print-your-values" class="table-of-contents__link toc-highlight">Teaching kMock How to Print Your Values</a></li></ul></li><li><a href="#useful-mocks-created-using-kmock" class="table-of-contents__link toc-highlight">ä½¿ç”¨ kMock åˆ›å»ºæœ‰ç”¨çš„æ¨¡æ‹Ÿ</a><ul><li><a href="#MockFunction" class="table-of-contents__link toc-highlight">Mock std::function</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">é˜…è¯»</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">æ–‡æ¡£</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation">å®‰è£…</a></li></ul></div><div class="col footer__col"><div class="footer__title">æ”¯æŒä¸èµ„æº</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/feature-requests">Feature Requests</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/community/support">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">åšå®¢</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">æ›´æ–°</a></li><li class="footer__item"><a href="https://gitee.com/kumo-pub" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kumo-ai.tech" target="_blank" rel="noopener noreferrer" class="footer__link-item">ç½‘ç«™<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">ç‰ˆæƒ Â© 2025 åŒ—äº¬ç§‘ç±³æ™ºåˆ›ç§‘æŠ€æœ‰é™å…¬å¸</div></div></div></footer></div>
</body>
</html>