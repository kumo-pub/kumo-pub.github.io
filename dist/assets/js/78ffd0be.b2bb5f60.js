"use strict";(self.webpackChunkkumo_website=self.webpackChunkkumo_website||[]).push([[10781],{64942:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var s=t(74848),r=t(28453);const i={title:"Universal Windows Platform",description:"Building for UWP with the MSVC Compiler",date:"08/12/2024"},o="Universal Windows Platform (UWP)",l={id:"kmpkg/users/platforms/uwp",title:"Universal Windows Platform",description:"Building for UWP with the MSVC Compiler",source:"@site/versioned_docs/version-1.1.1/kmpkg/users/platforms/uwp.md",sourceDirName:"kmpkg/users/platforms",slug:"/kmpkg/users/platforms/uwp",permalink:"/docs/kmpkg/users/platforms/uwp",draft:!1,unlisted:!1,tags:[],version:"1.1.1",frontMatter:{title:"Universal Windows Platform",description:"Building for UWP with the MSVC Compiler",date:"08/12/2024"}},d={},a=[{value:"Triplets",id:"triplets",level:2},{value:"C++/CX vs. C++/WinRT projections",id:"ccx-vs-cwinrt-projections",level:2},{value:"Maintainer notes",id:"maintainer-notes",level:2},{value:"Library author notes",id:"library-author-notes",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"universal-windows-platform-uwp",children:"Universal Windows Platform (UWP)"})}),"\n",(0,s.jsx)(n.h2,{id:"triplets",children:"Triplets"}),"\n",(0,s.jsxs)(n.p,{children:["kmpkg includes ",(0,s.jsx)(n.a,{href:"/docs/kmpkg/concepts/triplets",children:"triplets"})," for building Universal Windows Platform (UWP) applications using the MSVC ",(0,s.jsx)(n.code,{children:"cl.exe"})," compiler."]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Architecture"}),(0,s.jsx)(n.th,{children:"kmpkg triplets"}),(0,s.jsx)(n.th,{children:"Community"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"x64"}),(0,s.jsx)(n.td,{children:"x64-uwp"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"x64-uwp-static-md"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"x86"}),(0,s.jsx)(n.td,{children:"x86-uwp"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"x86-uwp-static-md"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"arm"}),(0,s.jsx)(n.td,{children:"arm-uwp"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"arm-uwp-static-md"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"arm64"}),(0,s.jsx)(n.td,{children:"arm64-uwp"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"arm64-uwp-static-md"}),(0,s.jsx)(n.td,{children:"Yes"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"ccx-vs-cwinrt-projections",children:"C++/CX vs. C++/WinRT projections"}),"\n",(0,s.jsxs)(n.p,{children:["UWP applications typically consume Windows Runtime APIs, and there are a number of solutions for using these from C++. The C++/CX language extensions for the MSVC compiler (",(0,s.jsx)(n.code,{children:"/ZW"}),"), the C++/WinRT language projections which works with C++17 compilers, or the Windows Runtime Library."]}),"\n",(0,s.jsxs)(n.p,{children:["The UWP triplet toolchain leaves enabling C++/CX language extensions (",(0,s.jsx)(n.code,{children:"/ZW"}),") up to CMake, but does provide a ",(0,s.jsx)(n.code,{children:"/FU"})," parameter to point to the proper ",(0,s.jsx)(n.code,{children:"platform.winmd"})," file for the toolset being used."]}),"\n",(0,s.jsx)(n.h2,{id:"maintainer-notes",children:"Maintainer notes"}),"\n",(0,s.jsxs)(n.p,{children:["CMake projects for these triplets are built using ",(0,s.jsx)(n.code,{children:"CMAKE_SYSTEM_NAME"}),' set to "WindowsStore" and ',(0,s.jsx)(n.code,{children:"CMAKE_SYSTEM_VERSION"}),' set to "10.0".']}),"\n",(0,s.jsxs)(n.p,{children:["The UWP triplets also build code using ",(0,s.jsx)(n.code,{children:"/DWINAPI_FAMILY=WINAPI_FAMILY_APP"})," for the API partition, so libraries can fail to build if they are using unsupported versions of Win32 APIs. The general recommendation is to use the newer APIs in all cases, but if you need to build the same library for older versions of Windows then you may need to use conditionally building code such as the following to support both scenarios."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"    HANDLE hFile = nullptr;\n#if (_WIN32_WINNT >= _WIN32_WINNT_WIN8)\n    hFile = CreateFile2(\n                fileName,\n                GENERIC_READ, FILE_SHARE_READ, OPEN_EXISTING,\n                nullptr);\n#else\n    hFile = CreateFileW(\n                fileName,\n                GENERIC_READ, FILE_SHARE_READ,\n                nullptr,\n                OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL,\n                nullptr);\n#endif\n"})}),"\n",(0,s.jsxs)(n.p,{children:["UWP triplets also build with ",(0,s.jsx)(n.code,{children:"/DUNICODE /D_UNICODE"})," as these are both strongly recommended for modern development. See the ",(0,s.jsx)(n.a,{href:"https://utf8everywhere.org/",children:"UTF-8 Everywhere manifesto"})," for more information."]}),"\n",(0,s.jsx)(n.h2,{id:"library-author-notes",children:"Library author notes"}),"\n",(0,s.jsxs)(n.p,{children:["For CMake 3.1 or later, you control the enabling of the MSVC C++/CX language extensions (i.e. ",(0,s.jsx)(n.code,{children:"/ZW"}),") via the ",(0,s.jsx)(n.code,{children:"VS_WINRT_COMPONENT"})," property for the ",(0,s.jsx)(n.em,{children:"Visual Studio generator"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If making use of ",(0,s.jsx)(n.em,{children:"C++/WinRT language projections"}),", leverage the ",(0,s.jsx)(n.em,{children:"cppwinrt"})," kmpkg port rather than relying on the often outdated headers in the Windows SDK."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cmake",children:'if (KMPKG_TOOLCHAIN)\n    message(STATUS "Using KMPKG for C++/WinRT.")\n    find_package(cppwinrt CONFIG REQUIRED)\n    target_link_libraries(${PROJECT_NAME} PRIVATE Microsoft::CppWinRT)\nendif()\n'})}),"\n",(0,s.jsxs)(n.p,{children:["In your ",(0,s.jsx)(n.code,{children:"CMakeLists.txt"})," file use something similar to the following to enable the proper build settings for the UWP platform as these are not automatically set by CMake."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cmake",children:"if(WIN32)\n    target_compile_definitions(${PROJECT_NAME} PRIVATE _UNICODE UNICODE)\n\n    if(WINDOWS_STORE)\n        target_compile_definitions(${PROJECT_NAME} PRIVATE WINAPI_FAMILY=WINAPI_FAMILY_APP)\n    endif()\nendif()\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You should set ",(0,s.jsx)(n.code,{children:"_WIN32_WINNT=0x0A00"})," (Windows 10 or later) as well for all ",(0,s.jsx)(n.code,{children:"WIN32"})," platforms, or at least for ",(0,s.jsx)(n.code,{children:"WINDOWS_STORE"})," platform builds."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cmake",children:"if(WIN32)\n    target_compile_definitions(${PROJECT_NAME} PRIVATE _WIN32_WINNT=0x0A00)\nendif()\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var s=t(96540);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);